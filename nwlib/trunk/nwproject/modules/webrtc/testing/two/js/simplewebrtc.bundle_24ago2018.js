var streamCamera=!1;function getConfigWrpc(){return{iceServers:[{urls:["turn:173.194.72.127:19305?transport=udp","turn:[2404:6800:4008:C01::7F]:19305?transport=udp","turn:173.194.72.127:443?transport=tcp","turn:[2404:6800:4008:C01::7F]:443?transport=tcp"],username:"CKjCuLwFEgahxNRjuTAYzc/s6OMT",credential:"u1SQDR/SQsPQIxXNWQT7czc/G4c="}]}}!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SimpleWebRTC=e()}}(function(){return function o(a,s,c){function u(n,e){if(!s[n]){if(!a[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(p)return p(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[n]={exports:{}};a[n][0].call(i.exports,function(e){var t=a[n][1][e];return u(t||e)},i,i.exports,o,a,s,c)}return s[n].exports}for(var p="function"==typeof require&&require,e=0;e<c.length;e++)u(c[e]);return u}({1:[function(e,t,n){function a(){}t.exports=function(e,n,r){var i=!1;return r=r||a,0===(o.count=e)?n():o;function o(e,t){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(console.log(e),i=!0,n(e),n=r):0!==o.count||i||n(null,t)}}},{}],2:[function(e,t,n){t.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),r<n&&(n=r),r<=t||n<=t||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)o[s]=i[a];return o.buffer}},{}],3:[function(e,t,n){e("webrtc-adapter");t.exports=function(e,t,n){window.URL;var r,i=t,o={autoplay:!0,mirror:!1,muted:!1,audio:!1,disableContextMenu:!1};if(n)for(r in n)o[r]=n[r];return i?"audio"===i.tagName.toLowerCase()&&(o.audio=!0):i=document.createElement(o.audio?"audio":"video"),o.disableContextMenu&&(i.oncontextmenu=function(e){e.preventDefault()}),o.autoplay&&(i.autoplay="autoplay"),o.muted&&(i.muted=!0),!o.audio&&o.mirror&&["","moz","webkit","o","ms"].forEach(function(e){var t=e?e+"Transform":"transform";i.style[t]="scaleX(-1)"}),i.srcObject=e,i}},{"webrtc-adapter":4}],4:[function(a,s,e){"use strict";!function(){var e=a("./utils").log,t=a("./utils").browserDetails;s.exports.browserDetails=t,s.exports.extractVersion=a("./utils").extractVersion,s.exports.disableLog=a("./utils").disableLog;var n=a("./chrome/chrome_shim")||null,r=a("./edge/edge_shim")||null,i=a("./firefox/firefox_shim")||null,o=a("./safari/safari_shim")||null;switch(t.browser){case"opera":case"chrome":if(!n||!n.shimPeerConnection)return e("Chrome shim is not included in this adapter release.");e("adapter.js shimming chrome."),(s.exports.browserShim=n).shimGetUserMedia(),n.shimMediaStream(),n.shimSourceObject(),n.shimPeerConnection(),n.shimOnTrack();break;case"firefox":if(!i||!i.shimPeerConnection)return e("Firefox shim is not included in this adapter release.");e("adapter.js shimming firefox."),(s.exports.browserShim=i).shimGetUserMedia(),i.shimSourceObject(),i.shimPeerConnection(),i.shimOnTrack();break;case"edge":if(!r||!r.shimPeerConnection)return e("MS edge shim is not included in this adapter release.");e("adapter.js shimming edge."),(s.exports.browserShim=r).shimGetUserMedia(),r.shimPeerConnection();break;case"safari":if(!o)return e("Safari shim is not included in this adapter release.");e("adapter.js shimming safari."),(s.exports.browserShim=o).shimGetUserMedia();break;default:e("Unsupported browser!")}}()},{"./chrome/chrome_shim":5,"./edge/edge_shim":7,"./firefox/firefox_shim":9,"./safari/safari_shim":11,"./utils":12}],5:[function(e,t,n){"use strict";var i=e("../utils.js").log,r=e("../utils.js").browserDetails,o={shimMediaStream:function(){window.MediaStream=window.MediaStream||window.webkitMediaStream},shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){var r=this;this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(n){n.stream.addEventListener("addtrack",function(e){var t=new Event("track");t.track=e.track,t.receiver={track:e.track},t.streams=[n.stream],r.dispatchEvent(t)}),n.stream.getTracks().forEach(function(e){var t=new Event("track");t.track=e,t.receiver={track:e},t.streams=[n.stream],this.dispatchEvent(t)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;this._srcObject=e,this.src&&URL.revokeObjectURL(this.src),e?(this.src=URL.createObjectURL(e),e.addEventListener("addtrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)}),e.addEventListener("removetrack",function(){t.src&&URL.revokeObjectURL(t.src),t.src=URL.createObjectURL(e)})):this.src=""}}))},shimPeerConnection:function(){window.RTCPeerConnection=function(e,t){i("PeerConnection"),e&&e.iceTransportPolicy&&(e.iceTransports=e.iceTransportPolicy);var n=getConfigWrpc(),r=new webkitRTCPeerConnection(n,t),s=r.getStats.bind(r);return r.getStats=function(n,e,t){var r=this,i=arguments;if(0<arguments.length&&"function"==typeof n)return s(n,e);var o=function(e){var r={};return e.result().forEach(function(t){var n={id:t.id,timestamp:t.timestamp,type:t.type};t.names().forEach(function(e){n[e]=t.stat(e)}),r[n.id]=n}),r},a=function(t,n){var r=new Map(Object.keys(t).map(function(e){return[e,t[e]]}));return n=n||t,Object.keys(n).forEach(function(e){r[e]=n[e]}),r};if(2<=arguments.length){return s.apply(this,[function(e){i[1](a(o(e)))},n])}return new Promise(function(t,e){1===i.length&&"object"==typeof n?s.apply(r,[function(e){t(a(o(e)))},e]):s.apply(r,[function(e){t(a(o(e),e.result()))},e])}).then(e,t)},r},window.RTCPeerConnection.prototype=webkitRTCPeerConnection.prototype,webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return webkitRTCPeerConnection.generateCertificate}}),["createOffer","createAnswer"].forEach(function(e){var i=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var n=this;if(arguments.length<1||1===arguments.length&&"object"==typeof arguments[0]){var r=1===arguments.length?arguments[0]:void 0;return new Promise(function(e,t){i.apply(n,[e,t,r])})}return i.apply(this,arguments)}}),r.version<51&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var i=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){var n=arguments,r=this,e=new Promise(function(e,t){i.apply(r,[n[0],e,t])});return n.length<2?e:e.then(function(){n[1].apply(null,[])},function(e){3<=n.length&&n[2].apply(null,[e])})}}),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=webkitRTCPeerConnection.prototype[e];webkitRTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}};t.exports={shimMediaStream:o.shimMediaStream,shimOnTrack:o.shimOnTrack,shimSourceObject:o.shimSourceObject,shimPeerConnection:o.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils.js":12,"./getusermedia":6}],6:[function(e,t,n){"use strict";var a=e("../utils.js").log;t.exports=function(){var o=function(i){if("object"!=typeof i||i.mandatory||i.optional)return i;var o={};return Object.keys(i).forEach(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var n="object"==typeof i[t]?i[t]:{ideal:i[t]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){o.optional=o.optional||[];var e={};"number"==typeof n.ideal?(e[r("min",t)]=n.ideal,o.optional.push(e),(e={})[r("max",t)]=n.ideal):e[r("",t)]=n.ideal,o.optional.push(e)}void 0!==n.exact&&"number"!=typeof n.exact?(o.mandatory=o.mandatory||{},o.mandatory[r("",t)]=n.exact):["min","max"].forEach(function(e){void 0!==n[e]&&(o.mandatory=o.mandatory||{},o.mandatory[r(e,t)]=n[e])})}}),i.advanced&&(o.optional=(o.optional||[]).concat(i.advanced)),o},r=function(n,r){if((n=JSON.parse(JSON.stringify(n)))&&n.audio&&(n.audio=o(n.audio)),n&&"object"==typeof n.video){var i=n.video.facingMode;if((i=i&&("object"==typeof i?i:{ideal:i}))&&("user"===i.exact||"environment"===i.exact||"user"===i.ideal||"environment"===i.ideal)&&(!navigator.mediaDevices.getSupportedConstraints||!navigator.mediaDevices.getSupportedConstraints().facingMode)&&(delete n.video.facingMode,"environment"===i.exact||"environment"===i.ideal))return navigator.mediaDevices.enumerateDevices().then(function(e){var t=(e=e.filter(function(e){return"videoinput"===e.kind})).find(function(e){return-1!==e.label.toLowerCase().indexOf("back")})||e.length&&e[e.length-1];return t&&(n.video.deviceId=i.exact?{exact:t.deviceId}:{ideal:t.deviceId}),n.video=o(n.video),a("chrome: "+JSON.stringify(n)),r(n)});n.video=o(n.video)}return a("chrome: "+JSON.stringify(n)),r(n)},i=function(e){return{name:{PermissionDeniedError:"NotAllowedError",ConstraintNotSatisfiedError:"OverconstrainedError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};navigator.getUserMedia=function(e,t,n){r(e,function(e){navigator.webkitGetUserMedia(e,t,function(e){n(i(e))})})};var t=function(n){return new Promise(function(e,t){navigator.getUserMedia(n,e,t)})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:t,enumerateDevices:function(){return new Promise(function(t){var n={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:n[e.kind],deviceId:e.id,groupId:""}}))})})}}),navigator.mediaDevices.getUserMedia){var n=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return r(e,function(t){return n(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return e},function(e){return Promise.reject(i(e))})})}}else navigator.mediaDevices.getUserMedia=function(e){return t(e)};void 0===navigator.mediaDevices.addEventListener&&(navigator.mediaDevices.addEventListener=function(){a("Dummy mediaDevices.addEventListener called.")}),void 0===navigator.mediaDevices.removeEventListener&&(navigator.mediaDevices.removeEventListener=function(){a("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":12}],7:[function(e,t,n){"use strict";var j=e("sdp"),i=e("../utils").browserDetails,r={shimPeerConnection:function(){if(window.RTCIceGatherer){window.RTCIceCandidate||(window.RTCIceCandidate=function(e){return e}),window.RTCSessionDescription||(window.RTCSessionDescription=function(e){return e});var n=Object.getOwnPropertyDescriptor(MediaStreamTrack.prototype,"enabled");Object.defineProperty(MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}window.RTCPeerConnection=function(e){var t=this,n=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=n[e].bind(n)}),this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.localStreams=[],this.remoteStreams=[],this.getLocalStreams=function(){return t.localStreams},this.getRemoteStreams=function(){return t.remoteStreams},this.localDescription=new RTCSessionDescription({type:"",sdp:""}),this.remoteDescription=new RTCSessionDescription({type:"",sdp:""}),this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",this.iceOptions={gatherPolicy:"all",iceServers:[]},e&&e.iceTransportPolicy)switch(e.iceTransportPolicy){case"all":case"relay":this.iceOptions.gatherPolicy=e.iceTransportPolicy;break;case"none":throw console.log('iceTransportPolicy "none" not supported'),new TypeError('iceTransportPolicy "none" not supported')}if(this.usingBundle=e&&"max-bundle"===e.bundlePolicy,e&&e.iceServers){var r=JSON.parse(JSON.stringify(e.iceServers));this.iceOptions.iceServers=r.filter(function(e){if(e&&e.urls){var t=e.urls;return"string"==typeof t&&(t=[t]),!!(t=t.filter(function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")||0===e.indexOf("stun:")&&14393<=i.version})[0])}return!1})}this._config=e,this.transceivers=[],this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype._emitBufferedCandidates=function(){var n=this,r=j.splitSections(n.localDescription.sdp);this._localIceCandidatesBuffer.forEach(function(e){if(!e.candidate||0===Object.keys(e.candidate).length)for(var t=1;t<r.length;t++)-1===r[t].indexOf("\r\na=end-of-candidates\r\n")&&(r[t]+="a=end-of-candidates\r\n");else-1===e.candidate.candidate.indexOf("typ endOfCandidates")&&(r[e.candidate.sdpMLineIndex+1]+="a="+e.candidate.candidate+"\r\n");(n.localDescription.sdp=r.join(""),n.dispatchEvent(e),null!==n.onicecandidate&&n.onicecandidate(e),e.candidate||"complete"===n.iceGatheringState)||n.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state})&&(n.iceGatheringState="complete")}),this._localIceCandidatesBuffer=[]},window.RTCPeerConnection.prototype.getConfiguration=function(){return this._config},window.RTCPeerConnection.prototype.addStream=function(e){var r=e.clone();e.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),this.localStreams.push(r),this._maybeFireNegotiationNeeded()},window.RTCPeerConnection.prototype.removeStream=function(e){var t=this.localStreams.indexOf(e);-1<t&&(this.localStreams.splice(t,1),this._maybeFireNegotiationNeeded())},window.RTCPeerConnection.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},window.RTCPeerConnection.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},window.RTCPeerConnection.prototype._getCommonCapabilities=function(e,r){var i={codecs:[],headerExtensions:[],fecMechanisms:[]};return e.codecs.forEach(function(n){for(var e=0;e<r.codecs.length;e++){var t=r.codecs[e];if(n.name.toLowerCase()===t.name.toLowerCase()&&n.clockRate===t.clockRate){t.numChannels=Math.min(n.numChannels,t.numChannels),i.codecs.push(t),t.rtcpFeedback=t.rtcpFeedback.filter(function(e){for(var t=0;t<n.rtcpFeedback.length;t++)if(n.rtcpFeedback[t].type===e.type&&n.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var t=0;t<r.headerExtensions.length;t++){var n=r.headerExtensions[t];if(e.uri===n.uri){i.headerExtensions.push(n);break}}}),i},window.RTCPeerConnection.prototype._createIceAndDtlsTransports=function(a,s){var c=this,u=new RTCIceGatherer(c.iceOptions),p=new RTCIceTransport(u);u.onlocalcandidate=function(e){var t=new Event("icecandidate");t.candidate={sdpMid:a,sdpMLineIndex:s};var n=e.candidate,r=!n||0===Object.keys(n).length;r?(void 0===u.state&&(u.state="completed"),t.candidate.candidate="candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates"):(n.component="RTCP"===p.component?2:1,t.candidate.candidate=j.writeCandidate(n));var i=j.splitSections(c.localDescription.sdp);-1===t.candidate.candidate.indexOf("typ endOfCandidates")?i[t.candidate.sdpMLineIndex+1]+="a="+t.candidate.candidate+"\r\n":i[t.candidate.sdpMLineIndex+1]+="a=end-of-candidates\r\n",c.localDescription.sdp=i.join("");var o=c.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state});switch(c.iceGatheringState){case"new":c._localIceCandidatesBuffer.push(t),r&&o&&c._localIceCandidatesBuffer.push(new Event("icecandidate"));break;case"gathering":c._emitBufferedCandidates(),c.dispatchEvent(t),null!==c.onicecandidate&&c.onicecandidate(t),o&&(c.dispatchEvent(new Event("icecandidate")),null!==c.onicecandidate&&c.onicecandidate(new Event("icecandidate")),c.iceGatheringState="complete")}},p.onicestatechange=function(){c._updateConnectionState()};var e=new RTCDtlsTransport(p);return e.ondtlsstatechange=function(){c._updateConnectionState()},e.onerror=function(){console.log("failed"),e.state="failed",c._updateConnectionState()},{iceGatherer:u,iceTransport:p,dtlsTransport:e}},window.RTCPeerConnection.prototype._transceive=function(e,t,n){var r=this._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);t&&e.rtpSender&&(r.encodings=e.sendEncodingParameters,r.rtcp={cname:j.localCName},e.recvEncodingParameters.length&&(r.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(r)),n&&e.rtpReceiver&&("video"===e.kind&&e.recvEncodingParameters&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),r.encodings=e.recvEncodingParameters,r.rtcp={cname:e.cname},e.sendEncodingParameters.length&&(r.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(r))},window.RTCPeerConnection.prototype.setLocalDescription=function(e){var t,l,f=this;if("offer"===e.type)this._pendingOffer&&(t=j.splitSections(e.sdp),l=t.shift(),t.forEach(function(e,t){var n=j.parseRtpParameters(e);f._pendingOffer[t].localCapabilities=n}),this.transceivers=this._pendingOffer,delete this._pendingOffer);else if("answer"===e.type){t=j.splitSections(f.remoteDescription.sdp),l=t.shift();var h=0<j.matchPrefix(l,"a=ice-lite").length;t.forEach(function(e,t){var n=f.transceivers[t],r=n.iceGatherer,i=n.iceTransport,o=n.dtlsTransport,a=n.localCapabilities,s=n.remoteCapabilities;if(!("0"===e.split("\n",1)[0].split(" ",2)[1])&&!n.isDatachannel){var c=j.getIceParameters(e,l);if(h){var u=j.matchPrefix(e,"a=candidate:").map(function(e){return j.parseCandidate(e)}).filter(function(e){return"1"===e.component});u.length&&i.setRemoteCandidates(u)}var p=j.getDtlsParameters(e,l);h&&(p.role="server"),f.usingBundle&&0!==t||(i.start(r,c,h?"controlling":"controlled"),o.start(p));var d=f._getCommonCapabilities(a,s);f._transceive(n,0<d.codecs.length,!1)}})}switch(this.localDescription={type:e.type,sdp:e.sdp},e.type){case"offer":this._updateSignalingState("have-local-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+e.type+'"')}var n=1<arguments.length&&"function"==typeof arguments[1];if(n){var r=arguments[1];window.setTimeout(function(){r(),"new"===f.iceGatheringState&&(f.iceGatheringState="gathering"),f._emitBufferedCandidates()},0)}var i=Promise.resolve();return i.then(function(){n||("new"===f.iceGatheringState&&(f.iceGatheringState="gathering"),window.setTimeout(f._emitBufferedCandidates.bind(f),500))}),i},window.RTCPeerConnection.prototype.setRemoteDescription=function(x){var P=this,R=new MediaStream,O=[],e=j.splitSections(x.sdp),D=e.shift(),_=0<j.matchPrefix(D,"a=ice-lite").length;switch(this.usingBundle=0<j.matchPrefix(D,"a=group:BUNDLE ").length,e.forEach(function(e,t){var n=j.splitLines(e)[0].substr(2).split(" "),r=n[0],i="0"===n[1],o=j.getDirection(e,D),a=j.matchPrefix(e,"a=mid:");if(a=a.length?a[0].substr(6):j.generateIdentifier(),"application"!==r||"DTLS/SCTP"!==n[2]){var s,c,u,p,d,l,f,h,m,g,v,y,b,w=j.parseRtpParameters(e);i||(v=j.getIceParameters(e,D),(y=j.getDtlsParameters(e,D)).role="client"),h=j.parseRtpEncodingParameters(e);var S=j.matchPrefix(e,"a=ssrc:").map(function(e){return j.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];S&&(b=S.value);var C=0<j.matchPrefix(e,"a=end-of-candidates",D).length,k=j.matchPrefix(e,"a=candidate:").map(function(e){return j.parseCandidate(e)}).filter(function(e){return"1"===e.component});if("offer"!==x.type||i)"answer"!==x.type||i||(c=(s=P.transceivers[t]).iceGatherer,u=s.iceTransport,p=s.dtlsTransport,d=s.rtpSender,l=s.rtpReceiver,f=s.sendEncodingParameters,m=s.localCapabilities,P.transceivers[t].recvEncodingParameters=h,P.transceivers[t].remoteCapabilities=w,P.transceivers[t].cname=b,(_||C)&&k.length&&u.setRemoteCandidates(k),P.usingBundle&&0!==t||(u.start(c,v,"controlling"),p.start(y)),P._transceive(s,"sendrecv"===o||"recvonly"===o,"sendrecv"===o||"sendonly"===o),!l||"sendrecv"!==o&&"sendonly"!==o?delete s.rtpReceiver:(g=l.track,O.push([g,l]),R.addTrack(g)));else{var E,T=P.usingBundle&&0<t?{iceGatherer:P.transceivers[0].iceGatherer,iceTransport:P.transceivers[0].iceTransport,dtlsTransport:P.transceivers[0].dtlsTransport}:P._createIceAndDtlsTransports(a,t);if(C&&T.iceTransport.setRemoteCandidates(k),(m=RTCRtpReceiver.getCapabilities(r)).codecs=m.codecs.filter(function(e){return"rtx"!==e.name}),f=[{ssrc:1001*(2*t+2)}],g=(l=new RTCRtpReceiver(T.dtlsTransport,r)).track,O.push([g,l]),R.addTrack(g),0<P.localStreams.length&&P.localStreams[0].getTracks().length>=t)"audio"===r?E=P.localStreams[0].getAudioTracks()[0]:"video"===r&&(E=P.localStreams[0].getVideoTracks()[0]),E&&(d=new RTCRtpSender(E,T.dtlsTransport));P.transceivers[t]={iceGatherer:T.iceGatherer,iceTransport:T.iceTransport,dtlsTransport:T.dtlsTransport,localCapabilities:m,remoteCapabilities:w,rtpSender:d,rtpReceiver:l,kind:r,mid:a,cname:b,sendEncodingParameters:f,recvEncodingParameters:h},P._transceive(P.transceivers[t],!1,"sendrecv"===o||"sendonly"===o)}}else P.transceivers[t]={mid:a,isDatachannel:!0}}),this.remoteDescription={type:x.type,sdp:x.sdp},x.type){case"offer":this._updateSignalingState("have-remote-offer");break;case"answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+x.type+'"')}return R.getTracks().length&&(P.remoteStreams.push(R),window.setTimeout(function(){var i=new Event("addstream");i.stream=R,P.dispatchEvent(i),null!==P.onaddstream&&window.setTimeout(function(){P.onaddstream(i)},0),O.forEach(function(e){var t=e[0],n=e[1],r=new Event("track");r.track=t,r.receiver=n,r.streams=[R],P.dispatchEvent(i),null!==P.ontrack&&window.setTimeout(function(){P.ontrack(r)},0)})},0)),1<arguments.length&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._updateSignalingState("closed")},window.RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this.dispatchEvent(t),null!==this.onsignalingstatechange&&this.onsignalingstatechange(t)},window.RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){var e=new Event("negotiationneeded");this.dispatchEvent(e),null!==this.onnegotiationneeded&&this.onnegotiationneeded(e)},window.RTCPeerConnection.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,failed:0};if(this.transceivers.forEach(function(e){t[e.iceTransport.state]++,t[e.dtlsTransport.state]++}),t.connected+=t.completed,e="new",0<t.failed?e="failed":0<t.connecting||0<t.checking?e="connecting":0<t.disconnected?e="disconnected":0<t.new?e="new":(0<t.connected||0<t.completed)&&(e="connected"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this.dispatchEvent(n),null!==this.oniceconnectionstatechange&&this.oniceconnectionstatechange(n)}},window.RTCPeerConnection.prototype.createOffer=function(){var e,p=this;if(this._pendingOffer)throw new Error("createOffer called while there is a pending offer.");1===arguments.length&&"function"!=typeof arguments[0]?e=arguments[0]:3===arguments.length&&(e=arguments[2]);var t=[],n=0,r=0;if(this.localStreams.length&&(n=this.localStreams[0].getAudioTracks().length,r=this.localStreams[0].getVideoTracks().length),e){if(e.mandatory||e.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==e.offerToReceiveAudio&&(n=e.offerToReceiveAudio),void 0!==e.offerToReceiveVideo&&(r=e.offerToReceiveVideo)}for(this.localStreams.length&&this.localStreams[0].getTracks().forEach(function(e){t.push({kind:e.kind,track:e,wantReceive:"audio"===e.kind?0<n:0<r}),"audio"===e.kind?n--:"video"===e.kind&&r--});0<n||0<r;)0<n&&(t.push({kind:"audio",wantReceive:!0}),n--),0<r&&(t.push({kind:"video",wantReceive:!0}),r--);var i=j.writeSessionBoilerplate(),d=[];t.forEach(function(e,t){var n,r,i=e.track,o=e.kind,a=j.generateIdentifier(),s=p.usingBundle&&0<t?{iceGatherer:d[0].iceGatherer,iceTransport:d[0].iceTransport,dtlsTransport:d[0].dtlsTransport}:p._createIceAndDtlsTransports(a,t),c=RTCRtpSender.getCapabilities(o);c.codecs=c.codecs.filter(function(e){return"rtx"!==e.name}),c.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1")});var u=[{ssrc:1001*(2*t+1)}];i&&(n=new RTCRtpSender(i,s.dtlsTransport)),e.wantReceive&&(r=new RTCRtpReceiver(s.dtlsTransport,o)),d[t]={iceGatherer:s.iceGatherer,iceTransport:s.iceTransport,dtlsTransport:s.dtlsTransport,localCapabilities:c,remoteCapabilities:null,rtpSender:n,rtpReceiver:r,kind:o,mid:a,sendEncodingParameters:u,recvEncodingParameters:null}}),this.usingBundle&&(i+="a=group:BUNDLE "+d.map(function(e){return e.mid}).join(" ")+"\r\n"),t.forEach(function(e,t){var n=d[t];i+=j.writeMediaSection(n,n.localCapabilities,"offer",p.localStreams[0])}),this._pendingOffer=d;var o=new RTCSessionDescription({type:"offer",sdp:i});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,o),Promise.resolve(o)},window.RTCPeerConnection.prototype.createAnswer=function(){var n=this,r=j.writeSessionBoilerplate();this.usingBundle&&(r+="a=group:BUNDLE "+this.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),this.transceivers.forEach(function(e){if(e.isDatachannel)r+="m=application 0 DTLS/SCTP 5000\r\nc=IN IP4 0.0.0.0\r\na=mid:"+e.mid+"\r\n";else{var t=n._getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);r+=j.writeMediaSection(e,t,"answer",n.localStreams[0])}});var e=new RTCSessionDescription({type:"answer",sdp:r});return arguments.length&&"function"==typeof arguments[0]&&window.setTimeout(arguments[0],0,e),Promise.resolve(e)},window.RTCPeerConnection.prototype.addIceCandidate=function(e){if(e){var t=e.sdpMLineIndex;if(e.sdpMid)for(var n=0;n<this.transceivers.length;n++)if(this.transceivers[n].mid===e.sdpMid){t=n;break}var r=this.transceivers[t];if(r){var i=0<Object.keys(e.candidate).length?j.parseCandidate(e.candidate):{};if("tcp"===i.protocol&&(0===i.port||9===i.port))return;if("1"!==i.component)return;"endOfCandidates"===i.type&&(i={}),r.iceTransport.addRemoteCandidate(i);var o=j.splitSections(this.remoteDescription.sdp);o[t+1]+=(i.type?e.candidate.trim():"a=end-of-candidates")+"\r\n",this.remoteDescription.sdp=o.join("")}}else this.transceivers.forEach(function(e){e.iceTransport.addRemoteCandidate({})});return 1<arguments.length&&"function"==typeof arguments[1]&&window.setTimeout(arguments[1],0),Promise.resolve()},window.RTCPeerConnection.prototype.getStats=function(){var r=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){t[e]&&r.push(t[e].getStats())})});var i=1<arguments.length&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(t){var n=new Map;Promise.all(r).then(function(e){e.forEach(function(t){Object.keys(t).forEach(function(e){n.set(e,t[e]),n[e]=t[e]})}),i&&window.setTimeout(i,0,n),t(n)})})}}};t.exports={shimPeerConnection:r.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":12,"./getusermedia":8,sdp:59}],8:[function(e,t,n){"use strict";t.exports=function(){var t=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(e){return t(e).catch(function(e){return Promise.reject({name:{PermissionDeniedError:"NotAllowedError"}[(t=e).name]||t.name,message:t.message,constraint:t.constraint,toString:function(){return this.name}});var t})}}},{}],9:[function(e,t,n){"use strict";var s=e("../utils").browserDetails,r={shimOnTrack:function(){"object"!=typeof window||!window.RTCPeerConnection||"ontrack"in window.RTCPeerConnection.prototype||Object.defineProperty(window.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly)),this.addEventListener("track",this._ontrack=e),this.addEventListener("addstream",this._ontrackpoly=function(n){n.stream.getTracks().forEach(function(e){var t=new Event("track");t.track=e,t.receiver={track:e},t.streams=[n.stream],this.dispatchEvent(t)}.bind(this))}.bind(this))}})},shimSourceObject:function(){"object"==typeof window&&(!window.HTMLMediaElement||"srcObject"in window.HTMLMediaElement.prototype||Object.defineProperty(window.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}}))},shimPeerConnection:function(){if("object"==typeof window&&(window.RTCPeerConnection||window.mozRTCPeerConnection)){window.RTCPeerConnection||(window.RTCPeerConnection=function(e,t){if(s.version<38&&e&&e.iceServers){for(var n=[],r=0;r<e.iceServers.length;r++){var i=e.iceServers[r];if(i.hasOwnProperty("urls"))for(var o=0;o<i.urls.length;o++){var a={url:i.urls[o]};0===i.urls[o].indexOf("turn")&&(a.username=i.username,a.credential=i.credential),n.push(a)}else n.push(e.iceServers[r])}e.iceServers=n}return new mozRTCPeerConnection(e,t)},window.RTCPeerConnection.prototype=mozRTCPeerConnection.prototype,mozRTCPeerConnection.generateCertificate&&Object.defineProperty(window.RTCPeerConnection,"generateCertificate",{get:function(){return mozRTCPeerConnection.generateCertificate}}),window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate),["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){return arguments[0]=new("addIceCandidate"===e?RTCIceCandidate:RTCSessionDescription)(arguments[0]),t.apply(this,arguments)}});var e=RTCPeerConnection.prototype.addIceCandidate;if(RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?e.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())},s.version<48){var r=RTCPeerConnection.prototype.getStats;RTCPeerConnection.prototype.getStats=function(e,t,n){return r.apply(this,[e||null]).then(function(e){return t=e,n=new Map,Object.keys(t).forEach(function(e){n.set(e,t[e]),n[e]=t[e]}),n;var t,n}).then(t,n)}}}}};t.exports={shimOnTrack:r.shimOnTrack,shimSourceObject:r.shimSourceObject,shimPeerConnection:r.shimPeerConnection,shimGetUserMedia:e("./getusermedia")}},{"../utils":12,"./getusermedia":10}],10:[function(e,t,n){"use strict";var o=e("../utils").log,a=e("../utils").browserDetails;t.exports=function(){var i=function(e){return{name:{SecurityError:"NotAllowedError",PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},r=function(e,t,n){var r=function(r){if("object"!=typeof r||r.require)return r;var i=[];return Object.keys(r).forEach(function(e){if("require"!==e&&"advanced"!==e&&"mediaSource"!==e){var t=r[e]="object"==typeof r[e]?r[e]:{ideal:r[e]};if(void 0===t.min&&void 0===t.max&&void 0===t.exact||i.push(e),void 0!==t.exact&&("number"==typeof t.exact?t.min=t.max=t.exact:r[e]=t.exact,delete t.exact),void 0!==t.ideal){r.advanced=r.advanced||[];var n={};"number"==typeof t.ideal?n[e]={min:t.ideal,max:t.ideal}:n[e]=t.ideal,r.advanced.push(n),delete t.ideal,Object.keys(t).length||delete r[e]}}}),i.length&&(r.require=i),r};return e=JSON.parse(JSON.stringify(e)),a.version<38&&(o("spec: "+JSON.stringify(e)),e.audio&&(e.audio=r(e.audio)),e.video&&(e.video=r(e.video)),o("ff37: "+JSON.stringify(e))),navigator.mozGetUserMedia(e,t,function(e){n(i(e))})};if(navigator.mediaDevices||(navigator.mediaDevices={getUserMedia:function(n){return new Promise(function(e,t){r(n,e,t)})},addEventListener:function(){},removeEventListener:function(){}}),navigator.mediaDevices.enumerateDevices=navigator.mediaDevices.enumerateDevices||function(){return new Promise(function(e){e([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}])})},a.version<41){var e=navigator.mediaDevices.enumerateDevices.bind(navigator.mediaDevices);navigator.mediaDevices.enumerateDevices=function(){return e().then(void 0,function(e){if("NotFoundError"===e.name)return[];throw e})}}if(a.version<49){var n=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);navigator.mediaDevices.getUserMedia=function(t){return n(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(function(e){e.stop()}),new DOMException("The object can not be found here.","NotFoundError");return e},function(e){return Promise.reject(i(e))})}}navigator.getUserMedia=function(e,t,n){if(a.version<44)return r(e,t,n);console.warn("navigator.getUserMedia has been replaced by navigator.mediaDevices.getUserMedia"),navigator.mediaDevices.getUserMedia(e).then(t,n)}}},{"../utils":12}],11:[function(e,t,n){"use strict";var r={shimGetUserMedia:function(){navigator.getUserMedia=navigator.webkitGetUserMedia}};t.exports={shimGetUserMedia:r.shimGetUserMedia}},{}],12:[function(e,t,n){"use strict";var r=!0,i={disableLog:function(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(r=e)?"adapter.js logging disabled":"adapter.js logging enabled"},log:function(){if("object"==typeof window){if(r)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},extractVersion:function(e,t,n){var r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)},detectBrowser:function(){var e={browser:null,version:null};if("undefined"==typeof window||!window.navigator)return e.browser="Not a browser.",e;if(navigator.mozGetUserMedia)e.browser="firefox",e.version=this.extractVersion(navigator.userAgent,/Firefox\/([0-9]+)\./,1);else if(navigator.webkitGetUserMedia)if(window.webkitRTCPeerConnection)e.browser="chrome",e.version=this.extractVersion(navigator.userAgent,/Chrom(e|ium)\/([0-9]+)\./,2);else{if(!navigator.userAgent.match(/Version\/(\d+).(\d+)/))return e.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",e;e.browser="safari",e.version=this.extractVersion(navigator.userAgent,/AppleWebKit\/([0-9]+)\./,1)}else{if(!navigator.mediaDevices||!navigator.userAgent.match(/Edge\/(\d+).(\d+)$/))return e.browser="Not a supported browser.",e;e.browser="edge",e.version=this.extractVersion(navigator.userAgent,/Edge\/(\d+).(\d+)$/,2)}return e}};t.exports={log:i.log,disableLog:i.disableLog,browserDetails:i.detectBrowser(),extractVersion:i.extractVersion}},{}],13:[function(e,t,n){function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}(t.exports=r).prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}},{}],14:[function(e,t,n){!function(d){"use strict";n.encode=function(e){var t,n=new Uint8Array(e),r=n.length,i="";for(t=0;t<r;t+=3)i+=d[n[t]>>2],i+=d[(3&n[t])<<4|n[t+1]>>4],i+=d[(15&n[t+1])<<2|n[t+2]>>6],i+=d[63&n[t+2]];return r%3==2?i=i.substring(0,i.length-1)+"=":r%3==1&&(i=i.substring(0,i.length-2)+"=="),i},n.decode=function(e){var t,n,r,i,o,a=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),p=new Uint8Array(u);for(t=0;t<s;t+=4)n=d.indexOf(e[t]),r=d.indexOf(e[t+1]),i=d.indexOf(e[t+2]),o=d.indexOf(e[t+3]),p[c++]=n<<2|r>>4,p[c++]=(15&r)<<4|i>>2,p[c++]=(3&i)<<6|63&o;return u}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],15:[function(e,c,t){(function(e){var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,t=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),n=t&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),r=i&&i.prototype.append&&i.prototype.getBlob;function o(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=i.buffer}e[t]=r}}}function a(e,t){t=t||{};var n=new i;o(e);for(var r=0;r<e.length;r++)n.append(e[r]);return t.type?n.getBlob(t.type):n.getBlob()}function s(e,t){return o(e),new Blob(e,t||{})}c.exports=t?n?e.Blob:s:r?a:void 0}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],16:[function(e,t,n){var r=[].slice;t.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},{}],17:[function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}(t.exports=r).prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},r.prototype.once=function(e,t){var n=this;function r(){n.off(e,r),t.apply(this,arguments)}return this._callbacks=this._callbacks||{},r.fn=t,this.on(e,r),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks[e];if(!r)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],18:[function(e,t,n){t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],19:[function(e,t,n){function o(i){return o.enabled(i)?function(e){var t;e=(t=e)instanceof Error?t.stack||t.message:t;var n=new Date,r=n-(o[i]||n);o[i]=n,e=i+" "+e+" +"+o.humanize(r),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}(t.exports=o).names=[],o.skips=[],o.enable=function(e){try{localStorage.debug=e}catch(e){}for(var t=(e||"").split(/[\s,]+/),n=t.length,r=0;r<n;r++)"-"===(e=t[r].replace("*",".*?"))[0]?o.skips.push(new RegExp("^"+e.substr(1)+"$")):o.names.push(new RegExp("^"+e+"$"))},o.disable=function(){o.enable("")},o.humanize=function(e){return 36e5<=e?(e/36e5).toFixed(1)+"h":6e4<=e?(e/6e4).toFixed(1)+"m":1e3<=e?(e/1e3|0)+"s":e+"ms"},o.enabled=function(e){for(var t=0,n=o.skips.length;t<n;t++)if(o.skips[t].test(e))return!1;for(t=0,n=o.names.length;t<n;t++)if(o.names[t].test(e))return!0;return!1};try{window.localStorage&&o.enable(localStorage.debug)}catch(e){}},{}],20:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":21}],21:[function(e,t,n){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":22,"engine.io-parser":33}],22:[function(t,u,e){(function(r){var n=t("./transports"),e=t("component-emitter"),d=t("debug")("engine.io-client:socket"),i=t("indexof"),o=t("engine.io-parser"),a=t("parseuri"),s=t("parsejson"),c=t("parseqs");function l(e,t){if(!(this instanceof l))return new l(e,t);if(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e&&(e=a(e),t.host=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)),this.secure=null!=t.secure?t.secure:r.location&&"https:"==location.protocol,t.host){var n=t.host.split(":");t.hostname=n.shift(),n.length?t.port=n.pop():t.port||(t.port=this.secure?"443":"80")}this.agent=t.agent||!1,this.hostname=t.hostname||(r.location?location.hostname:"localhost"),this.port=t.port||(r.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=t.rejectUnauthorized||null,this.open()}(u.exports=l).priorWebsocketSuccess=!1,e(l.prototype),l.protocol=o.protocol,(l.Socket=l).Transport=t("./transport"),l.transports=t("./transports"),l.parser=t("engine.io-parser"),l.prototype.createTransport=function(e){d('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);return t.EIO=o.protocol,t.transport=e,this.id&&(t.sid=this.id),new n[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})},l.prototype.open=function(){var e;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0==this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},l.prototype.setTransport=function(e){d("setting transport %s",e.name);var t=this;this.transport&&(d("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),(this.transport=e).on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},l.prototype.probe=function(n){d('probing transport "%s"',n);var r=this.createTransport(n,{probe:1}),i=!1,o=this;function e(){if(o.onlyBinaryUpgrades){var e=!this.supportsBinary&&o.transport.supportsBinary;i=i||e}i||(d('probe transport "%s" opened',n),r.send([{type:"ping",data:"probe"}]),r.once("packet",function(e){if(!i)if("pong"==e.type&&"probe"==e.data){if(d('probe transport "%s" pong',n),o.upgrading=!0,o.emit("upgrading",r),!r)return;l.priorWebsocketSuccess="websocket"==r.name,d('pausing current transport "%s"',o.transport.name),o.transport.pause(function(){i||"closed"!=o.readyState&&(d("changing transport and sending upgrade packet"),p(),o.setTransport(r),r.send([{type:"upgrade"}]),o.emit("upgrade",r),r=null,o.upgrading=!1,o.flush())})}else{d('probe transport "%s" failed',n);var t=new Error("probe error");t.transport=r.name,o.emit("upgradeError",t)}}))}function a(){i||(i=!0,p(),r.close(),r=null)}function t(e){var t=new Error("probe error: "+e);t.transport=r.name,a(),d('probe transport "%s" failed because of error: %s',n,e),o.emit("upgradeError",t)}function s(){t("transport closed")}function c(){t("socket closed")}function u(e){r&&e.name!=r.name&&(d('"%s" works - aborting "%s"',e.name,r.name),a())}function p(){r.removeListener("open",e),r.removeListener("error",t),r.removeListener("close",s),o.removeListener("close",c),o.removeListener("upgrading",u)}l.priorWebsocketSuccess=!1,r.once("open",e),r.once("error",t),r.once("close",s),this.once("close",c),this.once("upgrading",u),r.open()},l.prototype.onOpen=function(){if(d("socket open"),this.readyState="open",l.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){d("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},l.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(d('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(s(e.data));break;case"pong":this.setPing();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else d('packet received with socket readyState "%s"',this.readyState)},l.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},l.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},l.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){d("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},l.prototype.ping=function(){this.sendPacket("ping")},l.prototype.onDrain=function(){for(var e=0;e<this.prevBufferLen;e++)this.callbackBuffer[e]&&this.callbackBuffer[e]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)==this.writeBuffer.length?this.emit("drain"):this.flush()},l.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(d("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},l.prototype.write=l.prototype.send=function(e,t){return this.sendPacket("message",e,t),this},l.prototype.sendPacket=function(e,t,n){if("closing"!=this.readyState&&"closed"!=this.readyState){var r={type:e,data:t};this.emit("packetCreate",r),this.writeBuffer.push(r),this.callbackBuffer.push(n),this.flush()}},l.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var e=this;function t(){e.onClose("forced close"),d("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}return this},l.prototype.onError=function(e){d("socket error %j",e),l.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},l.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){d('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){n.writeBuffer=[],n.callbackBuffer=[],n.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t)}},l.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~i(this.transports,e[n])&&t.push(e[n]);return t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":23,"./transports":24,"component-emitter":17,debug:30,"engine.io-parser":33,indexof:41,parsejson:49,parseqs:50,parseuri:32}],23:[function(e,t,n){var r=e("engine.io-parser");function i(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized}e("component-emitter")((t.exports=i).prototype),i.timestamps=0,i.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},i.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},i.prototype.onPacket=function(e){this.emit("packet",e)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":17,"engine.io-parser":33}],24:[function(t,e,n){(function(a){var s=t("xmlhttprequest"),c=t("./polling-xhr"),u=t("./polling-jsonp"),e=t("./websocket");n.polling=function(e){var t=!1,n=!1,r=!1!==e.jsonp;if(a.location){var i="https:"==location.protocol,o=location.port;o||(o=i?443:80),t=e.hostname!=location.hostname||o!=e.port,n=e.secure!=i}{if(e.xdomain=t,e.xscheme=n,"open"in new s(e)&&!e.forceJSONP)return new c(e);if(!r)throw new Error("JSONP disabled");return new u(e)}},n.websocket=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":25,"./polling-xhr":26,"./websocket":28,xmlhttprequest:29}],25:[function(a,s,e){(function(n){var r=a("./polling"),e=a("component-inherit");s.exports=t;var i,u=/\n/g,p=/\\n/g;function o(){}function t(e){r.call(this,e),this.query=this.query||{},i||(n.___eio||(n.___eio=[]),i=n.___eio),this.index=i.length;var t=this;i.push(function(e){t.onData(e)}),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=o)},!1)}e(t,r),t.prototype.supportsBinary=!1,t.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},t.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},t.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,i=document.createElement("form"),o=document.createElement("textarea"),a=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=a,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function s(){c(),t()}function c(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),c(),e=e.replace(p,"\\\n"),this.area.value=e.replace(u,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==n.iframe.readyState&&s()}:this.iframe.onload=s}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":27,"component-inherit":18}],26:[function(p,d,e){(function(r){var i=p("xmlhttprequest"),o=p("./polling"),e=p("component-emitter"),t=p("component-inherit"),a=p("debug")("engine.io-client:polling-xhr");function n(){}function s(e){if(o.call(this,e),r.location){var t="https:"==location.protocol,n=location.port;n||(n=t?443:80),this.xd=e.hostname!=r.location.hostname||n!=e.port,this.xs=e.secure!=t}}function c(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=null!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.create()}function u(){for(var e in c.requests)c.requests.hasOwnProperty(e)&&c.requests[e].abort()}d.exports=s,d.exports.Request=c,t(s,o),s.prototype.supportsBinary=!0,s.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,new c(e)},s.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=r},s.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},e(c.prototype),c.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new i(e),n=this;try{if(a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async),this.supportsBinary&&(t.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){4==t.readyState&&(200==t.status||1223==t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},a("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}r.document&&(this.index=c.requestsCount++,c.requests[this.index]=this)},c.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},c.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},c.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},c.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,e)try{this.xhr.abort()}catch(e){}r.document&&delete c.requests[this.index],this.xhr=null}},c.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}e="application/octet-stream"===t?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},c.prototype.hasXDR=function(){return void 0!==r.XDomainRequest&&!this.xs&&this.enablesXDR},c.prototype.abort=function(){this.cleanup()},r.document&&(c.requestsCount=0,c.requests={},r.attachEvent?r.attachEvent("onunload",u):r.addEventListener&&r.addEventListener("beforeunload",u,!1))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":27,"component-emitter":17,"component-inherit":18,debug:30,xmlhttprequest:29}],27:[function(e,t,n){var r=e("../transport"),i=e("parseqs"),o=e("engine.io-parser"),a=e("component-inherit"),s=e("debug")("engine.io-client:polling");t.exports=u;var c=null!=new(e("xmlhttprequest"))({xdomain:!1}).responseType;function u(e){var t=e&&e.forceBase64;c&&!t||(this.supportsBinary=!1),r.call(this,e)}a(u,r),u.prototype.name="polling",u.prototype.doOpen=function(){this.poll()},u.prototype.pause=function(e){var t=this;function n(){s("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(s("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){s("pre-pause polling complete"),--r||n()})),this.writable||(s("we are currently writing - waiting to pause"),r++,this.once("drain",function(){s("pre-pause writing complete"),--r||n()}))}else n()},u.prototype.poll=function(){s("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},u.prototype.onData=function(e){var r=this;s("polling got data %s",e);o.decodePayload(e,this.socket.binaryType,function(e,t,n){if("opening"==r.readyState&&r.onOpen(),"close"==e.type)return r.onClose(),!1;r.onPacket(e)}),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():s('ignoring poll - transport state "%s"',this.readyState))},u.prototype.doClose=function(){var e=this;function t(){s("writing close packet"),e.write([{type:"close"}])}"open"==this.readyState?(s("transport open - closing"),t()):(s("transport not open - deferring close"),this.once("open",t))},u.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};t=this;o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=+new Date+"-"+r.timestamps++),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e}},{"../transport":23,"component-inherit":18,debug:30,"engine.io-parser":33,parseqs:50,xmlhttprequest:29}],28:[function(e,t,n){var r=e("../transport"),i=e("engine.io-parser"),o=e("parseqs"),a=e("component-inherit"),s=e("debug")("engine.io-client:websocket"),c=e("ws");function u(e){e&&e.forceBase64&&(this.supportsBinary=!1),r.call(this,e)}a(t.exports=u,r),u.prototype.name="websocket",u.prototype.supportsBinary=!0,u.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t={agent:this.agent};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,this.ws=new c(e,void 0,t),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},u.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(u.prototype.onData=function(e){var t=this;setTimeout(function(){r.prototype.onData.call(t,e)},0)}),u.prototype.write=function(e){var t=this;this.writable=!1;for(var n=0,r=e.length;n<r;n++)i.encodePacket(e[n],this.supportsBinary,function(e){try{t.ws.send(e)}catch(e){s("websocket closed before onclose event")}});setTimeout(function(){t.writable=!0,t.emit("drain")},0)},u.prototype.onClose=function(){r.prototype.onClose.call(this)},u.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+new Date),this.supportsBinary||(e.b64=1),(e=o.encode(e)).length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e},u.prototype.check=function(){return!(!c||"__initialize"in c&&this.name===u.prototype.name)}},{"../transport":23,"component-inherit":18,debug:30,"engine.io-parser":33,parseqs:50,ws:76}],29:[function(e,t,n){var i=e("has-cors");t.exports=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||i))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}},{"has-cors":40}],30:[function(e,t,o){function n(){var e;try{e=localStorage.debug}catch(e){}return e}(o=t.exports=e("./debug")).log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)},o.formatArgs=function(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+o.humanize(this.diff),!t)return e;var n="color: "+this.color;e=[e[0],n,"color: inherit"].concat(Array.prototype.slice.call(e,1));var r=0,i=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(r++,"%c"===e&&(i=r))}),e.splice(i,0,n),e},o.save=function(e){try{null==e?localStorage.removeItem("debug"):localStorage.debug=e}catch(e){}},o.load=n,o.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)},o.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],o.formatters.j=function(e){return JSON.stringify(e)},o.enable(n())},{"./debug":31}],31:[function(e,t,s){(s=t.exports=function(e){function t(){}function r(){var i=r,e=+new Date,t=e-(c||e);i.diff=t,i.prev=c,i.curr=e,c=e,null==i.useColors&&(i.useColors=s.useColors()),null==i.color&&i.useColors&&(i.color=s.colors[u++%s.colors.length]);var o=Array.prototype.slice.call(arguments);o[0]=s.coerce(o[0]),"string"!=typeof o[0]&&(o=["%o"].concat(o));var a=0;o[0]=o[0].replace(/%([a-z%])/g,function(e,t){if("%%"===e)return e;a++;var n=s.formatters[t];if("function"==typeof n){var r=o[a];e=n.call(i,r),o.splice(a,1),a--}return e}),"function"==typeof s.formatArgs&&(o=s.formatArgs.apply(i,o));var n=r.log||s.log||console.log.bind(console);n.apply(i,o)}t.enabled=!1,r.enabled=!0;var n=s.enabled(e)?r:t;return n.namespace=e,n}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},s.disable=function(){s.enable("")},s.enable=function(e){s.save(e);for(var t=(e||"").split(/[\s,]+/),n=t.length,r=0;r<n;r++)t[r]&&("-"===(e=t[r].replace(/\*/g,".*?"))[0]?s.skips.push(new RegExp("^"+e.substr(1)+"$")):s.names.push(new RegExp("^"+e+"$")))},s.enabled=function(e){var t,n;for(t=0,n=s.skips.length;t<n;t++)if(s.skips[t].test(e))return!1;for(t=0,n=s.names.length;t<n;t++)if(s.names[t].test(e))return!0;return!1},s.humanize=e("ms"),s.names=[],s.skips=[],s.formatters={};var c,u=0},{ms:47}],32:[function(e,t,n){var s=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,c=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var i=s.exec(e||""),o={},a=14;a--;)o[c[a]]=i[a]||"";return-1!=n&&-1!=r&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o}},{}],33:[function(r,e,g){(function(u){var e=r("./keys"),i=r("has-binary"),f=r("arraybuffer.slice"),o=r("base64-arraybuffer"),s=r("after"),p=r("utf8"),t=navigator.userAgent.match(/Android/i),n=/PhantomJS/i.test(navigator.userAgent),d=t||n;g.protocol=3;var l=g.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},a=e(l),h={type:"error",data:"parser error"},m=r("blob");function c(e,t,n){for(var i=new Array(e.length),r=s(e.length,n),o=function(n,e,r){t(e,function(e,t){i[n]=t,r(e,i)})},a=0;a<e.length;a++)o(a,e[a],r)}g.encodePacket=function(e,t,n,r){"function"==typeof t&&(r=t,t=!1),"function"==typeof n&&(r=n,n=null);var i,o,a,s=void 0===e.data?void 0:e.data.buffer||e.data;if(u.ArrayBuffer&&s instanceof ArrayBuffer)return function(e,t,n){if(!t)return g.encodeBase64Packet(e,n);var r=e.data,i=new Uint8Array(r),o=new Uint8Array(1+r.byteLength);o[0]=l[e.type];for(var a=0;a<i.length;a++)o[a+1]=i[a];return n(o.buffer)}(e,t,r);if(m&&s instanceof u.Blob)return function(e,t,n){if(!t)return g.encodeBase64Packet(e,n);if(d)return function(e,t,n){if(!t)return g.encodeBase64Packet(e,n);var r=new FileReader;return r.onload=function(){e.data=r.result,g.encodePacket(e,t,!0,n)},r.readAsArrayBuffer(e.data)}(e,t,n);var r=new Uint8Array(1);r[0]=l[e.type];var i=new m([r.buffer,e.data]);return n(i)}(e,t,r);if(s&&s.base64)return i=e,o=r,a="b"+g.packets[i.type]+i.data.data,o(a);var c=l[e.type];return void 0!==e.data&&(c+=n?p.encode(String(e.data)):String(e.data)),r(""+c)},g.encodeBase64Packet=function(t,n){var r,i="b"+g.packets[t.type];if(m&&t.data instanceof m){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(i+e)},o.readAsDataURL(t.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var a=new Uint8Array(t.data),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a[c];r=String.fromCharCode.apply(null,s)}return i+=u.btoa(r),n(i)},g.decodePacket=function(e,t,n){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return g.decodeBase64Packet(e.substr(1),t);if(n)try{e=p.decode(e)}catch(e){return h}var r=e.charAt(0);return Number(r)==r&&a[r]?1<e.length?{type:a[r],data:e.substring(1)}:{type:a[r]}:h}r=new Uint8Array(e)[0];var i=f(e,1);return m&&"blob"===t&&(i=new m([i])),{type:a[r],data:i}},g.decodeBase64Packet=function(e,t){var n=a[e.charAt(0)];if(!u.ArrayBuffer)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=o.decode(e.substr(1));return"blob"===t&&m&&(r=new m([r])),{type:n,data:r}},g.encodePayload=function(e,t,n){"function"==typeof t&&(n=t,t=null);var r=i(e);if(t&&r)return m&&!d?g.encodePayloadAsBlob(e,n):g.encodePayloadAsArrayBuffer(e,n);if(!e.length)return n("0:");c(e,function(e,n){g.encodePacket(e,!!r&&t,!0,function(e){var t;n(null,(t=e).length+":"+t)})},function(e,t){return n(t.join(""))})},g.decodePayload=function(e,t,n){if("string"!=typeof e)return g.decodePayloadAsBinary(e,t,n);var r;if("function"==typeof t&&(n=t,t=null),""==e)return n(h,0,1);for(var i,o,a="",s=0,c=e.length;s<c;s++){var u=e.charAt(s);if(":"!=u)a+=u;else{if(""==a||a!=(i=Number(a)))return n(h,0,1);if(a!=(o=e.substr(s+1,i)).length)return n(h,0,1);if(o.length){if(r=g.decodePacket(o,t,!0),h.type==r.type&&h.data==r.data)return n(h,0,1);if(!1===n(r,s+i,c))return}s+=i,a=""}}return""!=a?n(h,0,1):void 0},g.encodePayloadAsArrayBuffer=function(e,r){if(!e.length)return r(new ArrayBuffer(0));c(e,function(e,t){g.encodePacket(e,!0,!0,function(e){return t(null,e)})},function(e,t){var n=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),a=new Uint8Array(n),s=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);n=r.buffer}a[s++]=t?0:1;var o=n.byteLength.toString();for(i=0;i<o.length;i++)a[s++]=parseInt(o[i]);a[s++]=255;for(r=new Uint8Array(n),i=0;i<r.length;i++)a[s++]=r[i]}),r(a.buffer)})},g.encodePayloadAsBlob=function(e,n){c(e,function(e,s){g.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);e=n.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),o=new Uint8Array(i.length+1);for(r=0;r<i.length;r++)o[r]=parseInt(i[r]);if(o[i.length]=255,m){var a=new m([t.buffer,o.buffer,e]);s(null,a)}})},function(e,t){return n(new m(t))})},g.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var t=e,i=[],o=!1;0<t.byteLength;){for(var a=new Uint8Array(t),s=0===a[0],c="",u=1;255!=a[u];u++){if(310<c.length){o=!0;break}c+=a[u]}if(o)return r(h,0,1);t=f(t,2+c.length),c=parseInt(c);var p=f(t,0,c);if(s)try{p=String.fromCharCode.apply(null,new Uint8Array(p))}catch(e){var d=new Uint8Array(p);p="";for(u=0;u<d.length;u++)p+=String.fromCharCode(d[u])}i.push(p),t=f(t,c)}var l=i.length;i.forEach(function(e,t){r(g.decodePacket(e,n,!0),t,l)})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":34,after:1,"arraybuffer.slice":2,"base64-arraybuffer":14,blob:15,"has-binary":39,utf8:70}],34:[function(e,t,n){t.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},{}],35:[function(e,t,n){var r=e("wildemitter"),i=e("util");function o(e){r.call(this);var t,n=e||{};for(t in this.config={chunksize:16384,pacing:0},n)this.config[t]=n[t];this.file=null,this.channel=null}function a(){r.call(this),this.receiveBuffer=[],this.received=0,this.metadata={},this.channel=null}i.inherits(o,r),o.prototype.send=function(n,r){var i=this;this.file=n;var o="number"!=typeof(this.channel=r).bufferedAmountLowThreshold,a=0,s=function(){var e=new window.FileReader;e.onload=function(e){i.channel.send(e.target.result),i.emit("progress",a,n.size,e.target.result),n.size>a+e.target.result.byteLength?o?window.setTimeout(s,i.config.pacing):r.bufferedAmount<=r.bufferedAmountLowThreshold&&window.setTimeout(s,0):(i.emit("progress",n.size,n.size,null),i.emit("sentFile")),a+=i.config.chunksize};var t=n.slice(a,a+i.config.chunksize);e.readAsArrayBuffer(t)};o||(r.bufferedAmountLowThreshold=8*this.config.chunksize,r.addEventListener("bufferedamountlow",s)),window.setTimeout(s,0)},i.inherits(a,r),a.prototype.receive=function(e,t){var n=this;e&&(this.metadata=e),(this.channel=t).binaryType="arraybuffer",this.channel.onmessage=function(e){var t=e.data.byteLength;n.received+=t,n.receiveBuffer.push(e.data),n.emit("progress",n.received,n.metadata.size,e.data),n.received===n.metadata.size?(n.emit("receivedFile",new window.Blob(n.receiveBuffer),n.metadata),n.receiveBuffer=[]):n.received>n.metadata.size&&(console.error("received more than expected, discarding..."),n.receiveBuffer=[])}},t.exports={},t.exports.support="undefined"!=typeof window&&window&&window.File&&window.FileReader&&window.Blob,t.exports.Sender=o,t.exports.Receiver=a},{util:73,wildemitter:75}],36:[function(e,t,n){var u={};t.exports=function(n,e){var t,r=2===arguments.length,i=r?e:n;if("undefined"==typeof window||"http:"===window.location.protocol)return(t=new Error("NavigatorUserMediaError")).name="HTTPS_REQUIRED",i(t);if(window.navigator.userAgent.match("Chrome")){var o=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),a=33,s=!window.chrome.webstore;if(window.navigator.userAgent.match("Linux")&&(a=35),sessionStorage.getScreenMediaJSExtensionId)chrome.runtime.sendMessage(sessionStorage.getScreenMediaJSExtensionId,{type:"getScreen",id:1},null,function(e){if(e&&""!==e.sourceId)(n=r&&n||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3}}}).video.mandatory.chromeMediaSourceId=e.sourceId,window.navigator.mediaDevices.getUserMedia(n).then(function(e){i(null,e)}).catch(function(e){i(e)});else{var t=new Error("NavigatorUserMediaError");t.name="NotAllowedError",i(t)}});else if(window.cefGetScreenMedia)window.cefGetScreenMedia(function(e){if(e)(n=r&&n||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=e,window.navigator.mediaDevices.getUserMedia(n).then(function(e){i(null,e)}).catch(function(e){i(e)});else{var t=new Error("cefGetScreenMediaError");t.name="CEF_GETSCREENMEDIA_CANCELED",i(t)}});else if(s||26<=o&&o<=a)n=r&&n||{video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3,chromeMediaSource:"screen"}}},window.navigator.mediaDevices.getUserMedia(n).then(function(e){i(null,e)}).catch(function(e){i(e)});else{var c=window.setTimeout(function(){return(t=new Error("NavigatorUserMediaError")).name="EXTENSION_UNAVAILABLE",i(t)},1e3);u[c]=[i,r?n:null],window.postMessage({type:"getScreen",id:c},"*")}}else if(window.navigator.userAgent.match("Firefox")){33<=parseInt(window.navigator.userAgent.match(/Firefox\/(.*)/)[1],10)?(n=r&&n||{video:{mozMediaSource:"window",mediaSource:"window"}},window.navigator.mediaDevices.getUserMedia(n).then(function(e){i(null,e);var t=e.currentTime,n=window.setInterval(function(){e||window.clearInterval(n),e.currentTime==t&&(window.clearInterval(n),e.onended&&e.onended()),t=e.currentTime},500)}).catch(function(e){i(e)})):(t=new Error("NavigatorUserMediaError")).name="EXTENSION_UNAVAILABLE"}},"undefined"!=typeof window&&window.addEventListener("message",function(e){if(e.origin==window.location.origin)if("gotScreen"==e.data.type&&u[e.data.id]){var t=u[e.data.id],n=t[1],r=t[0];if(delete u[e.data.id],""===e.data.sourceId){var i=new Error("NavigatorUserMediaError");i.name="NotAllowedError",r(i)}else(n=n||{audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,maxFrameRate:3},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=e.data.sourceId,window.navigator.mediaDevices.getUserMedia(n).then(function(e){r(null,e)}).catch(function(e){r(e)})}else"getScreenPending"==e.data.type&&window.clearTimeout(e.data.id)})},{}],37:[function(e,t,n){t.exports=function(){return this}()},{}],38:[function(e,t,n){var h,m=e("wildemitter");"undefined"!=typeof window&&(h=window.AudioContext||window.webkitAudioContext);var g=null;t.exports=function(e,t){var r=new m;if(!h)return r;var n,i,o,a=(t=t||{}).smoothing||.1,s=t.interval||50,c=t.threshold,u=t.play,p=t.history||10,d=!0;g||(g=new h),(o=g.createAnalyser()).fftSize=512,o.smoothingTimeConstant=a,i=new Float32Array(o.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(n=g.createMediaElementSource(e),void 0===u&&(u=!0)):n=g.createMediaStreamSource(e),c=c||-50,n.connect(o),u&&o.connect(g.destination),r.speaking=!1,r.setThreshold=function(e){c=e},r.setInterval=function(e){s=e},r.stop=function(){d=!1,r.emit("volume_change",-100,c),r.speaking&&(r.speaking=!1,r.emit("stopped_speaking")),o.disconnect(),n.disconnect()},r.speakingHistory=[];for(var l=0;l<p;l++)r.speakingHistory.push(0);var f=function(){setTimeout(function(){if(d){var e=function(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var r=4,i=t.length;r<i;r++)t[r]>n&&t[r]<0&&(n=t[r]);return n}(o,i);r.emit("volume_change",e,c);var t=0;if(c<e&&!r.speaking){for(var n=r.speakingHistory.length-3;n<r.speakingHistory.length;n++)t+=r.speakingHistory[n];2<=t&&(r.speaking=!0,r.emit("speaking"))}else if(e<c&&r.speaking){for(n=0;n<r.speakingHistory.length;n++)t+=r.speakingHistory[n];0==t&&(r.speaking=!1,r.emit("stopped_speaking"))}r.speakingHistory.shift(),r.speakingHistory.push(0+(c<e)),f()}},s)};return f(),r}},{wildemitter:75}],39:[function(e,t,n){(function(i){var o=e("isarray");t.exports=function(e){return function e(t){if(!t)return!1;if(i.Buffer&&i.Buffer.isBuffer(t)||i.ArrayBuffer&&t instanceof ArrayBuffer||i.Blob&&t instanceof Blob||i.File&&t instanceof File)return!0;if(o(t)){for(var n=0;n<t.length;n++)if(e(t[n]))return!0}else if(t&&"object"==typeof t)for(var r in t.toJSON&&(t=t.toJSON()),t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return!0;return!1}(e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:42}],40:[function(e,t,n){var r=e("global");try{t.exports="XMLHttpRequest"in r&&"withCredentials"in new r.XMLHttpRequest}catch(e){t.exports=!1}},{global:37}],41:[function(e,t,n){var r=[].indexOf;t.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},{}],42:[function(e,t,n){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],43:[function(e,t,r){!function(e){var k,E,T,x={}.toString,t="object"==typeof JSON&&JSON,c="object"==typeof r&&r&&!r.nodeType&&r;c&&t?(c.stringify=t.stringify,c.parse=t.parse):c=e.JSON=t||{};var u=new Date(-0xc782b5b800cec);try{u=-109252==u.getUTCFullYear()&&0===u.getUTCMonth()&&1===u.getUTCDate()&&10==u.getUTCHours()&&37==u.getUTCMinutes()&&6==u.getUTCSeconds()&&708==u.getUTCMilliseconds()}catch(e){}function p(e){if(p[e]!==T)return p[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=p("json-stringify")&&p("json-parse");else{var n,r='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var i=c.stringify,o="function"==typeof i&&u;if(o){(n=function(){return 1}).toJSON=n;try{o="0"===i(0)&&"0"===i(new Number)&&'""'==i(new String)&&i(x)===T&&i(T)===T&&i()===T&&"1"===i(n)&&"[1]"==i([n])&&"[null]"==i([T])&&"null"==i(null)&&"[null,null,null]"==i([T,x,null])&&i({a:[n,!0,!1,null,"\0\b\n\f\r\t"]})==r&&"1"===i(null,n)&&"[\n 1,\n 2\n]"==i([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==i(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==i(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==i(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==i(new Date(-1))}catch(e){o=!1}}t=o}if("json-parse"==e){var a=c.parse;if("function"==typeof a)try{if(0===a("0")&&!a(!1)){var s=5==(n=a(r)).a.length&&1===n.a[0];if(s){try{s=!a('"\t"')}catch(e){}if(s)try{s=1!==a("01")}catch(e){}if(s)try{s=1!==a("1.")}catch(e){}}}}catch(e){s=!1}t=s}}return p[e]=!!t}if(!p("json")){var d="[object Function]",P="[object Number]",R="[object String]",O="[object Array]",s=p("bug-string-char-index");if(!u)var D=Math.floor,n=[0,31,59,90,120,151,181,212,243,273,304,334],_=function(e,t){return n[t]+365*(e-1970)+D((e-1969+(t=+(1<t)))/4)-D((e-1901+t)/100)+D((e-1601+t)/400)};(k={}.hasOwnProperty)||(k=function(e){var n,t={};return(t.__proto__=null,t.__proto__={toString:1},t).toString!=x?k=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(n=t.constructor,k=function(e){var t=(this.constructor||n).prototype;return e in this&&!(e in t&&this[e]===t[e])}),t=null,k.call(this,e)});var l={boolean:1,number:1,string:1,undefined:1};if(E=function(e,t){var n,u,r,i=0;for(r in(n=function(){this.valueOf=0}).prototype.valueOf=0,u=new n)k.call(u,r)&&i++;return n=u=null,i?E=2==i?function(e,t){var n,r={},i=x.call(e)==d;for(n in e)i&&"prototype"==n||k.call(r,n)||!(r[n]=1)||!k.call(e,n)||t(n)}:function(e,t){var n,r,i=x.call(e)==d;for(n in e)i&&"prototype"==n||!k.call(e,n)||(r="constructor"===n)||t(n);(r||k.call(e,n="constructor"))&&t(n)}:(u=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],E=function(e,t){var n,r,i,o,a,s=x.call(e)==d,c=s||"function"==typeof e.constructor||("object"==(a=typeof(i=e)[o="hasOwnProperty"])?!i[o]:l[a])?k:e.hasOwnProperty;for(n in e)s&&"prototype"==n||!c.call(e,n)||t(n);for(r=u.length;n=u[--r];c.call(e,n)&&t(n));}),E(e,t)},!p("json-stringify")){var f={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},j=function(e,t){return("000000"+(t||0)).slice(-e)},A=function(e){var t,n='"',r=0,i=e.length,o=10<i&&s;for(o&&(t=e.split(""));r<i;r++){var a=e.charCodeAt(r);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=f[a];break;default:if(a<32){n+="\\u00"+j(2,a.toString(16));break}n+=o?t[r]:s?e.charAt(r):e[r]}}return n+'"'},M=function(e,t,n,r,i,o,a){var s,c,u,p,d,l,f,h,m,g,v,y,b,w,S,C;try{s=t[e]}catch(e){}if("object"==typeof s&&s)if("[object Date]"!=(c=x.call(s))||k.call(s,"toJSON"))"function"==typeof s.toJSON&&(c!=P&&c!=R&&c!=O||k.call(s,"toJSON"))&&(s=s.toJSON(e));else if(-1/0<s&&s<1/0){if(_){for(d=D(s/864e5),u=D(d/365.2425)+1970-1;_(u+1,0)<=d;u++);for(p=D((d-_(u,0))/30.42);_(u,p+1)<=d;p++);d=1+d-_(u,p),f=D((l=(s%864e5+864e5)%864e5)/36e5)%24,h=D(l/6e4)%60,m=D(l/1e3)%60,g=l%1e3}else u=s.getUTCFullYear(),p=s.getUTCMonth(),d=s.getUTCDate(),f=s.getUTCHours(),h=s.getUTCMinutes(),m=s.getUTCSeconds(),g=s.getUTCMilliseconds();s=(u<=0||1e4<=u?(u<0?"-":"+")+j(6,u<0?-u:u):j(4,u))+"-"+j(2,p+1)+"-"+j(2,d)+"T"+j(2,f)+":"+j(2,h)+":"+j(2,m)+"."+j(3,g)+"Z"}else s=null;if(n&&(s=n.call(t,e,s)),null===s)return"null";if("[object Boolean]"==(c=x.call(s)))return""+s;if(c==P)return-1/0<s&&s<1/0?""+s:"null";if(c==R)return A(""+s);if("object"==typeof s){for(w=a.length;w--;)if(a[w]===s)throw TypeError();if(a.push(s),v=[],S=o,o+=i,c==O){for(b=0,w=s.length;b<w;b++)y=M(b,s,n,r,i,o,a),v.push(y===T?"null":y);C=v.length?i?"[\n"+o+v.join(",\n"+o)+"\n"+S+"]":"["+v.join(",")+"]":"[]"}else E(r||s,function(e){var t=M(e,s,n,r,i,o,a);t!==T&&v.push(A(e)+":"+(i?" ":"")+t)}),C=v.length?i?"{\n"+o+v.join(",\n"+o)+"\n"+S+"}":"{"+v.join(",")+"}":"{}";return a.pop(),C}};c.stringify=function(e,t,n){var r,i,o,a;if("function"==typeof t||"object"==typeof t&&t)if((a=x.call(t))==d)i=t;else if(a==O){o={};for(var s,c=0,u=t.length;c<u;s=t[c++],((a=x.call(s))==R||a==P)&&(o[s]=1));}if(n)if((a=x.call(n))==P){if(0<(n-=n%1))for(r="",10<n&&(n=10);r.length<n;r+=" ");}else a==R&&(r=n.length<=10?n:n.slice(0,10));return M("",((s={})[""]=e,s),i,o,r,"",[])}}if(!p("json-parse")){var h,m,g=String.fromCharCode,v={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},y=function(){throw h=m=null,SyntaxError()},i=function(){for(var e,t,n,r,i,o=m,a=o.length;h<a;)switch(i=o.charCodeAt(h)){case 9:case 10:case 13:case 32:h++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=s?o.charAt(h):o[h],h++,e;case 34:for(e="@",h++;h<a;)if((i=o.charCodeAt(h))<32)y();else if(92==i)switch(i=o.charCodeAt(++h)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=v[i],h++;break;case 117:for(t=++h,n=h+4;h<n;h++)48<=(i=o.charCodeAt(h))&&i<=57||97<=i&&i<=102||65<=i&&i<=70||y();e+=g("0x"+o.slice(t,h));break;default:y()}else{if(34==i)break;for(i=o.charCodeAt(h),t=h;32<=i&&92!=i&&34!=i;)i=o.charCodeAt(++h);e+=o.slice(t,h)}if(34==o.charCodeAt(h))return h++,e;y();default:if(t=h,45==i&&(r=!0,i=o.charCodeAt(++h)),48<=i&&i<=57){for(48==i&&(48<=(i=o.charCodeAt(h+1))&&i<=57)&&y(),r=!1;h<a&&(48<=(i=o.charCodeAt(h))&&i<=57);h++);if(46==o.charCodeAt(h)){for(n=++h;n<a&&(48<=(i=o.charCodeAt(n))&&i<=57);n++);n==h&&y(),h=n}if(101==(i=o.charCodeAt(h))||69==i){for(43!=(i=o.charCodeAt(++h))&&45!=i||h++,n=h;n<a&&(48<=(i=o.charCodeAt(n))&&i<=57);n++);n==h&&y(),h=n}return+o.slice(t,h)}if(r&&y(),"true"==o.slice(h,h+4))return h+=4,!0;if("false"==o.slice(h,h+5))return h+=5,!1;if("null"==o.slice(h,h+4))return h+=4,null;y()}return"$"},o=function(e){var t,n;if("$"==e&&y(),"string"==typeof e){if("@"==(s?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=i());n||(n=!0))n&&(","==e?"]"==(e=i())&&y():y()),","==e&&y(),t.push(o(e));return t}if("{"==e){for(t={};"}"!=(e=i());n||(n=!0))n&&(","==e?"}"==(e=i())&&y():y()),","!=e&&"string"==typeof e&&"@"==(s?e.charAt(0):e[0])&&":"==i()||y(),t[e.slice(1)]=o(i());return t}y()}return e},a=function(e,t,n){var r=b(e,t,n);r===T?delete e[t]:e[t]=r},b=function(e,t,n){var r,i=e[t];if("object"==typeof i&&i)if(x.call(i)==O)for(r=i.length;r--;)a(i,r,n);else E(i,function(e){a(i,e,n)});return n.call(e,t,i)};c.parse=function(e,t){var n,r;return h=0,m=""+e,n=o(i()),"$"!=i()&&y(),h=m=null,t&&x.call(t)==d?b(((r={})[""]=n,r),"",t):n}}}}(this)},{}],44:[function(e,t,n){var r=e("util"),o=e("hark"),i=e("getscreenmedia"),a=e("wildemitter"),s=e("mockconsole");function c(){if("undefined"==typeof window)return!1;if(!window.navigator.mozGetUserMedia)return!1;var e=window.navigator.userAgent.match(/Firefox\/(\d+)\./);return(e&&1<=e.length&&parseInt(e[1],10))<50}function u(e){a.call(this);var t,n=this.config={detectSpeakingEvents:!1,audioFallback:!1,media:{audio:!0,video:!0},harkOptions:null,logger:s};for(t in e)e.hasOwnProperty(t)&&(this.config[t]=e[t]);this.logger=n.logger,this._log=this.logger.log.bind(this.logger,"LocalMedia:"),this._logerror=this.logger.error.bind(this.logger,"LocalMedia:"),this.localStreams=[],this.localScreens=[],navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||this._logerror("Your browser does not support local media capture."),this._audioMonitors=[],this.on("localStreamStopped",this._stopAudioMonitor.bind(this)),this.on("localScreenStopped",this._stopAudioMonitor.bind(this))}r.inherits(u,a),u.prototype.start=function(e,t){var r=this,i=e||this.config.media;this.emit("localStreamRequested",i),navigator.mediaDevices?navigator.mediaDevices.getUserMedia(i).then(function(n){if(streamCamera=n,i.audio&&r.config.detectSpeakingEvents&&r._setupAudioMonitor(n,r.config.harkOptions),r.localStreams.push(n),n.getTracks().forEach(function(e){e.addEventListener("ended",function(){var t;t=!0,n.getTracks().forEach(function(e){t="ended"===e.readyState&&t}),t&&r._removeStream(n)})}),r.emit("localStream",n),t)return t(null,n)}).catch(function(e){return console.log("navigator.getUserMedia error: ",e),r.config.audioFallback&&"DevicesNotFoundError"===e.name&&!1!==i.video?(i.video=!1,void r.start(i,t)):(r.emit("localStreamRequestFailed",i),t?t(e,null):void 0)}):console.log("no soporta navigator.mediaDevices")},u.prototype.stop=function(e){this.stopStream(e),this.stopScreenShare(e)},u.prototype.stopStream=function(e){var t=this;e?-1<this.localStreams.indexOf(e)&&(e.getTracks().forEach(function(e){e.stop()}),c()&&this._removeStream(e)):this.localStreams.forEach(function(e){e.getTracks().forEach(function(e){e.stop()}),c()&&t._removeStream(e)})},u.prototype.startScreenShare=function(e,t){var r=this;this.emit("localScreenRequested"),"function"!=typeof e||t||(t=e,e=null),i(e,function(e,n){if(e?r.emit("localScreenRequestFailed"):(r.localScreens.push(n),n.getTracks().forEach(function(e){e.addEventListener("ended",function(){var t=!0;n.getTracks().forEach(function(e){t="ended"===e.readyState&&t}),t&&r._removeStream(n)})}),r.emit("localScreen",n)),t)return t(e,n)})},u.prototype.stopScreenShare=function(e){var t=this;e?-1<this.localScreens.indexOf(e)&&(e.getTracks().forEach(function(e){e.stop()}),c()&&this._removeStream(e)):this.localScreens.forEach(function(e){e.getTracks().forEach(function(e){e.stop()}),c()&&t._removeStream(e)})},u.prototype.mute=function(){this._audioEnabled(!1),this.emit("audioOff")},u.prototype.unmute=function(){this._audioEnabled(!0),this.emit("audioOn")},u.prototype.pauseVideo=function(){this._videoEnabled(!1),this.emit("videoOff")},u.prototype.resumeVideo=function(){this._videoEnabled(!0),this.emit("videoOn")},u.prototype.pause=function(){this.mute(),this.pauseVideo()},u.prototype.resume=function(){this.unmute(),this.resumeVideo()},u.prototype._audioEnabled=function(t){this.localStreams.forEach(function(e){e.getAudioTracks().forEach(function(e){e.enabled=!!t})})},u.prototype._videoEnabled=function(t){this.localStreams.forEach(function(e){e.getVideoTracks().forEach(function(e){e.enabled=!!t})})},u.prototype.isAudioEnabled=function(){var t=!0;return this.localStreams.forEach(function(e){e.getAudioTracks().forEach(function(e){t=t&&e.enabled})}),t},u.prototype.isVideoEnabled=function(){var t=!0;return this.localStreams.forEach(function(e){e.getVideoTracks().forEach(function(e){t=t&&e.enabled})}),t},u.prototype._removeStream=function(e){var t=this.localStreams.indexOf(e);-1<t?(this.localStreams.splice(t,1),this.emit("localStreamStopped",e)):-1<(t=this.localScreens.indexOf(e))&&(this.localScreens.splice(t,1),this.emit("localScreenStopped",e))},u.prototype._setupAudioMonitor=function(e,t){this._log("Setup audio");var n,r=o(e,t),i=this;r.on("speaking",function(){i.emit("speaking")}),r.on("stopped_speaking",function(){n&&clearTimeout(n),n=setTimeout(function(){i.emit("stoppedSpeaking")},1e3)}),r.on("volume_change",function(e,t){i.emit("volumeChange",e,t)}),this._audioMonitors.push({audio:r,stream:e})},u.prototype._stopAudioMonitor=function(n){var r=-1;this._audioMonitors.forEach(function(e,t){e.stream===n&&(r=t)}),-1<r&&(this._audioMonitors[r].audio.stop(),this._audioMonitors.splice(r,1))},t.exports=u},{getscreenmedia:36,hark:38,mockconsole:46,util:73,wildemitter:75}],45:[function(e,$e,Ye){(function(e){var r="__lodash_hash_undefined__",n=9007199254740991,C="[object Arguments]",k="[object Boolean]",E="[object Date]",T="[object Function]",x="[object GeneratorFunction]",P="[object Map]",R="[object Number]",O="[object Object]",i="[object Promise]",D="[object RegExp]",_="[object Set]",j="[object String]",A="[object Symbol]",o="[object WeakMap]",M="[object ArrayBuffer]",I="[object DataView]",L="[object Float32Array]",N="[object Float64Array]",B="[object Int8Array]",U="[object Int16Array]",F="[object Int32Array]",z="[object Uint8Array]",V="[object Uint8ClampedArray]",J="[object Uint16Array]",q="[object Uint32Array]",G=/\w*$/,a=/^\[object .+?Constructor\]$/,s=/^(?:0|[1-9]\d*)$/,H={};H[C]=H["[object Array]"]=H[M]=H[I]=H[k]=H[E]=H[L]=H[N]=H[B]=H[U]=H[F]=H[P]=H[R]=H[O]=H[D]=H[_]=H[j]=H[A]=H[z]=H[V]=H[J]=H[q]=!0,H["[object Error]"]=H[T]=H[o]=!1;var t="object"==typeof e&&e&&e.Object===Object&&e,c="object"==typeof self&&self&&self.Object===Object&&self,u=t||c||Function("return this")(),p="object"==typeof Ye&&Ye&&!Ye.nodeType&&Ye,d=p&&"object"==typeof $e&&$e&&!$e.nodeType&&$e,l=d&&d.exports===p;function W(e,t){return e.set(t[0],t[1]),e}function X(e,t){return e.add(t),e}function $(e,t,n,r){var i=-1,o=e?e.length:0;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Y(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function K(e){var n=-1,r=Array(e.size);return e.forEach(function(e,t){r[++n]=[t,e]}),r}function f(t,n){return function(e){return t(n(e))}}function Q(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var h,m=Array.prototype,g=Function.prototype,v=Object.prototype,y=u["__core-js_shared__"],b=(h=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",w=g.toString,Z=v.hasOwnProperty,S=v.toString,ee=RegExp("^"+w.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),te=l?u.Buffer:void 0,ne=u.Symbol,re=u.Uint8Array,ie=f(Object.getPrototypeOf,Object),oe=Object.create,ae=v.propertyIsEnumerable,se=m.splice,ce=Object.getOwnPropertySymbols,ue=te?te.isBuffer:void 0,pe=f(Object.keys,Object),de=Le(u,"DataView"),le=Le(u,"Map"),fe=Le(u,"Promise"),he=Le(u,"Set"),me=Le(u,"WeakMap"),ge=Le(Object,"create"),ve=ze(de),ye=ze(le),be=ze(fe),we=ze(he),Se=ze(me),Ce=ne?ne.prototype:void 0,ke=Ce?Ce.valueOf:void 0;function Ee(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Te(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function xe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Pe(e){this.__data__=new Te(e)}function Re(e,t){var n,r,i,o=Je(e)||(i=r=n=e)&&"object"==typeof i&&qe(r)&&Z.call(n,"callee")&&(!ae.call(n,"callee")||S.call(n)==C)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],a=o.length,s=!!a;for(var c in e)!t&&!Z.call(e,c)||s&&("length"==c||Ue(c,a))||o.push(c);return o}function Oe(e,t,n){var r=e[t];Z.call(e,t)&&Ve(r,n)&&(void 0!==n||t in e)||(e[t]=n)}function De(e,t){for(var n=e.length;n--;)if(Ve(e[n][0],t))return n;return-1}function _e(n,r,i,o,e,t,a){var s;if(o&&(s=t?o(n,e,t,a):o(n)),void 0!==s)return s;if(!We(n))return n;var c,u,p,d,l,f,h=Je(n);if(h){if(s=function(e){var t=e.length,n=e.constructor(t);t&&"string"==typeof e[0]&&Z.call(e,"index")&&(n.index=e.index,n.input=e.input);return n}(n),!r)return function(e,t){var n=-1,r=e.length;t||(t=Array(r));for(;++n<r;)t[n]=e[n];return t}(n,s)}else{var m=Be(n),g=m==T||m==x;if(Ge(n))return function(e,t){if(t)return e.slice();var n=new e.constructor(e.length);return e.copy(n),n}(n,r);if(m==O||m==C||g&&!t){if(Y(n))return t?n:{};if(s="function"!=typeof(l=g?{}:n).constructor||Fe(l)?{}:We(f=ie(l))?oe(f):{},!r)return d=c=n,u=(p=s)&&Me(d,Xe(d),p),Me(c,Ne(c),u)}else{if(!H[m])return t?n:{};s=function(e,t,n,r){var i=e.constructor;switch(t){case M:return Ae(e);case k:case E:return new i(+e);case I:return h=e,m=r?Ae(h.buffer):h.buffer,new h.constructor(m,h.byteOffset,h.byteLength);case L:case N:case B:case U:case F:case z:case V:case J:case q:return l=e,f=r?Ae(l.buffer):l.buffer,new l.constructor(f,l.byteOffset,l.length);case P:return p=e,d=n,$(r?d(K(p),!0):K(p),W,new p.constructor);case R:case j:return new i(e);case D:return(u=new(c=e).constructor(c.source,G.exec(c))).lastIndex=c.lastIndex,u;case _:return a=e,s=n,$(r?s(Q(a),!0):Q(a),X,new a.constructor);case A:return o=e,ke?Object(ke.call(o)):{}}var o;var a,s;var c,u;var p,d;var l,f;var h,m}(n,m,_e,r)}}a||(a=new Pe);var v,y,b,w=a.get(n);if(w)return w;if(a.set(n,s),!h)var S=i?(y=Ne,b=Xe(v=n),Je(v)?b:function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}(b,y(v))):Xe(n);return function(e,t){for(var n=-1,r=e?e.length:0;++n<r&&!1!==t(e[n],n,e););}(S||n,function(e,t){S&&(e=n[t=e]),Oe(s,t,_e(e,r,i,o,t,n,a))}),s}function je(e){return!(!We(e)||(t=e,b&&b in t))&&(He(e)||Y(e)?ee:a).test(ze(e));var t}function Ae(e){var t=new e.constructor(e.byteLength);return new re(t).set(new re(e)),t}function Me(e,t,n,r){n||(n={});for(var i=-1,o=t.length;++i<o;){var a=t[i],s=r?r(n[a],e[a],a,n,e):void 0;Oe(n,a,void 0===s?e[a]:s)}return n}function Ie(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function Le(e,t){var n,r,i=(r=t,null==(n=e)?void 0:n[r]);return je(i)?i:void 0}Ee.prototype.clear=function(){this.__data__=ge?ge(null):{}},Ee.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ee.prototype.get=function(e){var t=this.__data__;if(ge){var n=t[e];return n===r?void 0:n}return Z.call(t,e)?t[e]:void 0},Ee.prototype.has=function(e){var t=this.__data__;return ge?void 0!==t[e]:Z.call(t,e)},Ee.prototype.set=function(e,t){return this.__data__[e]=ge&&void 0===t?r:t,this},Te.prototype.clear=function(){this.__data__=[]},Te.prototype.delete=function(e){var t=this.__data__,n=De(t,e);return!(n<0||(n==t.length-1?t.pop():se.call(t,n,1),0))},Te.prototype.get=function(e){var t=this.__data__,n=De(t,e);return n<0?void 0:t[n][1]},Te.prototype.has=function(e){return-1<De(this.__data__,e)},Te.prototype.set=function(e,t){var n=this.__data__,r=De(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},xe.prototype.clear=function(){this.__data__={hash:new Ee,map:new(le||Te),string:new Ee}},xe.prototype.delete=function(e){return Ie(this,e).delete(e)},xe.prototype.get=function(e){return Ie(this,e).get(e)},xe.prototype.has=function(e){return Ie(this,e).has(e)},xe.prototype.set=function(e,t){return Ie(this,e).set(e,t),this},Pe.prototype.clear=function(){this.__data__=new Te},Pe.prototype.delete=function(e){return this.__data__.delete(e)},Pe.prototype.get=function(e){return this.__data__.get(e)},Pe.prototype.has=function(e){return this.__data__.has(e)},Pe.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Te){var r=n.__data__;if(!le||r.length<199)return r.push([e,t]),this;n=this.__data__=new xe(r)}return n.set(e,t),this};var Ne=ce?f(ce,Object):function(){return[]},Be=function(e){return S.call(e)};function Ue(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||s.test(e))&&-1<e&&e%1==0&&e<t}function Fe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||v)}function ze(e){if(null!=e){try{return w.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Ve(e,t){return e===t||e!=e&&t!=t}(de&&Be(new de(new ArrayBuffer(1)))!=I||le&&Be(new le)!=P||fe&&Be(fe.resolve())!=i||he&&Be(new he)!=_||me&&Be(new me)!=o)&&(Be=function(e){var t=S.call(e),n=t==O?e.constructor:void 0,r=n?ze(n):void 0;if(r)switch(r){case ve:return I;case ye:return P;case be:return i;case we:return _;case Se:return o}return t});var Je=Array.isArray;function qe(e){return null!=e&&("number"==typeof(t=e.length)&&-1<t&&t%1==0&&t<=n)&&!He(e);var t}var Ge=ue||function(){return!1};function He(e){var t=We(e)?S.call(e):"";return t==T||t==x}function We(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Xe(e){return qe(e)?Re(e):function(e){if(!Fe(e))return pe(e);var t=[];for(var n in Object(e))Z.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}$e.exports=function(e){return _e(e,!0,!0)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(e,t,n){for(var r="assert,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),i=r.length,o=function(){},a={};i--;)a[r[i]]=o;t.exports=a},{}],47:[function(e,t,n){var i=36e5,o=864e5;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}t.exports=function(e,t){return t=t||{},"string"==typeof e?function(e){var t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"y":return 315576e5*n;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"h":return n*i;case"minutes":case"minute":case"m":return 6e4*n;case"seconds":case"second":case"s":return 1e3*n;case"ms":return n}}(e):t.long?a(r=e,o,"day")||a(r,i,"hour")||a(r,6e4,"minute")||a(r,1e3,"second")||r+" ms":o<=(n=e)?Math.round(n/o)+"d":i<=n?Math.round(n/i)+"h":6e4<=n?Math.round(n/6e4)+"m":1e3<=n?Math.round(n/1e3)+"s":n+"ms";var n,r}},{}],48:[function(e,t,n){var r=Object.prototype.hasOwnProperty;n.keys=Object.keys||function(e){var t=[];for(var n in e)r.call(e,n)&&t.push(n);return t},n.values=function(e){var t=[];for(var n in e)r.call(e,n)&&t.push(e[n]);return t},n.merge=function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);return e},n.length=function(e){return n.keys(e).length},n.isEmpty=function(e){return 0==n.length(e)}},{}],49:[function(e,c,t){(function(t){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,s=/\s+$/;c.exports=function(e){return"string"==typeof e&&e?(e=e.replace(a,"").replace(s,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(r,"@").replace(i,"]").replace(o,""))?new Function("return "+e)():void 0):null}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],50:[function(e,t,n){n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},{}],51:[function(e,t,n){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){for(var t=i.exec(e||""),n={},r=14;r--;)n[o[r]]=t[r]||"";return n}},{}],52:[function(e,t,n){var r,i,o=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var u,p=[],d=!1,l=-1;function f(){d&&u&&(d=!1,u.length?p=u.concat(p):l=-1,p.length&&h())}function h(){if(!d){var e=c(f);d=!0;for(var t=p.length;t;){for(u=p,p=[];++l<t;)u&&u[l].run();l=-1,t=p.length}u=null,d=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new m(e,t)),1!==p.length||d||c(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],53:[function(e,t,n){var r=e("util"),d=e("sdp-jingle-json"),i=e("wildemitter"),p=e("lodash.clonedeep");function o(e,t){if(navigator.mediaDevices){var n,r=this;for(n in i.call(this),(e=e||{}).iceServers=e.iceServers||[],this.enableChromeNativeSimulcast=!1,t&&t.optional&&window.chrome&&null===navigator.appVersion.match(/Chromium\//)&&t.optional.forEach(function(e){e.enableChromeNativeSimulcast&&(r.enableChromeNativeSimulcast=!0)}),this.enableMultiStreamHacks=!1,t&&t.optional&&window.chrome&&t.optional.forEach(function(e){e.enableMultiStreamHacks&&(r.enableMultiStreamHacks=!0)}),this.restrictBandwidth=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetRestrictBandwidth&&(r.restrictBandwidth=e.andyetRestrictBandwidth)}),this.batchIceCandidates=0,t&&t.optional&&t.optional.forEach(function(e){e.andyetBatchIce&&(r.batchIceCandidates=e.andyetBatchIce)}),this.batchedIceCandidates=[],t&&t.optional&&window.chrome&&t.optional.forEach(function(e){e.andyetFasterICE&&(r.eliminateDuplicateCandidates=e.andyetFasterICE)}),t&&t.optional&&t.optional.forEach(function(e){e.andyetDontSignalCandidates&&(r.dontSignalCandidates=e.andyetDontSignalCandidates)}),this.assumeSetLocalSuccess=!1,t&&t.optional&&t.optional.forEach(function(e){e.andyetAssumeSetLocalSuccess&&(r.assumeSetLocalSuccess=e.andyetAssumeSetLocalSuccess)}),window.navigator.mozGetUserMedia&&t&&t.optional&&(this.wtFirefox=0,t.optional.forEach(function(e){e.andyetFirefoxMakesMeSad&&(r.wtFirefox=e.andyetFirefoxMakesMeSad,0<r.wtFirefox&&(r.firefoxcandidatebuffer=[]))})),this.pc=new RTCPeerConnection(e,t),"function"==typeof this.pc.getLocalStreams?this.getLocalStreams=this.pc.getLocalStreams.bind(this.pc):this.getLocalStreams=function(){return[]},this.getRemoteStreams=this.pc.getRemoteStreams.bind(this.pc),this.addStream=this.pc.addStream.bind(this.pc),this.removeStream=function(e){"function"==typeof r.pc.removeStream?r.pc.removeStream.apply(r.pc,arguments):"function"==typeof r.pc.removeTrack&&e.getTracks().forEach(function(e){r.pc.removeTrack(e)})},"function"==typeof this.pc.removeTrack&&(this.removeTrack=this.pc.removeTrack.bind(this.pc)),this.pc.onremovestream=this.emit.bind(this,"removeStream"),this.pc.onremovetrack=this.emit.bind(this,"removeTrack"),this.pc.onaddstream=this.emit.bind(this,"addStream"),this.pc.onnegotiationneeded=this.emit.bind(this,"negotiationNeeded"),this.pc.oniceconnectionstatechange=this.emit.bind(this,"iceConnectionStateChange"),this.pc.onsignalingstatechange=this.emit.bind(this,"signalingStateChange"),this.pc.onicecandidate=this._onIce.bind(this),this.pc.ondatachannel=this._onDataChannel.bind(this),this.localDescription={contents:[]},this.remoteDescription={contents:[]},this.config={debug:!1,sid:"",isInitiator:!0,sdpSessionID:Date.now(),useJingle:!1},this.iceCredentials={local:{},remote:{}},e)this.config[n]=e[n];this.config.debug&&this.on("*",function(){(e.logger||console).log("PeerConnection event:",arguments)}),this.hadLocalStunCandidate=!1,this.hadRemoteStunCandidate=!1,this.hadLocalRelayCandidate=!1,this.hadRemoteRelayCandidate=!1,this.hadLocalIPv6Candidate=!1,this.hadRemoteIPv6Candidate=!1,this._remoteDataChannels=[],this._localDataChannels=[],this._candidateBuffer=[]}else console.log("no soporta navigator.mediaDevices")}r.inherits(o,i),Object.defineProperty(o.prototype,"signalingState",{get:function(){return this.pc.signalingState}}),Object.defineProperty(o.prototype,"iceConnectionState",{get:function(){return this.pc.iceConnectionState}}),o.prototype._role=function(){return this.isInitiator?"initiator":"responder"},o.prototype.addStream=function(e){this.localStream=e,this.pc.addStream(e)},o.prototype._checkLocalCandidate=function(e){var t=d.toCandidateJSON(e);"srflx"==t.type?this.hadLocalStunCandidate=!0:"relay"==t.type&&(this.hadLocalRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadLocalIPv6Candidate=!0)},o.prototype._checkRemoteCandidate=function(e){var t=d.toCandidateJSON(e);"srflx"==t.type?this.hadRemoteStunCandidate=!0:"relay"==t.type&&(this.hadRemoteRelayCandidate=!0),-1!=t.ip.indexOf(":")&&(this.hadRemoteIPv6Candidate=!0)},o.prototype.processIce=function(e,c){if(navigator.mediaDevices){c=c||function(){};var u=this;if("closed"===this.pc.signalingState)return c();if(e.contents||e.jingle&&e.jingle.contents){var p=this.remoteDescription.contents.map(function(e){return e.name});(e.contents||e.jingle.contents).forEach(function(t){var e=t.transport||{},n=e.candidates||[],r=p.indexOf(t.name),i=t.name,o=u.remoteDescription.contents.find(function(e){return e.name===t.name}),a=function(){n.forEach(function(e){var t=d.toCandidateSDP(e);u.pc.addIceCandidate(new RTCIceCandidate({candidate:t,sdpMLineIndex:r,sdpMid:i}),function(){},function(e){u.emit("error",e)}),u._checkRemoteCandidate(t)}),c()};if(u.iceCredentials.remote[t.name]&&e.ufrag&&u.iceCredentials.remote[t.name].ufrag!==e.ufrag)if(o){o.transport.ufrag=e.ufrag,o.transport.pwd=e.pwd;var s={type:"offer",jingle:u.remoteDescription};s.sdp=d.toSessionSDP(s.jingle,{sid:u.config.sdpSessionID,role:u._role(),direction:"incoming"}),u.pc.setRemoteDescription(new RTCSessionDescription(s),function(){a()},function(e){u.emit("error",e)})}else u.emit("error","ice restart failed to find matching content");else a()})}else{if(e.candidate&&0!==e.candidate.candidate.indexOf("a=")&&(e.candidate.candidate="a="+e.candidate.candidate),this.wtFirefox&&null!==this.firefoxcandidatebuffer&&this.pc.localDescription&&"offer"===this.pc.localDescription.type)return this.firefoxcandidatebuffer.push(e.candidate),c();u.pc.addIceCandidate(new RTCIceCandidate(e.candidate),function(){},function(e){u.emit("error",e)}),u._checkRemoteCandidate(e.candidate.candidate),c()}}else console.log("no soporta navigator.mediaDevices")},o.prototype.offer=function(e,r){if(navigator.mediaDevices){var i=this,t=2===arguments.length,n=t&&e?e:{offerToReceiveAudio:1,offerToReceiveVideo:1};if(r=(r=t?r:e)||function(){},"closed"===this.pc.signalingState)return r("Already closed");this.pc.createOffer(function(t){var n={type:"offer",sdp:t.sdp};i.assumeSetLocalSuccess&&(i.emit("offer",n),r(null,n)),i._candidateBuffer=[],i.pc.setLocalDescription(t,function(){var e;i.config.useJingle&&((e=d.toSessionJSON(t.sdp,{role:i._role(),direction:"outgoing"})).sid=i.config.sid,(i.localDescription=e).contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(i.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),n.jingle=e),n.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&i._checkLocalCandidate(e)}),i.assumeSetLocalSuccess||(i.emit("offer",n),r(null,n))},function(e){i.emit("error",e),r(e)})},function(e){i.emit("error",e),r(e)},n)}else console.log("no soporta navigator.mediaDevices")},o.prototype.handleOffer=function(e,t){if(navigator.mediaDevices){t=t||function(){};var n=this;if(e.type="offer",e.jingle){if(this.enableChromeNativeSimulcast&&e.jingle.contents.forEach(function(e){"video"===e.name&&(e.application.googConferenceFlag=!0)}),this.enableMultiStreamHacks&&e.jingle.contents.forEach(function(e){if("video"===e.name){var t=e.application.sources||[];0!==t.length&&"3735928559"===t[0].ssrc||(t.unshift({ssrc:"3735928559",parameters:[{key:"cname",value:"deadbeef"},{key:"msid",value:"mixyourfecintothis please"}]}),e.application.sources=t)}}),0<n.restrictBandwidth&&2<=e.jingle.contents.length&&"video"===e.jingle.contents[1].name){var r=e.jingle.contents[1];r.application&&r.application.bandwidth&&r.application.bandwidth.bandwidth||(e.jingle.contents[1].application.bandwidth={type:"AS",bandwidth:n.restrictBandwidth.toString()},e.sdp=d.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"outgoing"}))}e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})}),e.sdp=d.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle}e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){t()},t)}else console.log("no soporta navigator.mediaDevices")},o.prototype.answerAudioOnly=function(e){this._answer({mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!1}},e)},o.prototype.answerBroadcastOnly=function(e){this._answer({mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}},e)},o.prototype.answer=function(e,t){var n=2===arguments.length,r=n?t:e,i=n&&e?e:{mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};this._answer(i,r)},o.prototype.handleAnswer=function(e,t){t=t||function(){};var n=this;e.jingle&&(e.sdp=d.toSessionSDP(e.jingle,{sid:n.config.sdpSessionID,role:n._role(),direction:"incoming"}),n.remoteDescription=e.jingle,e.jingle.contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(n.iceCredentials.remote[e.name]={ufrag:t.ufrag,pwd:t.pwd})})),e.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&n._checkRemoteCandidate(e)}),n.pc.setRemoteDescription(new RTCSessionDescription(e),function(){n.wtFirefox&&window.setTimeout(function(){n.firefoxcandidatebuffer.forEach(function(e){n.pc.addIceCandidate(new RTCIceCandidate(e),function(){},function(e){n.emit("error",e)}),n._checkRemoteCandidate(e.candidate)}),n.firefoxcandidatebuffer=null},n.wtFirefox),t(null)},t)},o.prototype.close=function(){navigator.mediaDevices?(this.pc.close(),this._localDataChannels=[],this._remoteDataChannels=[],this.emit("close")):console.log("no soporta navigator.mediaDevices")},o.prototype._answer=function(e,c){c=c||function(){};var u=this;if(!this.pc.remoteDescription)throw new Error("remoteDescription not set");if("closed"===this.pc.signalingState)return c("Already closed");u.pc.createAnswer(function(n){var e=[];if(u.enableChromeNativeSimulcast&&(n.jingle=d.toSessionJSON(n.sdp,{role:u._role(),direction:"outgoing"}),2<=n.jingle.contents.length&&"video"===n.jingle.contents[1].name)){var t=n.jingle.contents[1].application.sourceGroups||[],r=!1;if(t.forEach(function(e){"SIM"==e.semantics&&(r=!0)}),!r&&n.jingle.contents[1].application.sources.length){var i=JSON.parse(JSON.stringify(n.jingle.contents[1].application.sources[0]));i.ssrc=""+Math.floor(4294967295*Math.random()),n.jingle.contents[1].application.sources.push(i),e.push(n.jingle.contents[1].application.sources[0].ssrc),e.push(i.ssrc),t.push({semantics:"SIM",sources:e});var o=JSON.parse(JSON.stringify(i));o.ssrc=""+Math.floor(4294967295*Math.random()),n.jingle.contents[1].application.sources.push(o),t.push({semantics:"FID",sources:[i.ssrc,o.ssrc]}),n.jingle.contents[1].application.sourceGroups=t,n.sdp=d.toSessionSDP(n.jingle,{sid:u.config.sdpSessionID,role:u._role(),direction:"outgoing"})}}var a={type:"answer",sdp:n.sdp};if(u.assumeSetLocalSuccess){var s=p(a);u.emit("answer",s),c(null,s)}u._candidateBuffer=[],u.pc.setLocalDescription(n,function(){if(u.config.useJingle){var e=d.toSessionJSON(n.sdp,{role:u._role(),direction:"outgoing"});e.sid=u.config.sid,u.localDescription=e,a.jingle=e}if(u.enableChromeNativeSimulcast&&(a.jingle||(a.jingle=d.toSessionJSON(n.sdp,{role:u._role(),direction:"outgoing"})),a.jingle.contents[1].application.sources.forEach(function(e,t){e.parameters=e.parameters.map(function(e){return"msid"===e.key&&(e.value+="-"+Math.floor(t/2)),e})}),a.sdp=d.toSessionSDP(a.jingle,{sid:u.sdpSessionID,role:u._role(),direction:"outgoing"})),a.sdp.split("\r\n").forEach(function(e){0===e.indexOf("a=candidate:")&&u._checkLocalCandidate(e)}),!u.assumeSetLocalSuccess){var t=p(a);u.emit("answer",t),c(null,t)}},function(e){u.emit("error",e),c(e)})},function(e){u.emit("error",e),c(e)},e)},o.prototype._onIce=function(e){var r=this;if(e.candidate){if(this.dontSignalCandidates)return;var t=e.candidate,n={candidate:{candidate:t.candidate,sdpMid:t.sdpMid,sdpMLineIndex:t.sdpMLineIndex}};this._checkLocalCandidate(t.candidate);var i,o,a=d.toCandidateJSON(t.candidate);if(this.eliminateDuplicateCandidates&&"relay"===a.type&&-1<(o=(i=this._candidateBuffer.filter(function(e){return"relay"===e.type}).map(function(e){return e.foundation+":"+e.component})).indexOf(a.foundation+":"+a.component))&&a.priority>>24>=i[o].priority>>24)return;if("max-bundle"===this.config.bundlePolicy&&-1<(o=(i=this._candidateBuffer.filter(function(e){return a.type===e.type}).map(function(e){return e.address+":"+e.port})).indexOf(a.address+":"+a.port)))return;if("require"===this.config.rtcpMuxPolicy&&"2"===a.component)return;if(this._candidateBuffer.push(a),r.config.useJingle){if(t.sdpMid||(r.pc.remoteDescription&&"offer"===r.pc.remoteDescription.type?t.sdpMid=r.remoteDescription.contents[t.sdpMLineIndex].name:t.sdpMid=r.localDescription.contents[t.sdpMLineIndex].name),!r.iceCredentials.local[t.sdpMid])d.toSessionJSON(r.pc.localDescription.sdp,{role:r._role(),direction:"outgoing"}).contents.forEach(function(e){var t=e.transport||{};t.ufrag&&(r.iceCredentials.local[e.name]={ufrag:t.ufrag,pwd:t.pwd})});if(n.jingle={contents:[{name:t.sdpMid,creator:r._role(),transport:{transportType:"iceUdp",ufrag:r.iceCredentials.local[t.sdpMid].ufrag,pwd:r.iceCredentials.local[t.sdpMid].pwd,candidates:[a]}}]},0<r.batchIceCandidates)return 0===r.batchedIceCandidates.length&&window.setTimeout(function(){var t={};r.batchedIceCandidates.forEach(function(e){e=e.contents[0],t[e.name]||(t[e.name]=e),t[e.name].transport.candidates.push(e.transport.candidates[0])});var n={jingle:{contents:[]}};Object.keys(t).forEach(function(e){n.jingle.contents.push(t[e])}),r.batchedIceCandidates=[],r.emit("ice",n)},r.batchIceCandidates),void r.batchedIceCandidates.push(n.jingle)}this.emit("ice",n)}else this.emit("endOfCandidates")},o.prototype._onDataChannel=function(e){var t=e.channel;this._remoteDataChannels.push(t),this.emit("addChannel",t)},o.prototype.createDataChannel=function(e,t){var n=this.pc.createDataChannel(e,t);return this._localDataChannels.push(n),n},o.prototype.getStats=function(){if("function"!=typeof arguments[0])return this.pc.getStats.apply(this.pc,arguments);var t=arguments[0];this.pc.getStats().then(function(e){t(null,e)},function(e){t(e)})},t.exports=o},{"lodash.clonedeep":45,"sdp-jingle-json":54,util:73,wildemitter:75}],54:[function(e,t,n){var r=e("./lib/tosdp"),i=e("./lib/tojson");n.toIncomingSDPOffer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingSDPOffer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingSDPAnswer=function(e){return r.toSessionSDP(e,{role:"responder",direction:"outgoing"})},n.toIncomingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"incoming"})},n.toOutgoingMediaSDPOffer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"outgoing"})},n.toIncomingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"initiator",direction:"incoming"})},n.toOutgoingMediaSDPAnswer=function(e){return r.toMediaSDP(e,{role:"responder",direction:"outgoing"})},n.toCandidateSDP=r.toCandidateSDP,n.toMediaSDP=r.toMediaSDP,n.toSessionSDP=r.toSessionSDP,n.toIncomingJSONOffer=function(e,t){return i.toSessionJSON(e,{role:"responder",direction:"incoming",creators:t})},n.toOutgoingJSONOffer=function(e,t){return i.toSessionJSON(e,{role:"initiator",direction:"outgoing",creators:t})},n.toIncomingJSONAnswer=function(e,t){return i.toSessionJSON(e,{role:"initiator",direction:"incoming",creators:t})},n.toOutgoingJSONAnswer=function(e,t){return i.toSessionJSON(e,{role:"responder",direction:"outgoing",creators:t})},n.toIncomingMediaJSONOffer=function(e,t){return i.toMediaJSON(e,{role:"responder",direction:"incoming",creator:t})},n.toOutgoingMediaJSONOffer=function(e,t){return i.toMediaJSON(e,{role:"initiator",direction:"outgoing",creator:t})},n.toIncomingMediaJSONAnswer=function(e,t){return i.toMediaJSON(e,{role:"initiator",direction:"incoming",creator:t})},n.toOutgoingMediaJSONAnswer=function(e,t){return i.toMediaJSON(e,{role:"responder",direction:"outgoing",creator:t})},n.toCandidateJSON=i.toCandidateJSON,n.toMediaJSON=i.toMediaJSON,n.toSessionJSON=i.toSessionJSON},{"./lib/tojson":57,"./lib/tosdp":58}],55:[function(e,t,n){n.lines=function(e){return e.split("\r\n").filter(function(e){return 0<e.length})},n.findLine=function(e,t,n){for(var r=e.length,i=0;i<t.length;i++)if(t[i].substr(0,r)===e)return t[i];if(!n)return!1;for(var o=0;o<n.length;o++)if(n[o].substr(0,r)===e)return n[o];return!1},n.findLines=function(e,t,n){for(var r=[],i=e.length,o=0;o<t.length;o++)t[o].substr(0,i)===e&&r.push(t[o]);if(r.length||!n)return r;for(var a=0;a<n.length;a++)n[a].substr(0,i)===e&&r.push(n[a]);return r},n.mline=function(e){for(var t=e.substr(2).split(" "),n={media:t[0],port:t[1],proto:t[2],formats:[]},r=3;r<t.length;r++)t[r]&&n.formats.push(t[r]);return n},n.rtpmap=function(e){var t=e.substr(9).split(" "),n={id:t.shift()};return t=t[0].split("/"),n.name=t[0],n.clockrate=t[1],n.channels=3==t.length?t[2]:"1",n},n.sctpmap=function(e){var t=e.substr(10).split(" ");return{number:t.shift(),protocol:t.shift(),streams:t.shift()}},n.fmtp=function(e){for(var t,n,r,i=e.substr(e.indexOf(" ")+1).split(";"),o=[],a=0;a<i.length;a++)n=(t=i[a].split("="))[0].trim(),r=t[1],n&&r?o.push({key:n,value:r}):n&&o.push({key:"",value:n});return o},n.crypto=function(e){var t=e.substr(9).split(" ");return{tag:t[0],cipherSuite:t[1],keyParams:t[2],sessionParams:t.slice(3).join(" ")}},n.fingerprint=function(e){var t=e.substr(14).split(" ");return{hash:t[0],value:t[1]}},n.extmap=function(e){var t=e.substr(9).split(" "),n={},r=t.shift(),i=r.indexOf("/");return 0<=i?(n.id=r.substr(0,i),n.senders=r.substr(i+1)):(n.id=r,n.senders="sendrecv"),n.uri=t.shift()||"",n},n.rtcpfb=function(e){var t=e.substr(10).split(" "),n={};return n.id=t.shift(),n.type=t.shift(),"trr-int"===n.type?n.value=t.shift():n.subtype=t.shift()||"",n.parameters=t,n},n.candidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:t[1],protocol:t[2].toLowerCase(),priority:t[3],ip:t[4],port:t[5],type:t[7],generation:"0"},r=8;r<t.length;r+=2)"raddr"===t[r]?n.relAddr=t[r+1]:"rport"===t[r]?n.relPort=t[r+1]:"generation"===t[r]?n.generation=t[r+1]:"tcptype"===t[r]&&(n.tcpType=t[r+1]);return n.network="1",n},n.sourceGroups=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n].substr(13).split(" ");t.push({semantics:r.shift(),sources:r})}return t},n.sources=function(e){for(var t=[],n={},r=0;r<e.length;r++){var i=e[r].substr(7).split(" "),o=i.shift();if(!n[o]){var a={ssrc:o,parameters:[]};t.push(a),n[o]=a}var s=(i=i.join(" ").split(":")).shift(),c=i.join(":")||null;n[o].parameters.push({key:s,value:c})}return t},n.groups=function(e){for(var t,n=[],r=0;r<e.length;r++)t=e[r].substr(8).split(" "),n.push({semantics:t.shift(),contents:t});return n},n.bandwidth=function(e){var t=e.substr(2).split(":"),n={};return n.type=t.shift(),n.bandwidth=t.shift(),n},n.msid=function(e){var t=e.substr(7),n=t.split(" ");return{msid:t,mslabel:n[0],label:n[1]}}},{}],56:[function(e,t,n){t.exports={initiator:{incoming:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"},outgoing:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"}},responder:{incoming:{initiator:"sendonly",responder:"recvonly",both:"sendrecv",none:"inactive",recvonly:"responder",sendonly:"initiator",sendrecv:"both",inactive:"none"},outgoing:{initiator:"recvonly",responder:"sendonly",both:"sendrecv",none:"inactive",recvonly:"initiator",sendonly:"responder",sendrecv:"both",inactive:"none"}}}},{}],57:[function(e,t,E){var T=e("./senders"),x=e("./parsers"),n=Math.random();E._setIdCounter=function(e){n=e},E.toSessionJSON=function(e,t){var n,r=t.creators||[],i=t.role||"initiator",o=t.direction||"outgoing",a=e.split("\r\nm=");for(n=1;n<a.length;n++)a[n]="m="+a[n],n!==a.length-1&&(a[n]+="\r\n");var s=a.shift()+"\r\n",c=x.lines(s),u={},p=[];for(n=0;n<a.length;n++)p.push(E.toMediaJSON(a[n],s,{role:i,direction:o,creator:r[n]||"initiator"}));u.contents=p;var d=x.findLines("a=group:",c);return d.length&&(u.groups=x.groups(d)),u},E.toMediaJSON=function(e,t,n){var r=n.creator||"initiator",i=n.role||"initiator",o=n.direction||"outgoing",a=x.lines(e),s=x.lines(t),c=x.mline(a[0]),u={creator:r,name:c.media,application:{applicationType:"rtp",media:c.media,payloads:[],encryption:[],feedback:[],headerExtensions:[]},transport:{transportType:"iceUdp",candidates:[],fingerprints:[]}};"application"==c.media&&(u.application={applicationType:"datachannel"},u.transport.sctp=[]);var p=u.application,d=u.transport,l=x.findLine("a=mid:",a);if(l&&(u.name=l.substr(6)),x.findLine("a=sendrecv",a,s)?u.senders="both":x.findLine("a=sendonly",a,s)?u.senders=T[i][o].sendonly:x.findLine("a=recvonly",a,s)?u.senders=T[i][o].recvonly:x.findLine("a=inactive",a,s)&&(u.senders="none"),"rtp"==p.applicationType){var f=x.findLine("b=",a);f&&(p.bandwidth=x.bandwidth(f));var h=x.findLine("a=ssrc:",a);h&&(p.ssrc=h.substr(7).split(" ")[0]),x.findLines("a=rtpmap:",a).forEach(function(e){var t=x.rtpmap(e);t.parameters=[],t.feedback=[],x.findLines("a=fmtp:"+t.id,a).forEach(function(e){t.parameters=x.fmtp(e)}),x.findLines("a=rtcp-fb:"+t.id,a).forEach(function(e){t.feedback.push(x.rtcpfb(e))}),p.payloads.push(t)}),x.findLines("a=crypto:",a,s).forEach(function(e){p.encryption.push(x.crypto(e))}),x.findLine("a=rtcp-mux",a)&&(p.mux=!0),x.findLines("a=rtcp-fb:*",a).forEach(function(e){p.feedback.push(x.rtcpfb(e))}),x.findLines("a=extmap:",a).forEach(function(e){var t=x.extmap(e);t.senders=T[i][o][t.senders],p.headerExtensions.push(t)});var m=x.findLines("a=ssrc-group:",a);p.sourceGroups=x.sourceGroups(m||[]);var g=x.findLines("a=ssrc:",a),v=p.sources=x.sources(g||[]),y=x.findLine("a=msid:",a);if(y){var b=x.msid(y);["msid","mslabel","label"].forEach(function(e){for(var t=0;t<v.length;t++){for(var n=!1,r=0;r<v[t].parameters.length;r++)v[t].parameters[r].key===e&&(n=!0);n||v[t].parameters.push({key:e,value:b[e]})}})}x.findLine("a=x-google-flag:conference",a,s)&&(p.googConferenceFlag=!0)}var w=x.findLines("a=fingerprint:",a,s),S=x.findLine("a=setup:",a,s);w.forEach(function(e){var t=x.fingerprint(e);S&&(t.setup=S.substr(8)),d.fingerprints.push(t)});var C=x.findLine("a=ice-ufrag:",a,s),k=x.findLine("a=ice-pwd:",a,s);C&&k&&(d.ufrag=C.substr(12),d.pwd=k.substr(10),d.candidates=[],x.findLines("a=candidate:",a,s).forEach(function(e){d.candidates.push(E.toCandidateJSON(e))}));"datachannel"==p.applicationType&&x.findLines("a=sctpmap:",a).forEach(function(e){var t=x.sctpmap(e);d.sctp.push(t)});return u},E.toCandidateJSON=function(e){var t=x.candidate(e.split("\r\n")[0]);return t.id=(n++).toString(36).substr(0,12),t}},{"./parsers":55,"./senders":56}],58:[function(e,t,p){var d=e("./senders");p.toSessionSDP=function(e,t){t.role,t.direction;var n=["v=0","o=- "+(t.sid||e.sid||Date.now())+" "+(t.time||Date.now())+" IN IP4 0.0.0.0","s=-","t=0 0"],r=e.contents||[],i=!1;return r.forEach(function(e){e.application.sources&&e.application.sources.length&&(i=!0)}),i&&n.push("a=msid-semantic: WMS *"),(e.groups||[]).forEach(function(e){n.push("a=group:"+e.semantics+" "+e.contents.join(" "))}),r.forEach(function(e){n.push(p.toMediaSDP(e,t))}),n.join("\r\n")+"\r\n"},p.toMediaSDP=function(e,t){var i=[],n=t.role||"initiator",r=t.direction||"outgoing",o=e.application,a=e.transport,s=o.payloads||[],c=a&&a.fingerprints||[],u=[];if("datachannel"==o.applicationType?(u.push("application"),u.push("1"),u.push("DTLS/SCTP"),a.sctp&&a.sctp.forEach(function(e){u.push(e.number)})):(u.push(o.media),u.push("1"),0<c.length?u.push("UDP/TLS/RTP/SAVPF"):o.encryption&&0<o.encryption.length?u.push("RTP/SAVPF"):u.push("RTP/AVPF"),s.forEach(function(e){u.push(e.id)})),i.push("m="+u.join(" ")),i.push("c=IN IP4 0.0.0.0"),o.bandwidth&&o.bandwidth.type&&o.bandwidth.bandwidth&&i.push("b="+o.bandwidth.type+":"+o.bandwidth.bandwidth),"rtp"==o.applicationType&&i.push("a=rtcp:1 IN IP4 0.0.0.0"),a){a.ufrag&&i.push("a=ice-ufrag:"+a.ufrag),a.pwd&&i.push("a=ice-pwd:"+a.pwd);c.forEach(function(e){i.push("a=fingerprint:"+e.hash+" "+e.value),e.setup&&i.push("a=setup:"+e.setup)}),a.sctp&&a.sctp.forEach(function(e){i.push("a=sctpmap:"+e.number+" "+e.protocol+" "+e.streams)})}return"rtp"==o.applicationType&&i.push("a="+(d[n][r][e.senders]||"sendrecv")),i.push("a=mid:"+e.name),o.sources&&o.sources.length&&(o.sources[0].parameters||[]).forEach(function(e){"msid"===e.key&&i.push("a=msid:"+e.value)}),o.mux&&i.push("a=rtcp-mux"),(o.encryption||[]).forEach(function(e){i.push("a=crypto:"+e.tag+" "+e.cipherSuite+" "+e.keyParams+(e.sessionParams?" "+e.sessionParams:""))}),o.googConferenceFlag&&i.push("a=x-google-flag:conference"),s.forEach(function(t){var e="a=rtpmap:"+t.id+" "+t.name+"/"+t.clockrate;if(t.channels&&"1"!=t.channels&&(e+="/"+t.channels),i.push(e),t.parameters&&t.parameters.length){var n=["a=fmtp:"+t.id],r=[];t.parameters.forEach(function(e){r.push((e.key?e.key+"=":"")+e.value)}),n.push(r.join(";")),i.push(n.join(" "))}t.feedback&&t.feedback.forEach(function(e){"trr-int"===e.type?i.push("a=rtcp-fb:"+t.id+" trr-int "+(e.value?e.value:"0")):i.push("a=rtcp-fb:"+t.id+" "+e.type+(e.subtype?" "+e.subtype:""))})}),o.feedback&&o.feedback.forEach(function(e){"trr-int"===e.type?i.push("a=rtcp-fb:* trr-int "+(e.value?e.value:"0")):i.push("a=rtcp-fb:* "+e.type+(e.subtype?" "+e.subtype:""))}),(o.headerExtensions||[]).forEach(function(e){i.push("a=extmap:"+e.id+(e.senders?"/"+d[n][r][e.senders]:"")+" "+e.uri)}),(o.sourceGroups||[]).forEach(function(e){i.push("a=ssrc-group:"+e.semantics+" "+e.sources.join(" "))}),(o.sources||[]).forEach(function(e){for(var t=0;t<e.parameters.length;t++){var n=e.parameters[t];i.push("a=ssrc:"+(e.ssrc||o.ssrc)+" "+n.key+(n.value?":"+n.value:""))}}),(a.candidates||[]).forEach(function(e){i.push(p.toCandidateSDP(e))}),i.join("\r\n")},p.toCandidateSDP=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"srflx"!==n&&"prflx"!==n&&"relay"!==n||e.relAddr&&e.relPort&&(t.push("raddr"),t.push(e.relAddr),t.push("rport"),t.push(e.relPort)),e.tcpType&&"TCP"==e.protocol.toUpperCase()&&(t.push("tcptype"),t.push(e.tcpType)),t.push("generation"),t.push(e.generation||"0"),"a=candidate:"+t.join(" ")}},{"./senders":56}],59:[function(e,t,n){"use strict";var p={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};p.localCName=p.generateIdentifier(),p.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},p.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},p.matchPrefix=function(e,t){return p.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},p.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;default:n[t[r]]=t[r+1]}return n},p.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),"candidate:"+t.join(" ")},p.parseIceOptions=function(e){return e.substr(14).split(" ")},p.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.numChannels=3===t.length?parseInt(t[2],10):1,n},p.writeRtpMap=function(e){var t=e.payloadType;return void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType),"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==e.numChannels?"/"+e.numChannels:"")+"\r\n"},p.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:0<t[0].indexOf("/")?t[0].split("/")[1]:"sendrecv",uri:t[1]}},p.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},p.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},p.writeFmtp=function(t){var e="",n=t.payloadType;if(void 0!==t.preferredPayloadType&&(n=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){var r=[];Object.keys(t.parameters).forEach(function(e){r.push(e+"="+t.parameters[e])}),e+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return e},p.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},p.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},p.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return-1<r?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},p.getMid=function(e){var t=p.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},p.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},p.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:p.matchPrefix(e+t,"a=fingerprint:").map(p.parseFingerprint)}},p.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},p.getIceParameters=function(e,t){var n=p.splitLines(e);return{usernameFragment:(n=n.concat(p.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:n.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},p.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},p.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=p.splitLines(e)[0].split(" "),r=3;r<n.length;r++){var i=n[r],o=p.matchPrefix(e,"a=rtpmap:"+i+" ")[0];if(o){var a=p.parseRtpMap(o),s=p.matchPrefix(e,"a=fmtp:"+i+" ");switch(a.parameters=s.length?p.parseFmtp(s[0]):{},a.rtcpFeedback=p.matchPrefix(e,"a=rtcp-fb:"+i+" ").map(p.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}return p.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(p.parseExtmap(e))}),t},p.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=0<t.codecs.length?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach(function(e){n+=p.writeRtpMap(e),n+=p.writeFmtp(e),n+=p.writeRtcpFb(e)});var r=0;return t.codecs.forEach(function(e){e.maxptime>r&&(r=e.maxptime)}),0<r&&(n+="a=maxptime:"+r+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions.forEach(function(e){n+=p.writeExtmap(e)}),n},p.parseRtpEncodingParameters=function(e){var n,r=[],t=p.parseRtpParameters(e),i=-1!==t.fecMechanisms.indexOf("RED"),o=-1!==t.fecMechanisms.indexOf("ULPFEC"),a=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute}),s=0<a.length&&a[0].ssrc,c=p.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.split(" ");return t.shift(),t.map(function(e){return parseInt(e,10)})});0<c.length&&1<c[0].length&&c[0][0]===s&&(n=c[0][1]),t.codecs.forEach(function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10),rtx:{ssrc:n}};r.push(t),i&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:n,mechanism:o?"red+ulpfec":"red"},r.push(t))}}),0===r.length&&s&&r.push({ssrc:s});var u=p.matchPrefix(e,"b=");return u.length&&(0===u[0].indexOf("b=TIAS:")?u=parseInt(u[0].substr(7),10):0===u[0].indexOf("b=AS:")&&(u=parseInt(u[0].substr(5),10)),r.forEach(function(e){e.maxBitrate=u})),r},p.parseRtcpParameters=function(e){var t={},n=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var r=p.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=0<r.length,t.compound=0===r.length;var i=p.matchPrefix(e,"a=rtcp-mux");return t.mux=0<i.length,t},p.parseMsid=function(e){var t,n=p.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var r=p.matchPrefix(e,"a=ssrc:").map(function(e){return p.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute});return 0<r.length?{stream:(t=r[0].value.split(" "))[0],track:t[1]}:void 0},p.writeSessionBoilerplate=function(){return"v=0\r\no=thisisadapterortc 8169639915646943137 2 IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},p.writeMediaSection=function(e,t,n,r){var i=p.writeRtpDescription(e.kind,t);if(i+=p.writeIceParameters(e.iceGatherer.getLocalParameters()),i+=p.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),i+="a=mid:"+e.mid+"\r\n",e.direction?i+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?i+="a=sendrecv\r\n":e.rtpSender?i+="a=sendonly\r\n":e.rtpReceiver?i+="a=recvonly\r\n":i+="a=inactive\r\n",e.rtpSender){var o="msid:"+r.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+o,i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o,e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o,i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+p.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+p.localCName+"\r\n"),i},p.getDirection=function(e,t){for(var n=p.splitLines(e),r=0;r<n.length;r++)switch(n[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[r].substr(2)}return t?p.getDirection(t):"sendrecv"},p.getKind=function(e){return p.splitLines(e)[0].split(" ")[0].substr(2)},p.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.exports=p},{}],60:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":61}],61:[function(e,t,n){var a=e("./url"),r=e("socket.io-parser"),s=e("./manager"),c=e("debug")("socket.io-client");t.exports=n=i;var u=n.managers={};function i(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r=a(e),i=r.source,o=r.id;return t.forceNew||t["force new connection"]||!1===t.multiplex?(c("ignoring socket cache for %s",i),n=s(i,t)):(u[o]||(c("new io instance for %s",i),u[o]=s(i,t)),n=u[o]),n.socket(r.path)}n.protocol=r.protocol,n.connect=i,n.Manager=e("./manager"),n.Socket=e("./socket")},{"./manager":62,"./socket":64,"./url":65,debug:19,"socket.io-parser":67}],62:[function(e,t,n){e("./url");var s=e("engine.io-client"),r=e("./socket"),i=e("component-emitter"),o=e("socket.io-parser"),c=e("./on"),a=e("component-bind"),u=(e("object-component"),e("debug")("socket.io-client:manager")),p=e("indexof"),d=e("backo2");function l(e,t){if(!(this instanceof l))return new l(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new o.Encoder,this.decoder=new o.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}(t.exports=l).prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)this.nsps[e].emit.apply(this.nsps[e],arguments)},l.prototype.updateSocketIds=function(){for(var e in this.nsps)this.nsps[e].id=this.engine.id},i(l.prototype),l.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},l.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},l.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},l.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},l.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},l.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},l.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},l.prototype.open=l.prototype.connect=function(n){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=s(this.uri,this.opts);var e=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var t=c(e,"open",function(){r.onopen(),n&&n()}),i=c(e,"error",function(e){if(u("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",e),n){var t=new Error("Connection error");t.data=e,n(t)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var o=this._timeout;u("connect attempt will timeout after %d",o);var a=setTimeout(function(){u("connect attempt timed out after %d",o),t.destroy(),e.close(),e.emit("error","timeout"),r.emitAll("connect_timeout",o)},o);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(t),this.subs.push(i),this},l.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(c(e,"data",a(this,"ondata"))),this.subs.push(c(this.decoder,"decoded",a(this,"ondecoded"))),this.subs.push(c(e,"error",a(this,"onerror"))),this.subs.push(c(e,"close",a(this,"onclose")))},l.prototype.ondata=function(e){this.decoder.add(e)},l.prototype.ondecoded=function(e){this.emit("packet",e)},l.prototype.onerror=function(e){u("error",e),this.emitAll("error",e)},l.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new r(this,e),this.nsps[e]=t;var n=this;t.on("connect",function(){t.id=n.engine.id,~p(n.connected,t)||n.connected.push(t)})}return t},l.prototype.destroy=function(e){var t=p(this.connected,e);~t&&this.connected.splice(t,1),this.connected.length||this.close()},l.prototype.packet=function(e){u("writing packet %j",e);var n=this;n.encoding?n.packetBuffer.push(e):(n.encoding=!0,this.encoder.encode(e,function(e){for(var t=0;t<e.length;t++)n.engine.write(e[t]);n.encoding=!1,n.processPacketQueue()}))},l.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},l.prototype.cleanup=function(){for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},l.prototype.close=l.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},l.prototype.onclose=function(e){u("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},l.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();u("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||(u("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(u("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(u("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},l.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},{"./on":63,"./socket":64,"./url":65,backo2:13,"component-bind":16,"component-emitter":17,debug:19,"engine.io-client":20,indexof:41,"object-component":48,"socket.io-parser":67}],63:[function(e,t,n){t.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},{}],64:[function(e,t,n){var o=e("socket.io-parser"),r=e("component-emitter"),a=e("to-array"),i=e("./on"),s=e("component-bind"),c=e("debug")("socket.io-client:socket"),u=e("has-binary");t.exports=l;var p={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},d=r.prototype.emit;function l(e,t){this.io=e,this.nsp=t,(this.json=this).ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}r(l.prototype),l.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[i(e,"open",s(this,"onopen")),i(e,"packet",s(this,"onpacket")),i(e,"close",s(this,"onclose"))]}},l.prototype.open=l.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen()),this},l.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},l.prototype.emit=function(e){if(p.hasOwnProperty(e))return d.apply(this,arguments),this;var t=a(arguments),n=o.EVENT;u(t)&&(n=o.BINARY_EVENT);var r={type:n,data:t};return"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),r.id=this.ids++),this.connected?this.packet(r):this.sendBuffer.push(r),this},l.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},l.prototype.onopen=function(){c("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:o.CONNECT})},l.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},l.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case o.CONNECT:this.onconnect();break;case o.EVENT:case o.BINARY_EVENT:this.onevent(e);break;case o.ACK:case o.BINARY_ACK:this.onack(e);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",e.data)}},l.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?d.apply(this,t):this.receiveBuffer.push(t)},l.prototype.ack=function(n){var r=this,i=!1;return function(){if(!i){i=!0;var e=a(arguments);c("sending ack %j",e);var t=u(e)?o.BINARY_ACK:o.ACK;r.packet({type:t,id:n,data:e})}}},l.prototype.onack=function(e){c("calling ack %s with %j",e.id,e.data),this.acks[e.id].apply(this,e.data),delete this.acks[e.id]},l.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},l.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)d.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},l.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},l.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},l.prototype.close=l.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:o.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":63,"component-bind":16,"component-emitter":17,debug:19,"has-binary":39,"socket.io-parser":67,"to-array":69}],65:[function(e,t,n){(function(r){var i=e("parseuri"),o=e("debug")("socket.io-client:url");t.exports=function(e,t){var n=e,t=t||r.location;null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.hostname+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),n=i(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));return n.path=n.path||"/",n.id=n.protocol+"://"+n.host+":"+n.port,n.href=n.protocol+"://"+n.host+(t&&t.port==n.port?"":":"+n.port),n}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:19,parseuri:51}],66:[function(e,t,n){(function(p){var d=e("isarray"),l=e("./is-buffer");n.deconstructPacket=function(e){var a=[],t=e.data;var n=e;return n.data=function e(t){if(!t)return t;if(l(t)){var n={_placeholder:!0,num:a.length};return a.push(t),n}if(d(t)){for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=e(t[i]);return r}if("object"==typeof t&&!(t instanceof Date)){for(var o in r={},t)r[o]=e(t[o]);return r}return t}(t),n.attachments=a.length,{packet:n,buffers:a}},n.reconstructPacket=function(e,i){return e.data=function e(t){if(t&&t._placeholder)return i[t.num];if(d(t)){for(var n=0;n<t.length;n++)t[n]=e(t[n]);return t}if(t&&"object"==typeof t){for(var r in t)t[r]=e(t[r]);return t}return t}(e.data),e.attachments=void 0,e},n.removeBlobs=function(e,s){var c=0,u=e;!function e(t,n,r){if(!t)return t;if(p.Blob&&t instanceof Blob||p.File&&t instanceof File){c++;var i=new FileReader;i.onload=function(){r?r[n]=this.result:u=this.result,--c||s(u)},i.readAsArrayBuffer(t)}else if(d(t))for(var o=0;o<t.length;o++)e(t[o],o,t);else if(t&&"object"==typeof t&&!l(t))for(var a in t)e(t[a],a,t)}(u),c||s(u)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":68,isarray:42}],67:[function(e,t,a){var s=e("debug")("socket.io-parser"),c=e("json3"),n=(e("isarray"),e("component-emitter")),o=e("./binary"),r=e("./is-buffer");function i(){}function u(e){var t="",n=!1;return t+=e.type,a.BINARY_EVENT!=e.type&&a.BINARY_ACK!=e.type||(t+=e.attachments,t+="-"),e.nsp&&"/"!=e.nsp&&(n=!0,t+=e.nsp),null!=e.id&&(n&&(t+=",",n=!1),t+=e.id),null!=e.data&&(n&&(t+=","),t+=c.stringify(e.data)),s("encoded %j as %s",e,t),t}function p(){this.reconstructor=null}function d(e){this.reconPack=e,this.buffers=[]}function l(e){return{type:a.ERROR,data:"parser error"}}a.protocol=4,a.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],a.CONNECT=0,a.DISCONNECT=1,a.EVENT=2,a.ACK=3,a.ERROR=4,a.BINARY_EVENT=5,a.BINARY_ACK=6,a.Encoder=i,a.Decoder=p,i.prototype.encode=function(e,t){var n,i;(s("encoding packet %j",e),a.BINARY_EVENT==e.type||a.BINARY_ACK==e.type)?(n=e,i=t,o.removeBlobs(n,function(e){var t=o.deconstructPacket(e),n=u(t.packet),r=t.buffers;r.unshift(n),i(r)})):t([u(e)])},n(p.prototype),p.prototype.add=function(e){var t;if("string"==typeof e)t=function(e){var t={},n=0;if(t.type=Number(e.charAt(0)),null==a.types[t.type])return l();if(a.BINARY_EVENT==t.type||a.BINARY_ACK==t.type){for(var r="";"-"!=e.charAt(++n)&&(r+=e.charAt(n),n!=e.length););if(r!=Number(r)||"-"!=e.charAt(n))throw new Error("Illegal attachments");t.attachments=Number(r)}if("/"==e.charAt(n+1))for(t.nsp="";++n;){var i=e.charAt(n);if(","==i)break;if(t.nsp+=i,n==e.length)break}else t.nsp="/";var o=e.charAt(n+1);if(""!==o&&Number(o)==o){for(t.id="";++n;){var i=e.charAt(n);if(null==i||Number(i)!=i){--n;break}if(t.id+=e.charAt(n),n==e.length)break}t.id=Number(t.id)}if(e.charAt(++n))try{t.data=c.parse(e.substr(n))}catch(e){return l()}return s("decoded %s as %j",e,t),t}(e),a.BINARY_EVENT==t.type||a.BINARY_ACK==t.type?(this.reconstructor=new d(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!r(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",t))}},p.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},d.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},d.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":66,"./is-buffer":68,"component-emitter":17,debug:19,isarray:42,json3:43}],68:[function(e,n,t){(function(t){n.exports=function(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],69:[function(e,t,n){t.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},{}],70:[function(e,y,b){(function(v){!function(e){var t="object"==typeof b&&b,n="object"==typeof y&&y&&y.exports==t&&y,r="object"==typeof v&&v;r.global!==r&&r.window!==r||(e=r);var i,o,a,s=String.fromCharCode;function c(e){for(var t,n,r=[],i=0,o=e.length;i<o;)55296<=(t=e.charCodeAt(i++))&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function u(e){if(55296<=e&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function p(e,t){return s(e>>t&63|128)}function d(e){if(0==(4294967168&e))return s(e);var t="";return 0==(4294965248&e)?t=s(e>>6&31|192):0==(4294901760&e)?(u(e),t=s(e>>12&15|224),t+=p(e,6)):0==(4292870144&e)&&(t=s(e>>18&7|240),t+=p(e,12),t+=p(e,6)),t+=s(63&e|128)}function l(){if(o<=a)throw Error("Invalid byte index");var e=255&i[a];if(a++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function f(){var e,t;if(o<a)throw Error("Invalid byte index");if(a==o)return!1;if(e=255&i[a],a++,0==(128&e))return e;if(192==(224&e)){if(128<=(t=(31&e)<<6|l()))return t;throw Error("Invalid continuation byte")}if(224==(240&e)){if(2048<=(t=(15&e)<<12|l()<<6|l()))return u(t),t;throw Error("Invalid continuation byte")}if(240==(248&e)&&65536<=(t=(15&e)<<18|l()<<12|l()<<6|l())&&t<=1114111)return t;throw Error("Invalid UTF-8 detected")}var h={version:"2.0.0",encode:function(e){for(var t=c(e),n=t.length,r=-1,i="";++r<n;)i+=d(t[r]);return i},decode:function(e){i=c(e),o=i.length,a=0;for(var t,n=[];!1!==(t=f());)n.push(t);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)65535<(t=e[r])&&(i+=s((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=s(t);return i}(n)}};if(t&&!t.nodeType)if(n)n.exports=h;else{var m={}.hasOwnProperty;for(var g in h)m.call(h,g)&&(t[g]=h[g])}else e.utf8=h}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],71:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],72:[function(e,t,n){t.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},{}],73:[function(l,e,P){(function(r,i){var s=/%[sdj%]/g;P.format=function(e){if(!w(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(c(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,o=String(e).replace(s,function(e){if("%%"===e)return"%";if(i<=n)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),a=r[n];n<i;a=r[++n])y(a)||!p(a)?o+=" "+a:o+=" "+c(a);return o},P.deprecate=function(e,t){if(S(i.process))return function(){return P.deprecate(e,t).apply(this,arguments)};if(!0===r.noDeprecation)return e;var n=!1;return function(){if(!n){if(r.throwDeprecation)throw new Error(t);r.traceDeprecation?console.trace(t):console.error(t),n=!0}return e.apply(this,arguments)}};var e,o={};function c(e,t){var n={seen:[],stylize:u};return 3<=arguments.length&&(n.depth=arguments[2]),4<=arguments.length&&(n.colors=arguments[3]),v(t)?n.showHidden=t:t&&P._extend(n,t),S(n.showHidden)&&(n.showHidden=!1),S(n.depth)&&(n.depth=2),S(n.colors)&&(n.colors=!1),S(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=a),f(n,e,n.depth)}function a(e,t){var n=c.styles[t];return n?"["+c.colors[n][0]+"m"+e+"["+c.colors[n][1]+"m":e}function u(e,t){return e}function f(t,n,r){if(t.customInspect&&n&&T(n.inspect)&&n.inspect!==P.inspect&&(!n.constructor||n.constructor.prototype!==n)){var e=n.inspect(r,t);return w(e)||(e=f(t,e,r)),e}var i=function(e,t){if(S(t))return e.stylize("undefined","undefined");if(w(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(b(t))return e.stylize(""+t,"number");if(v(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(t,n);if(i)return i;var o,a=Object.keys(n),s=(o={},a.forEach(function(e,t){o[e]=!0}),o);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),E(n)&&(0<=a.indexOf("message")||0<=a.indexOf("description")))return h(n);if(0===a.length){if(T(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(C(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(k(n))return t.stylize(Date.prototype.toString.call(n),"date");if(E(n))return h(n)}var u,p="",d=!1,l=["{","}"];(g(n)&&(d=!0,l=["[","]"]),T(n))&&(p=" [Function"+(n.name?": "+n.name:"")+"]");return C(n)&&(p=" "+RegExp.prototype.toString.call(n)),k(n)&&(p=" "+Date.prototype.toUTCString.call(n)),E(n)&&(p=" "+h(n)),0!==a.length||d&&0!=n.length?r<0?C(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=d?function(t,n,r,i,e){for(var o=[],a=0,s=n.length;a<s;++a)x(n,String(a))?o.push(m(t,n,r,i,String(a),!0)):o.push("");return e.forEach(function(e){e.match(/^\d+$/)||o.push(m(t,n,r,i,e,!0))}),o}(t,n,r,s,a):a.map(function(e){return m(t,n,r,s,e,d)}),t.seen.pop(),function(e,t,n){if(60<e.reduce(function(e,t){return 0,0<=t.indexOf("\n")&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0))return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(u,p,l)):l[0]+p+l[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function m(e,t,n,r,i,o){var a,s,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),x(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(c.value)<0?-1<(s=y(n)?f(e,c.value,null):f(e,c.value,n-1)).indexOf("\n")&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),S(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function g(e){return Array.isArray(e)}function v(e){return"boolean"==typeof e}function y(e){return null===e}function b(e){return"number"==typeof e}function w(e){return"string"==typeof e}function S(e){return void 0===e}function C(e){return p(e)&&"[object RegExp]"===t(e)}function p(e){return"object"==typeof e&&null!==e}function k(e){return p(e)&&"[object Date]"===t(e)}function E(e){return p(e)&&("[object Error]"===t(e)||e instanceof Error)}function T(e){return"function"==typeof e}function t(e){return Object.prototype.toString.call(e)}function n(e){return e<10?"0"+e.toString(10):e.toString(10)}P.debuglog=function(t){if(S(e)&&(e=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!o[t])if(new RegExp("\\b"+t+"\\b","i").test(e)){var n=r.pid;o[t]=function(){var e=P.format.apply(P,arguments);console.error("%s %d: %s",t,n,e)}}else o[t]=function(){};return o[t]},(P.inspect=c).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},c.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},P.isArray=g,P.isBoolean=v,P.isNull=y,P.isNullOrUndefined=function(e){return null==e},P.isNumber=b,P.isString=w,P.isSymbol=function(e){return"symbol"==typeof e},P.isUndefined=S,P.isRegExp=C,P.isObject=p,P.isDate=k,P.isError=E,P.isFunction=T,P.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},P.isBuffer=l("./support/isBuffer");var d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function x(e,t){return Object.prototype.hasOwnProperty.call(e,t)}P.log=function(){var e,t;console.log("%s - %s",(e=new Date,t=[n(e.getHours()),n(e.getMinutes()),n(e.getSeconds())].join(":"),[e.getDate(),d[e.getMonth()],t].join(" ")),P.format.apply(P,arguments))},P.inherits=l("inherits"),P._extend=function(e,t){if(!t||!p(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,l("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":72,_process:52,inherits:71}],74:[function(e,t,n){var r,i;window.mozRTCPeerConnection||navigator.mozGetUserMedia?(r="moz",i=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10)):(window.webkitRTCPeerConnection||navigator.webkitGetUserMedia)&&(r="webkit",i=navigator.userAgent.match(/Chrom(e|ium)/)&&parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2],10));var o=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,a=window.mozRTCIceCandidate||window.RTCIceCandidate,s=window.mozRTCSessionDescription||window.RTCSessionDescription,c=window.webkitMediaStream||window.MediaStream,u="https:"===window.location.protocol&&("webkit"===r&&26<=i||"moz"===r&&33<=i),p=window.AudioContext||window.webkitAudioContext,d=document.createElement("video"),l=d&&d.canPlayType&&"probably"===d.canPlayType('video/webm; codecs="vp8", vorbis'),f=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.msGetUserMedia||navigator.mozGetUserMedia;t.exports={prefix:r,browserVersion:i,support:!!o&&!!f,supportRTCPeerConnection:!!o,supportVp8:l,supportGetUserMedia:!!f,supportDataChannel:!!(o&&o.prototype&&o.prototype.createDataChannel),supportWebAudio:!(!p||!p.prototype.createMediaStreamSource),supportMediaStream:!(!c||!c.prototype.removeTrack),supportScreenSharing:!!u,AudioContext:p,PeerConnection:o,SessionDescription:s,IceCandidate:a,MediaStream:c,getUserMedia:f}},{}],75:[function(e,t,n){function r(){}(t.exports=r).mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var r=3===arguments.length,i=r?t:void 0,o=r?n:t;return o._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(o),this},t.once=function(t,e,n){var r=this,i=3===arguments.length,o=i?e:void 0,a=i?n:e;return this.on(t,o,function e(){r.off(t,e),a.apply(this,arguments)}),this},t.releaseGroup=function(e){var t,n,r,i;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,r=(i=this.callbacks[t]).length;n<r;n++)i[n]._groupName===e&&(i.splice(n,1),n--,r--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,r=this.callbacks[e];return r&&(1===arguments.length?delete this.callbacks[e]:(n=r.indexOf(t),r.splice(n,1),0===r.length&&delete this.callbacks[e])),this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,r,i=[].slice.call(arguments,1),o=this.callbacks[e],a=this.getWildcardCallbacks(e);if(o)for(t=0,n=(r=o.slice()).length;t<n&&r[t];++t)r[t].apply(this,i);if(a)for(n=a.length,t=0,n=(r=a.slice()).length;t<n&&r[t];++t){if("volumeChange"!=e&&"localStreamRequestFailed"==e&&!0===getVideo){console.log(e),console.log(i);var s={};s.event=e,s.args=i;getDataErrorMaker("Ha ocurrido un error. Vuelva a intentarlo. Debes otorgar permisos para usar tu webcam. Revisa si estás usando la cámara en otra aplicación o ventana. Revisa si estás usando Google Chrome o Mozilla Firefox, los otros navegadores no son compatibles. Code: localStreamRequestFailed",s);break}r[t].apply(this,[e].concat(i))}return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,r=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(r=r.concat(this.callbacks[t]));return r}},r.mixin(r)},{}],76:[function(e,t,n){var r=function(){return this}(),i=r.WebSocket||r.MozWebSocket;function o(e,t,n){return t?new i(e,t):new i(e)}t.exports=i?o:null,i&&(o.prototype=i.prototype)},{}],77:[function(e,t,n){var r=e("util"),i=e("webrtcsupport"),o=e("rtcpeerconnection"),a=e("wildemitter"),s=e("filetransfer"),c="https://simplewebrtc.com/protocol/filetransfer#inband-v1";function u(e){var i=this;a.call(this),this.id=e.id,this.parent=e.parent,this.type=e.type||"video",this.oneway=e.oneway||!1,this.sharemyscreen=e.sharemyscreen||!1,this.browserPrefix=e.prefix,this.stream=e.stream,this.enableDataChannels=void 0===e.enableDataChannels?this.parent.config.enableDataChannels:e.enableDataChannels,this.receiveMedia=e.receiveMedia||this.parent.config.receiveMedia,this.channels={},this.sid=e.sid||Date.now().toString(),this.pc=new o(this.parent.config.peerConnectionConfig,this.parent.config.peerConnectionConstraints),this.pc.on("ice",this.onIceCandidate.bind(this)),this.pc.on("endOfCandidates",function(e){i.send("endOfCandidates",e)}),this.pc.on("offer",function(e){i.parent.config.nick&&(e.nick=i.parent.config.nick),i.send("offer",e)}),this.pc.on("answer",function(e){i.parent.config.nick&&(e.nick=i.parent.config.nick),i.send("answer",e)}),this.pc.on("addStream",this.handleRemoteStreamAdded.bind(this)),this.pc.on("addChannel",this.handleDataChannelAdded.bind(this)),this.pc.on("removeStream",this.handleStreamRemoved.bind(this)),this.pc.on("negotiationNeeded",this.emit.bind(this,"negotiationNeeded")),this.pc.on("iceConnectionStateChange",this.emit.bind(this,"iceConnectionStateChange")),this.pc.on("iceConnectionStateChange",function(){switch(i.pc.iceConnectionState){case"failed":"offer"===i.pc.pc.localDescription.type&&(i.parent.emit("iceFailed",i),i.send("connectivityError"))}}),this.pc.on("signalingStateChange",this.emit.bind(this,"signalingStateChange")),this.logger=this.parent.logger,"screen"===e.type?this.parent.localScreens&&this.parent.localScreens[0]&&this.sharemyscreen&&(this.logger.log("adding local screen stream to peer connection"),this.pc.addStream(this.parent.localScreens[0]),this.broadcaster=e.broadcaster):this.parent.localStreams.forEach(function(e){i.pc.addStream(e)}),this.on("channelOpen",function(r){r.protocol===c&&(r.onmessage=function(e){var t=JSON.parse(e.data),n=new s.Receiver;n.receive(t,r),i.emit("fileTransfer",t,n),n.on("receivedFile",function(e,t){n.channel.close()})})}),this.on("*",function(){i.parent.emit.apply(i.parent,arguments)})}r.inherits(u,a),u.prototype.handleMessage=function(e){var t=this;if(this.logger.log("getting",e.type,e),e.prefix&&(this.browserPrefix=e.prefix),"offer"===e.type)this.nick||(this.nick=e.payload.nick),delete e.payload.nick,this.pc.handleOffer(e.payload,function(e){e||t.pc.answer(function(e,t){})});else if("answer"===e.type)this.nick||(this.nick=e.payload.nick),delete e.payload.nick,this.pc.handleAnswer(e.payload);else if("candidate"===e.type)this.pc.processIce(e.payload);else if("connectivityError"===e.type)this.parent.emit("connectivityError",t);else if("mute"===e.type)this.parent.emit("mute",{id:e.from,name:e.payload.name});else if("unmute"===e.type)this.parent.emit("unmute",{id:e.from,name:e.payload.name});else if("endOfCandidates"===e.type){(this.pc.pc.transceivers||[]).forEach(function(e){e.iceTransport&&e.iceTransport.addRemoteCandidate({})})}},u.prototype.send=function(e,t){var n={to:this.id,sid:this.sid,broadcaster:this.broadcaster,roomType:this.type,type:e,payload:t,prefix:i.prefix};this.logger.log("sending",e,n),this.parent.emit("message",n)},u.prototype.sendDirectly=function(e,t,n){var r={type:t,payload:n};this.logger.log("sending via datachannel",e,t,r);var i=this.getDataChannel(e);return"open"==i.readyState&&(i.send(JSON.stringify(r)),!0)},u.prototype._observeDataChannel=function(t){var n=this;t.onclose=this.emit.bind(this,"channelClose",t),t.onerror=this.emit.bind(this,"channelError",t),t.onmessage=function(e){n.emit("channelMessage",n,t.label,JSON.parse(e.data),t,e)},t.onopen=this.emit.bind(this,"channelOpen",t)},u.prototype.getDataChannel=function(e,t){if(!i.supportDataChannel)return this.emit("error",new Error("createDataChannel not supported"));var n=this.channels[e];return t||(t={}),n||(n=this.channels[e]=this.pc.createDataChannel(e,t),this._observeDataChannel(n),n)},u.prototype.onIceCandidate=function(e){if(!this.closed)if(e){var t=this.parent.config.peerConnectionConfig;"moz"===i.prefix&&t&&t.iceTransports&&e.candidate&&e.candidate.candidate&&e.candidate.candidate.indexOf(t.iceTransports)<0?this.logger.log("Ignoring ice candidate not matching pcConfig iceTransports type: ",t.iceTransports):this.send("candidate",e)}else this.logger.log("End of candidates.")},u.prototype.start=function(){this.enableDataChannels&&this.getDataChannel("simplewebrtc"),this.pc.offer(this.receiveMedia,function(e,t){})},u.prototype.icerestart=function(){var e=this.receiveMedia;e.mandatory.IceRestart=!0,this.pc.offer(e,function(e,t){})},u.prototype.end=function(){this.closed||(this.pc.close(),this.handleStreamRemoved())},u.prototype.handleRemoteStreamAdded=function(e){var n=this;this.stream?this.logger.warn("Already have a remote stream"):(this.stream=e.stream,this.stream.getTracks().forEach(function(e){e.addEventListener("ended",function(){var e,t;e=n.stream,t=!0,e.getTracks().forEach(function(e){t="ended"===e.readyState&&t}),t&&n.end()})}),this.parent.emit("peerStreamAdded",this))},u.prototype.handleStreamRemoved=function(){var e=this.parent.peers.indexOf(this);-1<e&&(this.parent.peers.splice(e,1),this.closed=!0,this.parent.emit("peerStreamRemoved",this))},u.prototype.handleDataChannelAdded=function(e){this.channels[e.label]=e,this._observeDataChannel(e)},u.prototype.sendFile=function(e){var t=new s.Sender,n=this.getDataChannel("filetransfer"+(new Date).getTime(),{protocol:c});return n.onopen=function(){n.send(JSON.stringify({size:e.size,name:e.name})),t.send(e,n)},n.onclose=function(){console.log("sender received transfer"),t.emit("complete")},t},t.exports=u},{filetransfer:35,rtcpeerconnection:53,util:73,webrtcsupport:74,wildemitter:75}],78:[function(e,t,n){var a=e("./webrtc"),s=e("wildemitter"),c=e("webrtcsupport"),u=e("attachmediastream"),p=e("mockconsole"),d=e("./socketioconnection");function r(e){var t,n,r=this,i=e||{},o=this.config={url:"https://sandbox.simplewebrtc.com:443/",socketio:{"force new connection":!0},connection:null,debug:!1,localVideoEl:"",remoteVideosEl:"",enableDataChannels:!0,autoRequestMedia:!1,autoRemoveVideos:!0,adjustPeerVolume:!1,peerVolumeWhenSpeaking:.25,media:{video:getVideo,audio:getAudio},receiveMedia:{offerToReceiveAudio:offerReceiveAudio,offerToReceiveVideo:offerReceiveVideo},localVideo:{autoplay:getVideo,mirror:getVideo,muted:getAudio}};for(t in this.logger=e.debug?e.logger||console:e.logger||p,i)i.hasOwnProperty(t)&&(this.config[t]=i[t]);this.capabilities=c,s.call(this),(n=null===this.config.connection?this.connection=new d(this.config):this.connection=this.config.connection).on("connect",function(){r.emit("connectionReady",n.getSessionid()),r.sessionReady=!0,r.testReadiness()}),n.on("message",function(t){var n,e=r.webrtc.getPeers(t.from,t.roomType);"offer"===t.type?(e.length&&e.forEach(function(e){e.sid==t.sid&&(n=e)}),n||(n=r.webrtc.createPeer({id:t.from,sid:t.sid,type:t.roomType,enableDataChannels:r.config.enableDataChannels&&"screen"!==t.roomType,sharemyscreen:"screen"===t.roomType&&!t.broadcaster,broadcaster:"screen"!==t.roomType||t.broadcaster?null:r.connection.getSessionid()}),r.emit("createdPeer",n)),n.handleMessage(t)):e.length&&e.forEach(function(e){t.sid?e.sid===t.sid&&e.handleMessage(t):e.handleMessage(t)})}),n.on("remove",function(e){e.id!==r.connection.getSessionid()&&r.webrtc.removePeers(e.id,e.type)}),e.logger=this.logger,e.debug=!1,this.webrtc=new a(e),["mute","unmute","pauseVideo","resumeVideo","pause","resume","sendToAll","sendDirectlyToAll","getPeers"].forEach(function(e){r[e]=r.webrtc[e].bind(r.webrtc)}),this.webrtc.on("*",function(){r.emit.apply(r,arguments)}),o.debug&&this.on("*",this.logger.log.bind(this.logger,"SimpleWebRTC event:")),this.webrtc.on("localStream",function(){r.testReadiness()}),this.webrtc.on("message",function(e){r.connection.emit("message",e)}),this.webrtc.on("peerStreamAdded",this.handlePeerStreamAdded.bind(this)),this.webrtc.on("peerStreamRemoved",this.handlePeerStreamRemoved.bind(this)),this.config.adjustPeerVolume&&(this.webrtc.on("speaking",this.setVolumeForAll.bind(this,this.config.peerVolumeWhenSpeaking)),this.webrtc.on("stoppedSpeaking",this.setVolumeForAll.bind(this,1))),n.on("stunservers",function(e){r.webrtc.config.peerConnectionConfig.iceServers=e,r.emit("stunservers",e)}),n.on("turnservers",function(e){r.webrtc.config.peerConnectionConfig.iceServers=r.webrtc.config.peerConnectionConfig.iceServers.concat(e),r.emit("turnservers",e)}),this.webrtc.on("iceFailed",function(e){}),this.webrtc.on("connectivityError",function(e){}),this.webrtc.on("audioOn",function(){r.webrtc.sendToAll("unmute",{name:"audio"})}),this.webrtc.on("audioOff",function(){r.webrtc.sendToAll("mute",{name:"audio"})}),this.webrtc.on("videoOn",function(){r.webrtc.sendToAll("unmute",{name:"video"})}),this.webrtc.on("videoOff",function(){r.webrtc.sendToAll("mute",{name:"video"})}),this.webrtc.on("localScreen",function(e){var t=document.createElement("video"),n=r.getRemoteVideoContainer();t.oncontextmenu=function(){return!1},t.id="localScreen",u(e,t),n&&n.appendChild(t),r.emit("localScreenAdded",t),r.connection.emit("shareScreen"),r.webrtc.peers.forEach(function(e){var t;"video"===e.type&&(t=r.webrtc.createPeer({id:e.id,type:"screen",sharemyscreen:!0,enableDataChannels:!1,receiveMedia:{offerToReceiveAudio:0,offerToReceiveVideo:0},broadcaster:r.connection.getSessionid()}),r.emit("createdPeer",t),t.start())})}),this.webrtc.on("localScreenStopped",function(e){r.getLocalScreen()&&r.stopScreenShare()}),this.webrtc.on("channelMessage",function(e,t,n){"volume"==n.type&&r.emit("remoteVolumeChange",e,n.volume)}),this.config.autoRequestMedia&&this.startLocalVideo()}(r.prototype=Object.create(s.prototype,{constructor:{value:r}})).leaveRoom=function(){if(this.roomName){for(this.connection.emit("leave");this.webrtc.peers.length;)this.webrtc.peers[0].end();this.getLocalScreen()&&this.stopScreenShare(),this.emit("leftRoom",this.roomName),this.roomName=void 0}},r.prototype.disconnect=function(){this.connection&&(this.connection.disconnect(),delete this.connection)},r.prototype.handlePeerStreamAdded=function(e){if(!1!==getVideo){var t=this,n=this.getRemoteVideoContainer(),r=u(e.stream);(e.videoEl=r).id=this.getDomId(e),n&&n.appendChild(r),this.emit("videoAdded",r,e),window.setTimeout(function(){t.webrtc.isAudioEnabled()||e.send("mute",{name:"audio"}),t.webrtc.isVideoEnabled()||e.send("mute",{name:"video"})},250)}},r.prototype.handlePeerStreamRemoved=function(e){var t=this.getRemoteVideoContainer(),n=e.videoEl;this.config.autoRemoveVideos&&t&&n&&t.removeChild(n),n&&this.emit("videoRemoved",n,e)},r.prototype.getDomId=function(e){return[e.id,e.type,e.broadcaster?"broadcasting":"incoming"].join("_")},r.prototype.setVolumeForAll=function(t){this.webrtc.peers.forEach(function(e){e.videoEl&&(e.videoEl.volume=t)})},r.prototype.joinRoom=function(a,s){var c=this;this.roomName=a,this.connection.emit("join",a,function(e,t){var n,r,i,o;if(debug&&(console.log("join CB",e,t),console.log("Init chat initChat()")),initChat(),e)c.emit("error",e);else for(n in t.clients)for(i in r=t.clients[n])r[i]&&(o=c.webrtc.createPeer({id:n,type:i,enableDataChannels:c.config.enableDataChannels&&"screen"!==i,receiveMedia:{offerToReceiveAudio:"screen"!==i&&c.config.receiveMedia.offerToReceiveAudio?1:0,offerToReceiveVideo:c.config.receiveMedia.offerToReceiveVideo}}),c.emit("createdPeer",o),o.start());s&&s(e,t),c.emit("joinedRoom",a)})},r.prototype.getEl=function(e){return"string"==typeof e?document.getElementById(e):e},r.prototype.startLocalVideo=function(){var n=this;this.webrtc.start(this.config.media,function(e,t){e?n.emit("localMediaError",e):u(t,n.getLocalVideoContainer(),n.config.localVideo)})},r.prototype.stopLocalVideo=function(){this.webrtc.stop()},r.prototype.getLocalVideoContainer=function(){var e=this.getEl(this.config.localVideoEl);if(e&&"VIDEO"===e.tagName)return e.oncontextmenu=function(){return!1},e;if(e){var t=document.createElement("video");return t.oncontextmenu=function(){return!1},e.appendChild(t),t}},r.prototype.getRemoteVideoContainer=function(){return this.getEl(this.config.remoteVideosEl)},r.prototype.shareScreen=function(e){this.webrtc.startScreenShare(e)},r.prototype.getLocalScreen=function(){return this.webrtc.localScreens&&this.webrtc.localScreens[0]},r.prototype.stopScreenShare=function(){this.connection.emit("unshareScreen");var e=document.getElementById("localScreen"),t=this.getRemoteVideoContainer();this.config.autoRemoveVideos&&t&&e&&t.removeChild(e),e&&this.emit("videoRemoved",e),this.getLocalScreen()&&this.webrtc.stopScreenShare(),this.webrtc.peers.forEach(function(e){e.broadcaster&&e.end()})},r.prototype.testReadiness=function(){this.sessionReady&&(this.config.media.video||this.config.media.audio?0<this.webrtc.localStreams.length&&this.emit("readyToCall",this.connection.getSessionid()):this.emit("readyToCall",this.connection.getSessionid()))},r.prototype.createRoom=function(e,t){this.roomName=e,2===arguments.length?this.connection.emit("create",e,t):this.connection.emit("create",e)},r.prototype.sendFile=function(){if(!c.dataChannel)return this.emit("error",new Error("DataChannelNotSupported"))},t.exports=r},{"./socketioconnection":79,"./webrtc":80,attachmediastream:3,mockconsole:46,webrtcsupport:74,wildemitter:75}],79:[function(e,t,n){var r=e("socket.io-client");function i(e){this.connection=r.connect(e.url,e.socketio)}i.prototype.on=function(e,t){this.connection.on(e,t)},i.prototype.emit=function(){this.connection.emit.apply(this.connection,arguments)},i.prototype.getSessionid=function(){return this.connection.id},i.prototype.disconnect=function(){return this.connection.disconnect()},t.exports=i},{"socket.io-client":60}],80:[function(e,t,n){var r=e("util"),o=e("webrtcsupport"),a=e("mockconsole"),s=e("localmedia"),i=e("./peer");function c(e){var r=this,t=e||{},n=[];n=[];!!navigator.mozGetUserMedia?(n.push({url:"stun:23.21.150.121"}),n.push({url:"stun:stun.services.mozilla.com"})):(n.push({url:"stun:stun.l.google.com:19302"}),n.push({url:"stun:stun.anyfirewall.com:3478"})),n.push({url:"turn:192.158.29.39:3478?transport=udp",credential:"JZEOEt2V3Qb0y27GRntt2u2PAYA=",username:"28224511:1379330808"}),n.push({url:"turn:192.158.29.39:3478?transport=tcp",credential:"JZEOEt2V3Qb0y27GRntt2u2PAYA=",username:"28224511:1379330808"}),n.push({url:"turn:turn.bistri.com:80",username:"homeo",credential:"homeo"}),n.push({url:"stun:stun.l.google.com:19302"}),n.push({url:"stun:stun1.l.google.com:19302"}),n.push({url:"stun:stun2.l.google.com:19302"}),n.push({url:"stun:stu3.l.google.com:19302"}),n.push({url:"stun:stun4.l.google.com:19302"}),n.push({url:"stun:stun.ekiga.net"}),n.push({url:"stun:stun.ideasip.com"}),n.push({url:"stun:stun.iptel.org"}),n.push({url:"stun:stun.rixtelecom.se"}),n.push({url:"stun:stun.schlund.de"}),n.push({url:"stun:stunserver.org"}),n.push({url:"stun:stun.softjoys.com"}),n.push({url:"stun:stun.voiparound.com"}),n.push({url:"stun:stun.voipbuster.com"}),n.push({url:"stun:stun.voipstunt.com"}),n.push({url:"stun:stun.stunprotocol.org:3478"}),n.push({url:"stun:stun.services.mozilla.com"}),n.push({url:"stun:stun.sipgate.net"}),n.push({url:"stun:stun.l.google.com:19302"}),n.push({url:"turn:numb.viagenie.ca:3478",username:"assdres@gmail.com",credential:"padre08"}),n.push({urls:"stun:stun.l.google.com:19302"},{urls:"turn:192.158.29.39:3478?transport=udp",credential:"JZEOEt2V3Qb0y27GRntt2u2PAYA=",username:"28224511:1379330808"},{urls:"turn:192.158.29.39:3478?transport=tcp",credential:"JZEOEt2V3Qb0y27GRntt2u2PAYA=",username:"28224511:1379330808"});var i;this.config={debug:!1,peerConnectionConfig:{iceServers:[{url:"stun:stun.l.google.com:19302"}]},peerConnectionConstraints:{optional:[]},receiveMedia:{offerToReceiveAudio:1,offerToReceiveVideo:1},enableDataChannels:!0};for(i in this.logger=e.debug?e.logger||console:e.logger||a,t)t.hasOwnProperty(i)&&(this.config[i]=t[i]);o.support||this.logger.error("Your browser doesn't seem to support WebRTC"),this.peers=[],s.call(this,this.config),this.on("speaking",function(){r.hardMuted||r.peers.forEach(function(e){if(e.enableDataChannels){var t=e.getDataChannel("hark");if("open"!=t.readyState)return;t.send(JSON.stringify({type:"speaking"}))}})}),this.on("stoppedSpeaking",function(){r.hardMuted||r.peers.forEach(function(e){if(e.enableDataChannels){var t=e.getDataChannel("hark");if("open"!=t.readyState)return;t.send(JSON.stringify({type:"stoppedSpeaking"}))}})}),this.on("volumeChange",function(n,e){r.hardMuted||r.peers.forEach(function(e){if(e.enableDataChannels){var t=e.getDataChannel("hark");if("open"!=t.readyState)return;t.send(JSON.stringify({type:"volume",volume:n}))}})}),this.config.debug&&this.on("*",function(e,t,n){(r.config.logger===a?console:r.logger).log("event:",e,t,n)})}r.inherits(c,s),c.prototype.createPeer=function(e){var t;return e.parent=this,t=new i(e),this.peers.push(t),t},c.prototype.removePeers=function(e,t){this.getPeers(e,t).forEach(function(e){e.end()})},c.prototype.getPeers=function(t,n){return this.peers.filter(function(e){return!(t&&e.id!==t||n&&e.type!==n)})},c.prototype.sendToAll=function(t,n){this.peers.forEach(function(e){e.send(t,n)})},c.prototype.sendDirectlyToAll=function(t,n,r){this.peers.forEach(function(e){e.enableDataChannels&&e.sendDirectly(t,n,r)})},t.exports=c},{"./peer":77,localmedia:44,mockconsole:46,util:73,webrtcsupport:74}]},{},[78])(78)});