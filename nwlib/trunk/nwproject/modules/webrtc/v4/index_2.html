<script>
    function get() {
        var loc = document.location.href;
        var getString = loc.split('?')[1];
        if (typeof getString === "undefined" || getString === undefined) {
            return false;
        }
        var GET = getString.split('&');
        var get = {};
        for (var i = 0, l = GET.length; i < l; i++) {
            var tmp = GET[i].split('=');
            get[tmp[0]] = unescape(decodeURI(tmp[1]));
        }
        return get;
    }
</script>
<script src="https://rtcmulticonnection.herokuapp.com/dist/RTCMultiConnection.min.js"></script>
<script src="https://rtcmulticonnection.herokuapp.com/socket.io/socket.io.js"></script>

<script>
    var connection = new RTCMultiConnection();

// this line is VERY_important
    connection.socketURL = 'https://rtcmulticonnection.herokuapp.com:443/';

// if you want audio+video conferencing
    connection.session = {
        audio: true,
        video: true
    };

    var iceServers = [];

    var moz = !!navigator.mozGetUserMedia;
    if (moz) {
        iceServers.push({
            url: 'stun:23.21.150.121'
        });
        iceServers.push({
            url: 'stun:stun.services.mozilla.com'
        });
    } else {
        iceServers.push({
            url: 'stun:stun.l.google.com:19302'
        });
        iceServers.push({
            url: 'stun:stun.anyfirewall.com:3478'
        });
    }
    iceServers.push({
        'url': 'turn:192.158.29.39:3478?transport=udp',
        'credential': 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',
        'username': '28224511:1379330808'
    });
    iceServers.push({
        'url': 'turn:192.158.29.39:3478?transport=tcp',
        'credential': 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',
        'username': '28224511:1379330808'
    });
    iceServers.push({
        url: 'turn:turn.bistri.com:80',
        username: 'homeo',
        credential: 'homeo'
    });
    iceServers.push({
        url: 'stun:stun.l.google.com:19302'
    });
    iceServers.push({
        url: 'stun:stun1.l.google.com:19302'
    });
    iceServers.push({
        url: 'stun:stun2.l.google.com:19302'
    });
    iceServers.push({
        url: 'stun:stu3.l.google.com:19302'
    });
    iceServers.push({
        url: 'stun:stun4.l.google.com:19302'
    });
    iceServers.push({
        url: 'stun:stun.ekiga.net'
    });
    iceServers.push({
        url: 'stun:stun.ideasip.com'
    });
    iceServers.push({
        url: 'stun:stun.iptel.org'
    });
    iceServers.push({
        url: 'stun:stun.rixtelecom.se'
    });
    iceServers.push({
        url: 'stun:stun.schlund.de'
    });
    iceServers.push({
        url: 'stun:stunserver.org'
    });
    iceServers.push({
        url: 'stun:stun.softjoys.com'
    });
    iceServers.push({
        url: 'stun:stun.voiparound.com'
    });
    iceServers.push({
        url: 'stun:stun.voipbuster.com'
    });
    iceServers.push({
        url: 'stun:stun.voipstunt.com'
    });
    iceServers.push({
        url: 'stun:stun.stunprotocol.org:3478'
    });
    iceServers.push({
        url: 'stun:stun.services.mozilla.com'
    });
    iceServers.push({
        url: 'stun:stun.sipgate.net'
    });
    iceServers.push({
        url: 'turn:numb.viagenie.ca:3478',
        username: 'assdres@gmail.com',
        credential: 'padre08'
    });
    iceServers.push({
        url: 'stun:stun.l.google.com:19302?transport=udp'
    });
    iceServers.push({
        url: 'stun:ec2-54-176-1-181.us-west-1.compute.amazonaws.com:3478'
    });
    iceServers.push(
            {
                "url": "turn:ec2-54-176-1-181.us-west-1.compute.amazonaws.com:3478",
                "username": "tadhackuser", "credential": "tadhackpw"
            }
    );

    var iceServers = [];

    iceServers.push(
            {
                url: 'numb.viagenie.ca',
                username: 'orionjafe@gmail.com',
                credential: 'metallica'
            }
    );

    iceServers.push(
            {
                url: 'turn:numb.viagenie.ca',
                credential: 'muazkh',
                username: 'webrtc@live.com'
            },
            {
                url: 'turn:192.158.29.39:3478?transport=udp',
                credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',
                username: '28224511:1379330808'
            },
            {
                url: 'turn:192.158.29.39:3478?transport=tcp',
                credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',
                username: '28224511:1379330808'
            },
            {
                url: 'turn:turn.bistri.com:80',
                credential: 'homeo',
                username: 'homeo'
            },
            {
                url: 'turn:turn.anyfirewall.com:443?transport=tcp',
                credential: 'webrtc',
                username: 'webrtc'
            }
    );


    iceServers.push(
            {url: 'stun:stun01.sipphone.com'},
            {url: 'stun:stun.ekiga.net'},
            {url: 'stun:stun.fwdnet.net'},
            {url: 'stun:stun.ideasip.com'},
            {url: 'stun:stun.iptel.org'},
            {url: 'stun:stun.rixtelecom.se'},
            {url: 'stun:stun.schlund.de'},
            {url: 'stun:stun.l.google.com:19302'},
            {url: 'stun:stun1.l.google.com:19302'},
            {url: 'stun:stun2.l.google.com:19302'},
            {url: 'stun:stun3.l.google.com:19302'},
            {url: 'stun:stun4.l.google.com:19302'},
            {url: 'stun:stunserver.org'},
            {url: 'stun:stun.softjoys.com'},
            {url: 'stun:stun.voiparound.com'},
            {url: 'stun:stun.voipbuster.com'},
            {url: 'stun:stun.voipstunt.com'},
            {url: 'stun:stun.voxgratia.org'},
            {url: 'stun:stun.xten.com'},
            {
                url: 'turn:numb.viagenie.ca',
                credential: 'muazkh',
                username: 'webrtc@live.com'
            },
            {
                url: 'turn:192.158.29.39:3478?transport=udp',
                credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',
                username: '28224511:1379330808'
            },
            {
                url: 'turn:192.158.29.39:3478?transport=tcp',
                credential: 'JZEOEt2V3Qb0y27GRntt2u2PAYA=',
                username: '28224511:1379330808'
            }
    );

    iceServers.push({
        url: 'turn:turn.gruponw.com:3478'
    });
    iceServers.push({
        url: 'turn:turn.gruponw.com:5349'
    });
    iceServers.push({
        url: 'turn:turn.gruponw.com:3478',
        username: 'andresf',
        credential: 'padre08'
    });
    iceServers.push({
        url: 'turn:turn.gruponw.com:5349',
        username: 'andresf',
        credential: 'padre08'
    });


    iceServers.push({
        url: 'turn:190.26.239.176:3478',
        username: 'andresf',
        credential: 'padre08'
    });
    iceServers.push({
        url: 'turn:190.26.239.176:5349',
        username: 'andresf',
        credential: 'padre08'
    });

    iceServers.push[{
        'urls': [
            'turn:webrtcweb.com:4455?transport=udp', // restund udp
        ],
        'username': 'muazkh',
        'credential': 'muazkh'
    },
    {
        'urls': [
            'stun:stun.l.google.com:19302',
            'stun:stun.l.google.com:19302?transport=udp',
        ]
    }
    ];



    iceServers = [];
//    iceServers.push({
//        url: 'turn:turn.gruponw.com:3478'
//    });
//    iceServers.push({
//        url: 'turn:turn.gruponw.com:5349'
//    });
    iceServers.push({
        url: 'stun:turn.gruponw.com:3478',
        username: 'andresf',
        credential: 'padre08'
    });
    iceServers.push({
        url: 'turn:turn.gruponw.com:3478',
        username: 'andresf',
        credential: 'padre08'
    });
    iceServers.push({
        'url': 'turn:190.26.239.176:3478?transport=udp',
        'credential': 'padre08',
        'username': 'andresf'
    });
//    iceServers.push({
//        url: 'turn:turn.gruponw.com:5349',
//        username: 'andresf',
//        credential: 'padre08'
//    });
//    iceServers.push({
//        url: 'turn:190.26.239.176:3478',
//        username: 'andresf',
//        credential: 'padre08'
//    });
//    iceServers.push({
//        url: 'turn:190.26.239.176:5349',
//        username: 'andresf',
//        credential: 'padre08'
//    });
    console.log(iceServers);
    connection.iceServers = iceServers;

//    connection.iceServers = [{
//            'urls': [
//                'stun:stun.l.google.com:19302',
//                'stun:stun1.l.google.com:19302',
//                'stun:stun2.l.google.com:19302',
//                'stun:stun.l.google.com:19302?transport=udp',
//                {
//                    url: 'numb.viagenie.ca',
//                    username: 'orionjafe@gmail.com',
//                    credential: 'metallica'
//                }
//            ]
//        }];

    // first step, ignore default STUN+TURN servers
//    connection.iceServers = [];
//
//// second step, set STUN url
//    connection.iceServers.push({
//        urls: 'numb.viagenie.ca'
//    });
//
//// last step, set TURN url (recommended)
//    connection.iceServers.push({
//        urls: 'numb.viagenie.ca',
//        credential: 'orionjafe@gmail.com',
//        username: 'metallica'
//    });
//
//    connection.iceServers.push({
//        url: 'turn:turn.gruponw.com:3478',
//        username: 'andresf',
//        credential: 'padre08'
//    });
//    connection.iceServers.push({
//        url: 'turn:turn.gruponw.com:5349',
//        username: 'andresf',
//        credential: 'padre08'
//    });



    var room = get().room;
    connection.openOrJoin(room);
</script>
