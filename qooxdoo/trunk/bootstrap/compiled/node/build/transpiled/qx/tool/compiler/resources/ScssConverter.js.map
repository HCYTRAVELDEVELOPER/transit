{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "path",
    "require",
    "sass",
    "loadSass",
    "fs",
    "tool",
    "utils",
    "Promisify",
    "Class",
    "define",
    "extend",
    "compiler",
    "resources",
    "ResourceConverter",
    "construct",
    "members",
    "matches",
    "filename",
    "basename",
    "endsWith",
    "getDestFilename",
    "target",
    "asset",
    "ScssConverter",
    "isNewCompiler",
    "join",
    "getOutputDir",
    "getFilename",
    "replace",
    "convert",
    "srcFilename",
    "destFilename",
    "isThemeFile",
    "COPY_ORIGINAL_FILES",
    "copyFilename",
    "files",
    "Utils",
    "copyFile",
    "legacyMobileSassConvert",
    "scssFile",
    "ScssFile",
    "getLibrary",
    "setThemeFile",
    "compile",
    "qooxdooPath",
    "getAnalyser",
    "getQooxdooPath",
    "data",
    "readFileAsync",
    "trim",
    "writeFileAsync",
    "unlinkAsync",
    "sassOptions",
    "includePaths",
    "dirname",
    "outFile",
    "sourceMap",
    "outputStyle",
    "result",
    "call",
    "cb",
    "render",
    "err",
    "Error",
    "message",
    "css",
    "map",
    "statics",
    "USE_V6_COMPILER",
    "console",
    "warn"
  ],
  "sources": [
    "/home/andresf/workspace_qooxdoo/qooxdoo/qooxdoo-7.0/source/class/qx/tool/compiler/resources/ScssConverter.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n *\n *    qooxdoo-compiler - node.js based replacement for the Qooxdoo python\n *    toolchain\n *\n *    https://github.com/qooxdoo/qooxdoo\n *\n *    Copyright:\n *      2011-2017 Zenesis Limited, http://www.zenesis.com\n *\n *    License:\n *      MIT: https://opensource.org/licenses/MIT\n *\n *      This software is provided under the same licensing terms as Qooxdoo,\n *      please see the LICENSE file in the Qooxdoo project's top-level directory\n *      for details.\n *\n *    Authors:\n *      * Henner Kollmann (henner.kollmann@gmx.de)\n *\n *\n * *********************************************************************** */\n\nconst path = require(\"upath\");\n/**\n * @external(qx/tool/loadsass.js)\n * @ignore(loadSass)\n */\n/* global loadSass */\nconst sass = loadSass();\nconst fs = qx.tool.utils.Promisify.fs;\n\nqx.Class.define(\"qx.tool.compiler.resources.ScssConverter\", {\n  extend: qx.tool.compiler.resources.ResourceConverter,\n\n  construct() {\n    super();\n  },\n\n  members: {\n    matches(filename) {\n      filename = path.basename(filename);\n      return filename[0] != \"_\" && filename.endsWith(\".scss\");\n    },\n\n    getDestFilename(target, asset) {\n      let filename;\n      if (!qx.tool.compiler.resources.ScssConverter.isNewCompiler()) {\n        filename = path.join(\n          target.getOutputDir(),\n          \"resource\",\n          asset.getFilename().replace(/\\bscss\\b/g, \"css\")\n        );\n      } else {\n        filename = path.join(\n          target.getOutputDir(),\n          \"resource\",\n          asset.getFilename().replace(/\\.scss$/, \".css\")\n        );\n      }\n      return filename;\n    },\n\n    async convert(target, asset, srcFilename, destFilename, isThemeFile) {\n      if (qx.tool.compiler.resources.ScssConverter.COPY_ORIGINAL_FILES) {\n        let copyFilename = path.join(\n          target.getOutputDir(),\n          \"resource\",\n          asset.getFilename()\n        );\n\n        await qx.tool.utils.files.Utils.copyFile(srcFilename, copyFilename);\n      }\n\n      if (!qx.tool.compiler.resources.ScssConverter.isNewCompiler()) {\n        return this.legacyMobileSassConvert(\n          target,\n          asset,\n          srcFilename,\n          destFilename\n        );\n      }\n\n      let scssFile = new qx.tool.compiler.resources.ScssFile(\n        target,\n        asset.getLibrary(),\n        asset.getFilename()\n      );\n\n      scssFile.setThemeFile(isThemeFile);\n      return scssFile.compile(destFilename);\n    },\n\n    /**\n     * The traditional SASS compilation; it does not use the newer advanced SASS compiler and so\n     * does not support relative `url()` paths and automatically has Qooxdoo SASS built in.\n     */\n    async legacyMobileSassConvert(target, asset, srcFilename, destFilename) {\n      if (qx.tool.compiler.resources.ScssConverter.COPY_ORIGINAL_FILES) {\n        let copyFilename = path.join(\n          target.getOutputDir(),\n          \"resource\",\n          asset.getFilename()\n        );\n\n        await qx.tool.utils.files.Utils.copyFile(srcFilename, copyFilename);\n      }\n\n      let qooxdooPath = target.getAnalyser().getQooxdooPath();\n      let data = await fs.readFileAsync(srcFilename, \"utf8\");\n      if (!data || !data.trim()) {\n        await fs.writeFileAsync(destFilename, \"\");\n        await fs.unlinkAsync(destFilename + \".map\");\n      } else {\n        let sassOptions = {\n          data: data,\n          includePaths: [\n            path.dirname(srcFilename),\n            path.join(qooxdooPath, \"source/resource/qx/mobile/scss\"),\n            path.join(qooxdooPath, \"source/resource/qx/scss\")\n          ],\n\n          outFile: destFilename,\n          sourceMap: destFilename + \".map\",\n          outputStyle: \"compressed\"\n        };\n\n        let result = await qx.tool.utils.Promisify.call(cb =>\n          sass.render(sassOptions, (err, result) => {\n            if (err) {\n              cb(new Error(err.message));\n            } else {\n              cb(null, result);\n            }\n          })\n        );\n\n        await fs.writeFileAsync(destFilename, result.css);\n        await fs.writeFileAsync(destFilename + \".map\", result.map);\n      }\n    }\n  },\n\n  statics: {\n    /** @type {Boolean} Default is true for the API, the CLI will set this to null */\n    USE_V6_COMPILER: true,\n\n    /** @type {Boolean} Whether to copy .scss files */\n    COPY_ORIGINAL_FILES: false,\n\n    isNewCompiler() {\n      if (qx.tool.compiler.resources.ScssConverter.USE_V6_COMPILER === null) {\n        console.warn(\n          \"DEPRECATED: Using the Qooxdoo v5 style of SASS Compilation; this is backwards compatible \" +\n            \"but the default will change in v7 to use the new style (see https://git.io/JfTPV for details, and how \" +\n            \"to disable this warning).\"\n        );\n\n        qx.tool.compiler.resources.ScssConverter.USE_V6_COMPILER = false;\n      }\n      return qx.tool.compiler.resources.ScssConverter.USE_V6_COMPILER;\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}