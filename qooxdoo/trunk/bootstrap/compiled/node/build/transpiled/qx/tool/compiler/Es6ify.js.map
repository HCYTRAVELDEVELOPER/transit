{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "fs",
    "require",
    "babelCore",
    "types",
    "prettier",
    "collapseMemberExpression",
    "node",
    "done",
    "doCollapse",
    "type",
    "name",
    "result",
    "elements",
    "forEach",
    "element",
    "push",
    "isIdentifier",
    "object",
    "str",
    "property",
    "computed",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "construct",
    "filename",
    "__filename",
    "properties",
    "arrowFunctions",
    "init",
    "check",
    "nullable",
    "overwrite",
    "members",
    "transform",
    "src",
    "promises",
    "readFile",
    "babelConfig",
    "options",
    "lang",
    "clone",
    "modules",
    "plugins",
    "__pluginFunctionExpressions",
    "getArrowFunctions",
    "__pluginArrowFunctions",
    "__pluginRemoveUnnecessaryThis",
    "__pluginSwitchToSuper",
    "config",
    "ast",
    "babelrc",
    "sourceFileName",
    "sourceMaps",
    "presets",
    "parserOpts",
    "allowSuperOutsideMethod",
    "sourceType",
    "generatorOpts",
    "retainLines",
    "compact",
    "passPerPreset",
    "cycleCount",
    "tool",
    "compiler",
    "Console",
    "warn",
    "code",
    "prettierConfig",
    "resolveConfig",
    "editorConfig",
    "parser",
    "prettyCode",
    "format",
    "outname",
    "isOverwrite",
    "writeFile",
    "visitor",
    "ObjectExpression",
    "path",
    "KEY_TYPES",
    "Identifier",
    "StringLiteral",
    "NumericLiteral",
    "i",
    "length",
    "propNode",
    "value",
    "key",
    "replacement",
    "objectMethod",
    "params",
    "body",
    "generator",
    "async",
    "loc",
    "start",
    "end",
    "leadingComments",
    "__toArrowExpression",
    "argNode",
    "argument",
    "arrowFunctionExpression",
    "t",
    "isTest",
    "indexOf",
    "CallExpression",
    "callee",
    "endsWith",
    "arguments",
    "Array",
    "removeAt",
    "methodNameStack",
    "peekMethodName",
    "methodName",
    "ObjectMethod",
    "enter",
    "exit",
    "pop",
    "args",
    "shift",
    "super",
    "memberExpression",
    "identifier",
    "Es6ify"
  ],
  "sources": [
    "/home/andresf/workspace_qooxdoo/qooxdoo/qooxdoo-7.0/source/class/qx/tool/compiler/Es6ify.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2021 Zenesis Ltd\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * John Spackman (john.spackman@zenesis.com, @johnspackman)\n\n************************************************************************ */\n\nconst fs = require(\"fs\");\nconst babelCore = require(\"@babel/core\");\nconst types = require(\"@babel/types\");\nconst prettier = require(\"prettier\");\n\n/**\n * Helper method that collapses the MemberExpression into a string\n * @param node\n * @returns {string}\n */\nfunction collapseMemberExpression(node) {\n  var done = false;\n  function doCollapse(node) {\n    if (node.type == \"ThisExpression\") {\n      return \"this\";\n    }\n    if (node.type == \"Identifier\") {\n      return node.name;\n    }\n    if (node.type == \"ArrayExpression\") {\n      var result = [];\n      node.elements.forEach(element => result.push(doCollapse(element)));\n      return result;\n    }\n    if (node.type != \"MemberExpression\") {\n      return \"(\" + node.type + \")\";\n    }\n    if (types.isIdentifier(node.object)) {\n      let str = node.object.name;\n      if (node.property.name) {\n        str += \".\" + node.property.name;\n      } else {\n        done = true;\n      }\n      return str;\n    }\n    var str;\n    if (node.object.type == \"ArrayExpression\") {\n      str = \"[]\";\n    } else {\n      str = doCollapse(node.object);\n    }\n    if (done) {\n      return str;\n    }\n    // `computed` is set if the expression is a subscript, eg `abc[def]`\n    if (node.computed) {\n      done = true;\n    } else if (node.property.name) {\n      str += \".\" + node.property.name;\n    } else {\n      done = true;\n    }\n    return str;\n  }\n\n  return doCollapse(node);\n}\n\n/**\n * Processes a .js source file and tries to upgrade to ES6 syntax\n *\n * This is a reliable but fairly unintrusive upgrade, provided that `arrowFunctions` property is\n * `careful`.  The issue is that this code: `setTimeout(function() { something(); })` can be\n * changed to `setTimeout(() => something())` and that is often desirable, but it also means that\n * the `this` will be different because an arrow function always has the `this` from where the\n * code is written.\n *\n * However, if you use an API which changes `this` then the switch to arrow functions will break\n * your code.  Mostly, in Qooxdoo, changes to `this` are done via an explicit API (eg\n * `obj.addListener(\"changeXyx\", function() {}, this)`) and so those known APIs can be translated,\n * but there are places which do not work this way (eg the unit tests `qx.dev.unit.TestCase.resume()`).\n * Third party integrations are of course completely unknown.\n *\n * If `arrowFunctions` is set to aggressive, then all functions are switched to arrow functions except\n * where there is a known API that does not support it (eg any call to `.resume` in a test class); this\n * could break your code.\n *\n * If `arrowFunctions is set to `careful` (the default), then functions are only switched to arrow\n * functions where the API is known  (eg `.addListener`).\n *\n * The final step is that the ES6ify will use https://prettier.io/ to reformat the code, and will use\n * the nearest `prettierrc.json` for configuration\n */\nqx.Class.define(\"qx.tool.compiler.Es6ify\", {\n  extend: qx.core.Object,\n\n  construct(filename) {\n    super();\n    this.__filename = filename;\n  },\n\n  properties: {\n    /** Whether to convert functions to arrow functions; careful means only on things like addListener callbacks */\n    arrowFunctions: {\n      init: \"careful\",\n      check: [\"never\", \"always\", \"careful\", \"aggressive\"],\n      nullable: true\n    },\n\n    /** Whether to overwrite the original file */\n    overwrite: {\n      init: false,\n      check: \"Boolean\"\n    }\n  },\n\n  members: {\n    __filename: null,\n\n    async transform() {\n      let src = await fs.promises.readFile(this.__filename, \"utf8\");\n\n      let babelConfig = {};\n      let options = qx.lang.Object.clone(babelConfig.options || {}, true);\n      options.modules = false;\n      let plugins = [\n        require(\"@babel/plugin-syntax-jsx\"),\n        this.__pluginFunctionExpressions()\n      ];\n\n      if (this.getArrowFunctions() != \"never\") {\n        plugins.push(this.__pluginArrowFunctions());\n      }\n      plugins.push(this.__pluginRemoveUnnecessaryThis());\n      plugins.push(this.__pluginSwitchToSuper());\n      var config = {\n        ast: true,\n        babelrc: false,\n        sourceFileName: this.__filename,\n        filename: this.__filename,\n        sourceMaps: false,\n        presets: [\n          [\n            {\n              plugins: plugins\n            }\n          ]\n        ],\n\n        parserOpts: {\n          allowSuperOutsideMethod: true,\n          sourceType: \"script\"\n        },\n\n        generatorOpts: {\n          retainLines: true,\n          compact: false\n        },\n\n        passPerPreset: true\n      };\n\n      let result;\n      let cycleCount = 0;\n      while (true) {\n        cycleCount++;\n        if (cycleCount > 10) {\n          qx.tool.compiler.Console.warn(`Can not find a stable format for ${this.__filename}`);\n          break;\n        }\n        result = babelCore.transform(src, config);\n        if (result.code === src) {\n          break;\n        }\n        src = result.code;\n      }\n\n      let prettierConfig =\n        (await prettier.resolveConfig(this.__filename, {\n          editorConfig: true\n        })) || {};\n      prettierConfig.parser = \"babel\";\n      let prettyCode = prettier.format(result.code, prettierConfig);\n\n      let outname = this.__filename + (this.isOverwrite() ? \"\" : \".es6ify\");\n      await fs.promises.writeFile(outname, prettyCode, \"utf8\");\n    },\n\n    /**\n     * Plugin that converts object properties which are functions into object methods, eg\n     * ```\n     * {\n     *   myMethod: function() {}\n     * }\n     * ```\n     * becomes\n     * ```\n     * {\n     *   myMethod() {}\n     * }\n     * ```\n     * @returns\n     */\n    __pluginFunctionExpressions() {\n      return {\n        visitor: {\n          ObjectExpression(path) {\n            const KEY_TYPES = {\n              Identifier: 1,\n              StringLiteral: 1,\n              NumericLiteral: 1\n            };\n\n            for (let i = 0; i < path.node.properties.length; i++) {\n              let propNode = path.node.properties[i];\n              if (\n                propNode.type == \"ObjectProperty\" &&\n                propNode.value.type == \"FunctionExpression\" &&\n                KEY_TYPES[propNode.key.type]\n              ) {\n                let replacement = types.objectMethod(\n                  \"method\",\n                  propNode.key,\n                  propNode.value.params,\n                  propNode.value.body,\n                  propNode.value.computed,\n                  propNode.value.generator,\n                  propNode.value.async\n                );\n\n                replacement.loc = propNode.loc;\n                replacement.start = propNode.start;\n                replacement.end = propNode.end;\n                replacement.leadingComments = propNode.leadingComments;\n                path.node.properties[i] = replacement;\n              }\n            }\n          }\n        }\n      };\n    },\n\n    __toArrowExpression(argNode) {\n      let body = argNode.body;\n      if (body.body.length == 1 && body.body[0].type == \"ReturnStatement\") {\n        body = body.body[0].argument;\n      }\n      let replacement = types.arrowFunctionExpression(\n        argNode.params,\n        body,\n        argNode.async\n      );\n\n      replacement.loc = argNode.loc;\n      replacement.start = argNode.start;\n      replacement.end = argNode.end;\n      replacement.leadingComments = argNode.leadingComments;\n      return replacement;\n    },\n\n    /**\n     * Tries to convert functions into arrow functions\n     * @returns\n     */\n    __pluginArrowFunctions() {\n      let t = this;\n      const isTest = this.__filename.indexOf(\"/test/\") > -1;\n      let arrowFunctions = this.getArrowFunctions();\n\n      return {\n        visitor: {\n          CallExpression(path) {\n            if (path.node.callee.type == \"MemberExpression\") {\n              let callee = collapseMemberExpression(path.node.callee);\n              if (arrowFunctions == \"careful\") {\n                if (!callee.endsWith(\".addListener\")) {\n                  return;\n                }\n                if (\n                  path.node.arguments.length != 3 ||\n                  path.node.arguments[0].type != \"StringLiteral\" ||\n                  path.node.arguments[1].type != \"ArrowFunctionExpression\" ||\n                  path.node.arguments[2].type != \"ThisExpression\"\n                ) {\n                  return;\n                }\n              } else if (arrowFunctions == \"aggressive\") {\n                if (\n                  callee == \"qx.event.GlobalError.observeMethod\" ||\n                  callee == \"this.assertException\" ||\n                  callee == \"this.assertEventFired\" ||\n                  callee == \"qx.core.Assert.assertEventFired\" ||\n                  (isTest && callee.endsWith(\".resume\"))\n                ) {\n                  return;\n                }\n              }\n            } else if (arrowFunctions == \"careful\") {\n              return;\n            }\n            for (let i = 0; i < path.node.arguments.length; i++) {\n              let argNode = path.node.arguments[i];\n              if (argNode.type == \"FunctionExpression\") {\n                path.node.arguments[i] = t.__toArrowExpression(argNode);\n              }\n            }\n          }\n        }\n      };\n    },\n\n    /**\n     * Where a function has been translated into an arrow function, the this binding is not needed\n     * and can be removed\n     * @returns\n     */\n    __pluginRemoveUnnecessaryThis() {\n      return {\n        visitor: {\n          CallExpression(path) {\n            if (\n              path.node.callee.type == \"MemberExpression\" &&\n              path.node.callee.object.type == \"ThisExpression\" &&\n              path.node.callee.property.type == \"Identifier\" &&\n              path.node.callee.property.name == \"addListener\" &&\n              path.node.arguments.length == 3 &&\n              path.node.arguments[0].type == \"StringLiteral\" &&\n              path.node.arguments[1].type == \"ArrowFunctionExpression\" &&\n              path.node.arguments[2].type == \"ThisExpression\"\n            ) {\n              qx.lang.Array.removeAt(path.node.arguments, 2);\n            }\n          }\n        }\n      };\n    },\n\n    /**\n     * Translates `this.base(arguments...)` into `super`\n     * @returns\n     */\n    __pluginSwitchToSuper() {\n      let methodNameStack = [];\n      function peekMethodName() {\n        for (let i = methodNameStack.length - 1; i >= 0; i--) {\n          let methodName = methodNameStack[i];\n          if (methodName) {\n            return methodName;\n          }\n        }\n        return null;\n      }\n      return {\n        visitor: {\n          ObjectMethod: {\n            enter(path) {\n              methodNameStack.push(path.node.key.name || null);\n            },\n            exit(path) {\n              methodNameStack.pop();\n            }\n          },\n\n          CallExpression(path) {\n            if (\n              path.node.callee.type == \"MemberExpression\" &&\n              path.node.callee.object.type == \"ThisExpression\" &&\n              path.node.callee.property.type == \"Identifier\" &&\n              path.node.callee.property.name == \"base\" &&\n              path.node.arguments.length >= 1\n            ) {\n              let args = qx.lang.Array.clone(path.node.arguments);\n              args.shift();\n              let methodName = peekMethodName();\n              if (methodName == \"construct\") {\n                path.node.callee = types.super();\n                path.node.arguments = args;\n              } else if (methodName) {\n                let replacement = types.memberExpression(\n                  types.super(),\n                  types.identifier(methodName),\n                  false,\n                  false\n                );\n\n                path.node.callee = replacement;\n                path.node.arguments = args;\n              }\n            }\n          }\n        }\n      };\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}