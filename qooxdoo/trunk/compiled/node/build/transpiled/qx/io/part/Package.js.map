{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "define",
    "construct",
    "urls",
    "id",
    "loaded",
    "__readyState",
    "__urls",
    "__id",
    "members",
    "__closure",
    "__loadWithClosure",
    "__timeoutId",
    "__notifyPackageResult",
    "getId",
    "getReadyState",
    "getUrls",
    "saveClosure",
    "closure",
    "execute",
    "clearTimeout",
    "$$packageData",
    "__importPackageData",
    "loadClosure",
    "notifyPackageResult",
    "self",
    "bind",
    "__loadScriptList",
    "call",
    "pkg",
    "setTimeout",
    "Part",
    "TIMEOUT",
    "load",
    "urlList",
    "callback",
    "errBack",
    "length",
    "urlsLoaded",
    "loadScripts",
    "loader",
    "bom",
    "request",
    "Script",
    "open",
    "shift",
    "onload",
    "dispose",
    "client",
    "Engine",
    "getName",
    "onerror",
    "window",
    "send",
    "concat",
    "$$loader",
    "importPackageData",
    "io",
    "part",
    "Package"
  ],
  "sources": [
    "/home/andresf/workspace_qooxdoo/qooxdoo/qooxdoo-7.0/source/class/qx/io/part/Package.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2009 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Fabian Jakobs (fjakobs)\n     * Martin Wittemann (martinwittemann)\n\n************************************************************************ */\n\n/**\n * The Package wraps a list of related script URLs, which are required by one\n * or more parts.\n *\n * @internal\n * @ignore(qx.util.ResourceManager)\n */\nqx.Bootstrap.define(\"qx.io.part.Package\", {\n  /**\n   * @param urls {String[]} A list of script URLs\n   * @param id {var} Unique package hash key\n   * @param loaded {Boolean?false} Whether the package is already loaded\n   */\n  construct(urls, id, loaded) {\n    this.__readyState = loaded ? \"complete\" : \"initialized\";\n    this.__urls = urls;\n    this.__id = id;\n  },\n\n  members: {\n    __readyState: null,\n    __urls: null,\n    __id: null,\n    __closure: null,\n    __loadWithClosure: null,\n    __timeoutId: null,\n    __notifyPackageResult: null,\n\n    /**\n     * Get the package ID.\n     *\n     * @return {String} The package id\n     */\n    getId() {\n      return this.__id;\n    },\n\n    /**\n     * Get the ready state of the package. The value is one of\n     * <ul>\n     * <li>\n     *   <b>initialized</b>: The package is initialized. The {@link #load}\n     *   method has not yet been called\n     * </li>\n     * <li><b>loading</b>: The package is still loading.</li>\n     * <li><b>complete</b>: The package has been loaded successfully</li>\n     * <li><b>cached</b>: The package is loaded but is not executed\n     *   (for closure parts)</li>\n     * </li>\n     *\n     * @return {String} The ready state.\n     */\n    getReadyState() {\n      return this.__readyState;\n    },\n\n    /**\n     * Returns the urlsstored stored in the package.\n     *\n     * @internal\n     * @return {String[]} An array of urls of this package.\n     */\n    getUrls() {\n      return this.__urls;\n    },\n\n    /**\n     * Method for storing the closure for this package. This is only relevant\n     * if a {@link qx.io.part.ClosurePart} is used.\n     *\n     * @param closure {Function} The code of this package wrapped in a closure.\n     */\n    saveClosure(closure) {\n      if (this.__readyState == \"error\") {\n        return;\n      }\n\n      this.__closure = closure;\n\n      if (!this.__loadWithClosure) {\n        this.execute();\n      } else {\n        clearTimeout(this.__timeoutId);\n        this.__readyState = \"cached\";\n        this.__notifyPackageResult(this);\n      }\n    },\n\n    /**\n     * Executes the stored closure. This is only relevant if a\n     * {@link qx.io.part.ClosurePart} is used.\n     */\n    execute() {\n      if (this.__closure) {\n        this.__closure();\n        delete this.__closure;\n      }\n\n      if (qx.$$packageData[this.__id]) {\n        this.__importPackageData(qx.$$packageData[this.__id]);\n        delete qx.$$packageData[this.__id];\n      }\n      this.__readyState = \"complete\";\n    },\n\n    /**\n     * Load method if the package loads a closure. This is only relevant if a\n     * {@link qx.io.part.ClosurePart} is used.\n     *\n     * @param notifyPackageResult {Function} The callback if all scripts are\n     *   done loading in this package.\n     * @param self {Object?} The context of the callback.\n     */\n    loadClosure(notifyPackageResult, self) {\n      if (this.__readyState !== \"initialized\") {\n        return;\n      }\n\n      this.__loadWithClosure = true;\n\n      this.__readyState = \"loading\";\n\n      this.__notifyPackageResult = qx.Bootstrap.bind(notifyPackageResult, self);\n\n      this.__loadScriptList(\n        this.__urls,\n        function () {},\n        function () {\n          this.__readyState = \"error\";\n          notifyPackageResult.call(self, this);\n        },\n        this\n      );\n\n      var pkg = this;\n      this.__timeoutId = setTimeout(function () {\n        pkg.__readyState = \"error\";\n        notifyPackageResult.call(self, pkg);\n      }, qx.Part.TIMEOUT);\n    },\n\n    /**\n     * Load the part's script URLs in the correct order.\n     *\n     * @param notifyPackageResult {Function} The callback if all scripts are\n     *   done loading in this package.\n     * @param self {Object?} The context of the callback.\n     */\n    load(notifyPackageResult, self) {\n      if (this.__readyState !== \"initialized\") {\n        return;\n      }\n\n      this.__loadWithClosure = false;\n\n      this.__readyState = \"loading\";\n\n      this.__loadScriptList(\n        this.__urls,\n        function () {\n          this.__readyState = \"complete\";\n          this.execute();\n          notifyPackageResult.call(self, this);\n        },\n        function () {\n          this.__readyState = \"error\";\n          notifyPackageResult.call(self, this);\n        },\n        this\n      );\n    },\n\n    /**\n     * Loads a list of scripts in the correct order.\n     *\n     * @param urlList {String[]} List of script urls\n     * @param callback {Function} Function to execute on completion\n     * @param errBack {Function} Function to execute on error\n     * @param self {Object?window} Context to execute the given function in\n     */\n    __loadScriptList(urlList, callback, errBack, self) {\n      if (urlList.length == 0) {\n        callback.call(self);\n        return;\n      }\n\n      var urlsLoaded = 0;\n      var self = this;\n      var loadScripts = function (urls) {\n        if (urlsLoaded >= urlList.length) {\n          callback.call(self);\n          return;\n        }\n\n        var loader = new qx.bom.request.Script();\n        loader.open(\"GET\", urls.shift());\n\n        loader.onload = function () {\n          urlsLoaded += 1;\n          loader.dispose();\n\n          // Important to use engine detection directly to keep the minimal\n          // package size small [BUG #5068]\n          if (qx.bom.client.Engine.getName() == \"webkit\") {\n            // force asynchronous load\n            // Safari fails with an \"maximum recursion depth exceeded\" error if it is\n            // called sync.\n            setTimeout(function () {\n              loadScripts.call(self, urls, callback, self);\n            }, 0);\n          } else {\n            loadScripts.call(self, urls, callback, self);\n          }\n        };\n\n        loader.onerror = function () {\n          if (self.__readyState == \"loading\") {\n            clearTimeout(self.__timeoutId);\n            loader.dispose();\n            return errBack.call(self);\n          }\n        };\n\n        // Force loading script asynchronously (IE may load synchronously)\n        window.setTimeout(function () {\n          loader.send();\n        });\n      };\n\n      loadScripts(urlList.concat());\n    },\n\n    /**\n     * Import the data of a package. The function is defined in the loader\n     * script.\n     *\n     * @signature function(packageData)\n     * @param packageData {Map} Map of package data categories (\"resources\",...)\n     */\n    __importPackageData: qx.$$loader.importPackageData\n  }\n});\n"
  ],
  "mappings": "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"
}