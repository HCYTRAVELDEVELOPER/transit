{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "construct",
    "target",
    "application",
    "__target",
    "__application",
    "__libraries",
    "__preload",
    "urisBefore",
    "cssBefore",
    "__preBootCode",
    "__resources",
    "__packages",
    "__parts",
    "__partsLookup",
    "properties",
    "environment",
    "addTimestampsToUrls",
    "init",
    "check",
    "appLibrary",
    "bootMetaJs",
    "sourceUri",
    "resourceUri",
    "members",
    "setEnvironmentValue",
    "key",
    "value",
    "env",
    "getEnvironment",
    "undefined",
    "getEnvironmentValue",
    "defaultValue",
    "getApplication",
    "getTarget",
    "getApplicationRoot",
    "getAnalyser",
    "syncAssets",
    "i",
    "length",
    "pkg",
    "tool",
    "utils",
    "Promisify",
    "poolEachOf",
    "getAssets",
    "asset",
    "sync",
    "addLibrary",
    "library",
    "push",
    "getAppLibrary",
    "getLibraryFromClassname",
    "getClassName",
    "getLibraries",
    "addExternal",
    "type",
    "uri",
    "addPreload",
    "getPreloads",
    "addPreBootCode",
    "code",
    "getPreBootCode",
    "join",
    "createPart",
    "name",
    "part",
    "compiler",
    "targets",
    "meta",
    "Part",
    "getParts",
    "getPart",
    "getPackages",
    "createPackage",
    "Package",
    "getLocalePackage",
    "localeId",
    "addPackage",
    "getDefaultPackage",
    "addResource",
    "path",
    "getResources",
    "ApplicationMeta"
  ],
  "sources": [
    "/home/andresf/workspace_qooxdoo/qooxdoo/qooxdoo-7.0/source/class/qx/tool/compiler/targets/meta/ApplicationMeta.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n *\n *    qooxdoo-compiler - node.js based replacement for the Qooxdoo python\n *    toolchain\n *\n *    https://github.com/qooxdoo/qooxdoo-compiler\n *\n *    Copyright:\n *      2011-2021 Zenesis Limited, http://www.zenesis.com\n *\n *    License:\n *      MIT: https://opensource.org/licenses/MIT\n *\n *      This software is provided under the same licensing terms as Qooxdoo,\n *      please see the LICENSE file in the Qooxdoo project's top-level directory\n *      for details.\n *\n *    Authors:\n *      * John Spackman (john.spackman@zenesis.com, @johnspackman)\n *\n * ************************************************************************/\n\n/**\n * ApplicationMeta collects all the data about an application being compiled by a target,\n * in a form easily navigated and well documented.\n *\n * It provides an abstraction where the target can choose to restructure and reorganise the\n * output as it progresses - for example, a target may start by assembling a number of\n * javascript files, and then bundle them together, effectively replacing several files\n * with just one intermediate file; the target can then replace the intermediate file with\n * a minified file etc.\n */\nqx.Class.define(\"qx.tool.compiler.targets.meta.ApplicationMeta\", {\n  extend: qx.core.Object,\n\n  construct(target, application) {\n    super();\n    this.__target = target;\n    this.__application = application;\n    this.__libraries = [];\n    this.__preload = {\n      urisBefore: [],\n      cssBefore: []\n    };\n\n    this.__preBootCode = [];\n    this.__resources = {};\n    this.__packages = [];\n    this.__parts = [];\n    this.__partsLookup = {};\n  },\n\n  properties: {\n    /** The environment for the build */\n    environment: {\n      // Any object\n    },\n\n    /**\n     * Whether to add timestamps to all URLs (cache busting)\n     */\n    addTimestampsToUrls: {\n      init: true,\n      check: \"Boolean\"\n    },\n\n    appLibrary: {\n      check: \"qx.tool.compiler.app.Library\"\n    },\n\n    bootMetaJs: {\n      check: \"qx.tool.compiler.targets.meta.AbstractJavascriptMeta\"\n    },\n\n    sourceUri: {\n      check: \"String\"\n    },\n\n    resourceUri: {\n      check: \"String\"\n    }\n  },\n\n  members: {\n    /** {qx.tool.compiler.targets.Target} the target */\n    __target: null,\n\n    /** {qx.tool.compiler.app.Application} the application */\n    __application: null,\n\n    /** {qx.tool.compiler.app.Libary[]} the libraries */\n    __libraries: null,\n\n    /** {Map} uris and CSS to load */\n    __preload: null,\n\n    /** {String[]} code to run before boot */\n    __preBootCode: null,\n\n    /** {Map} list of resource paths, indexed by resource id */\n    __resources: null,\n\n    /** {Package[]} list of packages */\n    __packages: null,\n\n    /** {Part[]} list of parts */\n    __parts: null,\n\n    /**\n     * Sets an environment variable\n     *\n     * @param key {String} the name of the variable\n     * @param value {Object} the value\n     */\n    setEnvironmentValue(key, value) {\n      let env = this.getEnvironment();\n      if (value === undefined) {\n        delete env[key];\n      } else {\n        env[key] = value;\n      }\n    },\n\n    /**\n     * Returns an environment value\n     *\n     * @param key {String} the key to lookup\n     * @param defaultValue {Object?} optional default value to use if the key is not found\n     * @return {Object} the value, or undefined if not found\n     */\n    getEnvironmentValue(key, defaultValue) {\n      let env = this.getEnvironment();\n      let value = env[key];\n      if (value === undefined) {\n        if (defaultValue !== undefined) {\n          env[key] = defaultValue;\n        }\n        value = defaultValue;\n      }\n      return value;\n    },\n\n    /**\n     * Returns the application\n     *\n     * @return {qx.tool.compiler.app.Application}\n     */\n    getApplication() {\n      return this.__application;\n    },\n\n    /**\n     * Returns the target\n     *\n     * @return {qx.tool.compiler.targets.Target}\n     */\n    getTarget() {\n      return this.__target;\n    },\n\n    /**\n     * Returns the application root\n     *\n     * @return {String} the folder\n     */\n    getApplicationRoot() {\n      return this.__target.getApplicationRoot(this.__application);\n    },\n\n    /**\n     * Returns the Analyser\n     *\n     * @return {qx.tool.compiler.Analyser}\n     */\n    getAnalyser() {\n      return this.__application.getAnalyser();\n    },\n\n    /**\n     * Syncs all assets into the output directory\n     */\n    async syncAssets() {\n      for (let i = 0; i < this.__packages.length; i++) {\n        let pkg = this.__packages[i];\n        await qx.tool.utils.Promisify.poolEachOf(pkg.getAssets(), 10, asset =>\n          asset.sync(this.__target)\n        );\n      }\n    },\n\n    /**\n     * Adds a library\n     *\n     * @param library {qx.tool.compiler.app.Library}\n     */\n    addLibrary(library) {\n      this.__libraries.push(library);\n    },\n\n    /**\n     * Returns the library that contains the application class\n     *\n     * @return {qx.tool.compiler.app.Library}\n     */\n    getAppLibrary() {\n      let appLibrary = this.__application\n        .getAnalyser()\n        .getLibraryFromClassname(this.__application.getClassName());\n      return appLibrary;\n    },\n\n    /**\n     * Returns the list of libraries\n     *\n     * @return {qx.tool.compiler.app.Library[]}\n     */\n    getLibraries() {\n      return this.__libraries;\n    },\n\n    /**\n     * Adds an external resource (JS or CSS) to be loaded which is a http[s] URL\n     *\n     * @param type {String} either \"urisBefore\" or \"cssBefore\"\n     * @param uri {String} uri to load\n     */\n    addExternal(type, uri) {\n      this.__preload[type].push(\"__external__:\" + uri);\n    },\n\n    /**\n     * Adds an external resource (JS or CSS) to be loaded, which is a resource path\n     *\n     * @param type {String} either \"urisBefore\" or \"cssBefore\"\n     * @param uri {String} uri to load\n     */\n    addPreload(type, uri) {\n      this.__preload[type].push(uri);\n    },\n\n    /**\n     * Returns the list of preloads, which is a map by type\n     *\n     * @return {Map}\n     */\n    getPreloads() {\n      return this.__preload;\n    },\n\n    /**\n     * Adds code to be run before the boot code is run\n     *\n     * @param code {String} the code to run\n     */\n    addPreBootCode(code) {\n      this.__preBootCode.push(code);\n    },\n\n    /**\n     * Returns the code to be run before the boot code\n     *\n     * @return {String} the code\n     */\n    getPreBootCode() {\n      return this.__preBootCode.join(\"\\n\");\n    },\n\n    /**\n     * Creates a new Part and adds it\n     *\n     * @param name {String} identifier\n     * @return {Part}\n     */\n    createPart(name) {\n      let part = new qx.tool.compiler.targets.meta.Part(\n        this.getTarget(),\n        name,\n        this.__parts.length\n      );\n\n      this.__parts.push(part);\n      this.__partsLookup[name] = part;\n      return part;\n    },\n\n    /**\n     * Returns a list of all parts\n     *\n     * @return {Part[]}\n     */\n    getParts() {\n      return this.__parts;\n    },\n\n    /**\n     * Returns a part with a given name\n     *\n     * @param name {String} the name to look for\n     */\n    getPart(name) {\n      return this.__partsLookup[name] || null;\n    },\n\n    /**\n     * Returns a list of all packages\n     *\n     * @return {Package[]}\n     */\n    getPackages() {\n      return this.__packages;\n    },\n\n    /**\n     * Creates a package and adds it\n     *\n     * @return {Package}\n     */\n    createPackage() {\n      let pkg = new qx.tool.compiler.targets.meta.Package(\n        this,\n        this.__packages.length\n      );\n\n      this.__packages.push(pkg);\n      return pkg;\n    },\n\n    /**\n     * Gets a package for specific locale, creating a part with the name set to the localeId\n     * if there isn't one already.  Used for when i18nAsParts == true\n     *\n     * @param localeId {String} the locale to look for\n     * @return {Package}\n     */\n    getLocalePackage(localeId) {\n      let part = this.getPart(localeId);\n      if (!part) {\n        part = this.createPart(localeId);\n        part.addPackage(this.createPackage());\n      }\n      let pkg = part.getDefaultPackage();\n      return pkg;\n    },\n\n    /**\n     * Adds a resource\n     *\n     * @param key {String} the resource identifier\n     * @param path {String} the path to the resource\n     */\n    addResource(key, path) {\n      this.__resources[key] = path;\n    },\n\n    /**\n     * Returns all of the resources\n     *\n     * @return {Map}\n     */\n    getResources() {\n      return this.__resources;\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}