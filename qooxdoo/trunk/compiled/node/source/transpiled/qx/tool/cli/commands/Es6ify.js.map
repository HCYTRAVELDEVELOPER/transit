{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "fs",
    "require",
    "path",
    "ignore",
    "Class",
    "define",
    "extend",
    "tool",
    "cli",
    "commands",
    "Command",
    "statics",
    "getYargsCommand",
    "command",
    "describe",
    "builder",
    "verbose",
    "alias",
    "overwrite",
    "type",
    "default",
    "exclude",
    "arrowFunctions",
    "choices",
    "members",
    "process",
    "ignoreFileName",
    "ig",
    "add",
    "promises",
    "readFile",
    "toString",
    "err",
    "code",
    "argv",
    "lang",
    "Type",
    "isArray",
    "processFile",
    "filename",
    "ignores",
    "compiler",
    "Console",
    "info",
    "ify",
    "Es6ify",
    "set",
    "transform",
    "scanImpl",
    "basename",
    "stat",
    "isFile",
    "match",
    "isDirectory",
    "files",
    "readdir",
    "i",
    "length",
    "subname",
    "join",
    "push",
    "file"
  ],
  "sources": [
    "/home/andresf/workspace_qooxdoo/qooxdoo/qooxdoo-7.0/source/class/qx/tool/cli/commands/Es6ify.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2021 Zenesis Ltd\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * John Spackman (john.spackman@zenesis.com, @johnspackman)\n\n************************************************************************ */\n\nconst fs = require(\"fs\");\nconst path = require(\"upath\");\nconst ignore = require(\"ignore\");\n\n/**\n * Migrates code to ES6 (partially)\n */\nqx.Class.define(\"qx.tool.cli.commands.Es6ify\", {\n  extend: qx.tool.cli.commands.Command,\n  statics: {\n    getYargsCommand() {\n      return {\n        command: \"es6ify [files...]\",\n        describe: \"help migrate code to ES6\",\n        builder: {\n          verbose: {\n            alias: \"v\",\n            describe: \"Verbose logging\"\n          },\n\n          overwrite: {\n            type: \"boolean\",\n            default: true,\n            describe: \"Overwrite source files\"\n          },\n\n          exclude: {\n            type: \"array\",\n            describe: \"Paths to exclude\"\n          },\n\n          arrowFunctions: {\n            choices: [\"never\", \"always\", \"careful\", \"aggressive\"],\n            default: \"careful\"\n          }\n        }\n      };\n    }\n  },\n\n  members: {\n    async process() {\n      await super.process();\n      const ignoreFileName = \".prettierignore\";\n      const ig = ignore();\n      try {\n        ig.add((await fs.promises.readFile(ignoreFileName)).toString());\n      } catch (err) {\n        if (err.code !== \"ENOENT\") {\n          throw err;\n        }\n      }\n      let exclude = this.argv.exclude;\n      if (exclude) {\n        if (!qx.lang.Type.isArray(exclude)) {\n          exclude = [exclude];\n        }\n        ig.add(exclude);\n      }\n\n      const processFile = async filename => {\n        if (ig.ignores(filename)) {\n          return;\n        }\n        qx.tool.compiler.Console.info(`Processing ${filename}...`);\n        let ify = new qx.tool.compiler.Es6ify(filename);\n        ify.set({\n          arrowFunctions: this.argv.arrowFunctions,\n          overwrite: this.argv.overwrite\n        });\n\n        await ify.transform();\n      };\n\n      const scanImpl = async filename => {\n        let basename = path.basename(filename);\n        let stat = await fs.promises.stat(filename);\n        if (stat.isFile() && basename.match(/\\.js$/)) {\n          await processFile(filename);\n        } else if (\n          stat.isDirectory() &&\n          (basename == \".\" || basename[0] != \".\")\n        ) {\n          let files = await fs.promises.readdir(filename);\n          for (let i = 0; i < files.length; i++) {\n            let subname = path.join(filename, files[i]);\n            await scanImpl(subname);\n          }\n        }\n      };\n      let files = this.argv.files || [];\n      if (files.length === 0) {\n        files.push(\"source\");\n      }\n      for await (let file of files) {\n        await scanImpl(file);\n      }\n    }\n  }\n});\n"
  ],
  "mappings": "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"
}