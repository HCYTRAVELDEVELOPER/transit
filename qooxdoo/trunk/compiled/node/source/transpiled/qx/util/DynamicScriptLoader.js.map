{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "extend",
    "core",
    "Object",
    "construct",
    "scriptArr",
    "__started",
    "__QUEUE",
    "lang",
    "Type",
    "isString",
    "Array",
    "clone",
    "events",
    "loaded",
    "failed",
    "ready",
    "statics",
    "__IN_PROGRESS",
    "__LOADED",
    "members",
    "start",
    "Environment",
    "select",
    "true",
    "Promise",
    "resolve",
    "reject",
    "addListenerOnce",
    "e",
    "Error",
    "getData",
    "isDisposed",
    "__loadScripts",
    "false",
    "DynamicScriptLoader",
    "util",
    "script",
    "dynLoader",
    "id1",
    "id2",
    "uri",
    "loader",
    "shift",
    "fireEvent",
    "fireDataEvent",
    "status",
    "addListener",
    "data",
    "removeListenerById",
    "ResourceManager",
    "getInstance",
    "toUri",
    "bom",
    "request",
    "Script",
    "on",
    "onError",
    "open",
    "send",
    "destruct",
    "key",
    "undefined"
  ],
  "sources": [
    "/home/andresf/workspace_qooxdoo/qooxdoo/qooxdoo-7.0/source/class/qx/util/DynamicScriptLoader.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2016 Visionet GmbH, http://www.visionet.de\n     2016 OETIKER+PARTNER AG, https://www.oetiker.ch\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Dietrich Streifert (level420)\n     * Tobias Oetiker (oetiker)\n\n************************************************************************ */\n\n/**\n * Dynamically load non qx scripts. This class is aware of all scripts that have\n * been loaded using its instances, so if two instances load jquery, it will only\n * be loaded once, and the second instance will wait for the jquery to be loaded\n * before continuing to load additional scripts.\n *\n * Usage example:\n *\n * <pre>\n *  ... assets ...\n * /**\n *  * @asset(myapp/jquery/*)\n *  * @asset(myapp/highcharts/*)\n *  *\n *  * @ignore(jQuery.*)\n *  * @ignore(Highcharts.*)\n *  ...\n *\n *\n *    // in debug mode load the uncompressed unobfuscated scripts\n *    var src = '';\n *    var min = '.min';\n *    if (qx.core.Environment.get(\"qx.debug\")) {\n *      src = '.src';\n *      min = '';\n *    }\n *\n *    // initialize the script loading\n *    var dynLoader = new qx.util.DynamicScriptLoader([\n *        \"myapp/jquery/jquery\"+min+\".js\",\n *        \"myapp/highcharts/highcharts\"+src+\".js\",\n *        \"myapp/highcharts/highcharts-more\"+src+\".js\",\n *        \"myapp/highcharts/highcharts-modifications.js\"\n *    ]);\n *\n *\n *    dynLoader.addListenerOnce('ready',function(e){\n *      console.log(\"all scripts have been loaded!\");\n *    });\n *\n *    dynLoader.addListener('failed',function(e){\n *      var data = e.getData();\n *      console.log(\"failed to load \"+data.script);\n *    });\n *\n *    dynLoader.start();\n *\n * </pre>\n */\nqx.Class.define(\"qx.util.DynamicScriptLoader\", {\n  extend: qx.core.Object,\n\n  /**\n   * Create a loader for the given scripts.\n   *\n   * @param scriptArr {Array|String} the uri name(s) of the script(s) to load\n   */\n\n  construct(scriptArr) {\n    super();\n    this.__started = false;\n    this.__QUEUE = qx.lang.Type.isString(scriptArr)\n      ? [scriptArr]\n      : qx.lang.Array.clone(scriptArr);\n  },\n\n  /*\n  *****************************************************************************\n     EVENTS\n  *****************************************************************************\n  */\n\n  events: {\n    /**\n     * fired when a script is loaded successfully. The data contains 'script' and 'status' keys.\n     */\n    loaded: \"qx.event.type.Data\",\n\n    /**\n     * fired when a specific script fails loading.  The data contains 'script' and 'status' keys.\n     */\n    failed: \"qx.event.type.Data\",\n\n    /**\n     * fired when all given scripts are loaded, each time loadScriptsDynamic is called.\n     */\n    ready: \"qx.event.type.Event\"\n  },\n\n  statics: {\n    /**\n     * Map of scripts being added at the present time. Key is script name; value is instance of this class which\n     * is loading it.\n     */\n    __IN_PROGRESS: {},\n    /**\n     * Map of scripts that have fully loaded. Key is script name; value is true\n     */\n    __LOADED: {}\n  },\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n\n  members: {\n    /**\n     * Array of the scripts to be loaded\n     */\n    __QUEUE: null,\n\n    /**\n     * True if start has been called.\n     */\n    __started: null,\n\n    /**\n     * Start loading scripts. This may only be called once!\n     * @return {Promise?} a promise which will be resolved after load of all scripts if promise support is enabled; nothing (undefined) if promises are not enabled.\n     */\n    start: qx.core.Environment.select(\"qx.promise\", {\n      true() {\n        return new qx.Promise(function (resolve, reject) {\n          this.addListenerOnce(\"ready\", resolve, this);\n          this.addListenerOnce(\n            \"failed\",\n            function (e) {\n              reject(new Error(e.getData()));\n            },\n            this\n          );\n\n          if (this.isDisposed()) {\n            reject(new Error(\"disposed\"));\n          }\n          if (this.__started) {\n            reject(new Error(\"you can only call start once per instance\"));\n          }\n          this.__started = true;\n          this.__loadScripts();\n        }, this);\n      },\n      false() {\n        if (this.isDisposed()) {\n          return;\n        }\n        if (this.__started) {\n          throw new Error(\"you can only call start once per instance\");\n        }\n        this.__started = true;\n        this.__loadScripts();\n      }\n    }),\n\n    /**\n     * Chain loading scripts.\n     *\n     * Recursively called until the array of scripts is consumed\n     *\n     */\n    __loadScripts() {\n      var DynamicScriptLoader = qx.util.DynamicScriptLoader;\n      var script;\n      var dynLoader;\n      var id1, id2;\n      var uri;\n      var loader;\n\n      script = this.__QUEUE.shift();\n      if (!script) {\n        this.fireEvent(\"ready\");\n        return;\n      }\n\n      if (DynamicScriptLoader.__LOADED[script]) {\n        this.fireDataEvent(\"loaded\", {\n          script: script,\n          status: \"preloaded\"\n        });\n\n        this.__loadScripts();\n        return;\n      }\n\n      dynLoader = DynamicScriptLoader.__IN_PROGRESS[script];\n      if (dynLoader) {\n        id1 = dynLoader.addListener(\n          \"loaded\",\n          function (e) {\n            if (this.isDisposed()) {\n              return;\n            }\n            var data = e.getData();\n            if (data.script === script) {\n              dynLoader.removeListenerById(id2);\n              dynLoader.removeListenerById(id1);\n              this.fireDataEvent(\"loaded\", data);\n              this.__loadScripts();\n            }\n          },\n          this\n        );\n\n        id2 = dynLoader.addListener(\n          \"failed\",\n          function (e) {\n            if (this.isDisposed()) {\n              return;\n            }\n            var data = e.getData();\n            dynLoader.removeListenerById(id1);\n            dynLoader.removeListenerById(id2);\n            this.fireDataEvent(\"failed\", {\n              script: script,\n              status:\n                \"loading of \" +\n                data.script +\n                \" failed while waiting for \" +\n                script\n            });\n          },\n          this\n        );\n\n        return;\n      }\n\n      uri = qx.util.ResourceManager.getInstance().toUri(script);\n\n      loader = new qx.bom.request.Script();\n\n      loader.on(\n        \"load\",\n        function (request) {\n          if (this.isDisposed()) {\n            return;\n          }\n          DynamicScriptLoader.__LOADED[script] = true;\n          delete DynamicScriptLoader.__IN_PROGRESS[script];\n          this.fireDataEvent(\"loaded\", {\n            script: script,\n            status: request.status\n          });\n\n          this.__loadScripts();\n        },\n        this\n      );\n\n      var onError = function (request) {\n        if (this.isDisposed()) {\n          return;\n        }\n        delete DynamicScriptLoader.__IN_PROGRESS[script];\n        this.fireDataEvent(\"failed\", {\n          script: script,\n          status: request.status\n        });\n      };\n\n      loader.on(\"error\", onError, this);\n      loader.on(\"timeout\", onError, this);\n\n      // this.debug(\"Loading \" + script + \" started\");\n      loader.open(\"GET\", uri);\n      DynamicScriptLoader.__IN_PROGRESS[script] = this;\n      loader.send();\n    }\n  },\n\n  destruct() {\n    var DynamicScriptLoader = qx.util.DynamicScriptLoader;\n    for (var key in DynamicScriptLoader.__IN_PROGRESS) {\n      if (DynamicScriptLoader.__IN_PROGRESS[key] === this) {\n        delete DynamicScriptLoader.__IN_PROGRESS[key];\n      }\n    }\n    this.__QUEUE = undefined;\n  }\n});\n"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;EAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACAH,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,6BAAhB,EAA+C;IAC7CC,MAAM,EAAEN,EAAE,CAACO,IAAH,CAAQC,MAD6B;;IAG7C;AACF;AACA;AACA;AACA;IAEEC,SAAS,CAACC,SAAD,EAAY;MACnB;MACA,KAAKC,kBAAL,GAAiB,KAAjB;MACA,KAAKC,gBAAL,GAAeZ,EAAE,CAACa,IAAH,CAAQC,IAAR,CAAaC,QAAb,CAAsBL,SAAtB,IACX,CAACA,SAAD,CADW,GAEXV,EAAE,CAACa,IAAH,CAAQG,KAAR,CAAcC,KAAd,CAAoBP,SAApB,CAFJ;IAGD,CAf4C;;IAiB7C;AACF;AACA;AACA;AACA;IAEEQ,MAAM,EAAE;MACN;AACJ;AACA;MACIC,MAAM,EAAE,oBAJF;;MAMN;AACJ;AACA;MACIC,MAAM,EAAE,oBATF;;MAWN;AACJ;AACA;MACIC,KAAK,EAAE;IAdD,CAvBqC;IAwC7CC,OAAO,EAAE;MACP;AACJ;AACA;AACA;MACIC,sBAAa,EAAE,EALR;;MAMP;AACJ;AACA;MACIC,iBAAQ,EAAE;IATH,CAxCoC;;IAoD7C;AACF;AACA;AACA;AACA;IAEEC,OAAO,EAAE;MACP;AACJ;AACA;MACIb,gBAAO,EAAE,IAJF;;MAMP;AACJ;AACA;MACID,kBAAS,EAAE,IATJ;;MAWP;AACJ;AACA;AACA;MACIe,KAAK,EA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"
}