{
  "version": 3,
  "names": [
    "qx",
    "Bootstrap",
    "executePendingDefers",
    "$$dbClassInfo",
    "Class",
    "define",
    "type",
    "extend",
    "core",
    "Object",
    "construct",
    "__styleCache",
    "__aliasMap",
    "properties",
    "theme",
    "check",
    "nullable",
    "event",
    "apply",
    "members",
    "__defaultStates",
    "_applyTheme",
    "__resolveId",
    "id",
    "defaultId",
    "chain",
    "db",
    "appearances",
    "entry",
    "divider",
    "end",
    "splitted",
    "split",
    "chainCopy",
    "lang",
    "Array",
    "clone",
    "alias",
    "length",
    "unshift",
    "pop",
    "baseid",
    "join",
    "mapped",
    "i",
    "shift",
    "subId",
    "resolved",
    "Environment",
    "get",
    "debug",
    "info",
    "include",
    "style",
    "styleFrom",
    "states",
    "getTheme",
    "aliasMap",
    "name",
    "warn",
    "unique",
    "bits",
    "$$bits",
    "$$length",
    "sum",
    "state",
    "cache",
    "undefined",
    "result",
    "base",
    "incl",
    "local",
    "baseIncludeKey",
    "hasOwnProperty",
    "baseKey",
    "includeKey",
    "localKey",
    "manager",
    "Appearance"
  ],
  "sources": [
    "/home/andresf/workspace_qooxdoo/qooxdoo/qooxdoo-7.0/source/class/qx/theme/manager/Appearance.js"
  ],
  "sourcesContent": [
    "/* ************************************************************************\n\n   qooxdoo - the new era of web development\n\n   http://qooxdoo.org\n\n   Copyright:\n     2004-2008 1&1 Internet AG, Germany, http://www.1und1.de\n\n   License:\n     MIT: https://opensource.org/licenses/MIT\n     See the LICENSE file in the project's top-level directory for details.\n\n   Authors:\n     * Sebastian Werner (wpbasti)\n     * Andreas Ecker (ecker)\n\n************************************************************************ */\n\n/**\n * Manager for appearance themes\n */\nqx.Class.define(\"qx.theme.manager.Appearance\", {\n  type: \"singleton\",\n  extend: qx.core.Object,\n\n  /*\n  *****************************************************************************\n     CONSTRUCTOR\n  *****************************************************************************\n  */\n\n  construct() {\n    super();\n\n    this.__styleCache = {};\n    this.__aliasMap = {};\n  },\n\n  /*\n  *****************************************************************************\n     PROPERTIES\n  *****************************************************************************\n  */\n\n  properties: {\n    /** Currently used appearance theme */\n    theme: {\n      check: \"Theme\",\n      nullable: true,\n      event: \"changeTheme\",\n      apply: \"_applyTheme\"\n    }\n  },\n\n  /*\n  *****************************************************************************\n     MEMBERS\n  *****************************************************************************\n  */\n  /* eslint-disable @qooxdoo/qx/no-refs-in-members */\n  members: {\n    /**\n     * @lint ignoreReferenceField(__defaultStates)\n     */\n    __defaultStates: {},\n    __styleCache: null,\n    __aliasMap: null,\n\n    // property apply\n    _applyTheme() {\n      // empty the caches\n      this.__aliasMap = {};\n      this.__styleCache = {};\n    },\n\n    /*\n    ---------------------------------------------------------------------------\n      THEME HELPER\n    ---------------------------------------------------------------------------\n    */\n\n    /**\n     * Returns the appearance entry ID to use\n     * when all aliases etc. are processed.\n     *\n     * @param id {String} ID to resolve.\n     * @param theme {Theme} Theme to use for lookup.\n     * @param defaultId {String} ID for a fallback.\n     * @param chain {Array} The appearance id chain.\n     * @return {String} Resolved ID\n     */\n    __resolveId(id, theme, defaultId, chain) {\n      var db = theme.appearances;\n      var entry = db[id];\n\n      if (!entry) {\n        var divider = \"/\";\n        var end = [];\n        var splitted = id.split(divider);\n        var chainCopy = qx.lang.Array.clone(splitted);\n        var alias;\n\n        while (!entry && splitted.length > 0) {\n          end.unshift(splitted.pop());\n          var baseid = splitted.join(divider);\n          entry = db[baseid];\n\n          if (entry) {\n            alias = entry.alias || entry;\n\n            if (typeof alias === \"string\") {\n              var mapped = alias + divider + end.join(divider);\n              return this.__resolveId(mapped, theme, defaultId, chainCopy);\n            }\n          }\n        }\n\n        // check if we find a control fitting in the appearance [BUG #4020]\n        for (var i = 0; i < end.length - 1; i++) {\n          // remove the first id, it has already been checked at startup\n          end.shift();\n          // build a new subid without the former first id\n          var subId = end.join(divider);\n          var resolved = this.__resolveId(subId, theme, null, chainCopy);\n          if (resolved) {\n            return resolved;\n          }\n        }\n\n        // check for the fallback\n        if (defaultId != null) {\n          return this.__resolveId(defaultId, theme, null, chainCopy);\n        }\n\n        // it's safe to output this message here since we can be sure that the return\n        // value is 'null' and something went wrong with the id lookup.\n        if (qx.core.Environment.get(\"qx.debug\")) {\n          if (typeof chain !== \"undefined\") {\n            this.debug(\n              \"Cannot find a matching appearance for '\" + chain.join(\"/\") + \"'.\"\n            );\n\n            if (chain.length > 1) {\n              this.info(\n                \"Hint: This may be an issue with nested child controls and a missing alias definition in the appearance theme.\"\n              );\n            }\n          }\n        }\n\n        return null;\n      } else if (typeof entry === \"string\") {\n        return this.__resolveId(entry, theme, defaultId, chainCopy);\n      } else if (entry.include && !entry.style) {\n        return this.__resolveId(entry.include, theme, defaultId, chainCopy);\n      }\n\n      return id;\n    },\n\n    /**\n     * Get the result of the \"state\" function for a given id and states\n     *\n     * @param id {String} id of the appearance (e.g. \"button\", \"label\", ...)\n     * @param states {Map} hash map defining the set states\n     * @param theme {Theme?} appearance theme\n     * @param defaultId {String} fallback id.\n     * @return {Map} map of widget properties as returned by the \"state\" function\n     */\n    styleFrom(id, states, theme, defaultId) {\n      if (!theme) {\n        theme = this.getTheme();\n      }\n\n      // Resolve ID\n      var aliasMap = this.__aliasMap;\n      if (!aliasMap[theme.name]) {\n        aliasMap[theme.name] = {};\n      }\n      var resolved = aliasMap[theme.name][id];\n      if (!resolved) {\n        resolved = aliasMap[theme.name][id] = this.__resolveId(\n          id,\n          theme,\n          defaultId\n        );\n      }\n\n      // Query theme for ID\n      var entry = theme.appearances[resolved];\n      if (!entry) {\n        this.warn(\"Missing appearance: \" + id);\n        return null;\n      }\n\n      // Entries with includes, but without style are automatically merged\n      // by the ID handling in {@link #getEntry}. When there is no style method in the\n      // final object the appearance is empty and null could be returned.\n      if (!entry.style) {\n        return null;\n      }\n\n      // Build an unique cache name from ID and state combination\n      var unique = resolved;\n      if (states) {\n        // Create data fields\n        var bits = entry.$$bits;\n        if (!bits) {\n          bits = entry.$$bits = {};\n          entry.$$length = 0;\n        }\n\n        // Compute sum\n        var sum = 0;\n        for (var state in states) {\n          if (!states[state]) {\n            continue;\n          }\n\n          if (bits[state] == null) {\n            bits[state] = 1 << entry.$$length++;\n          }\n\n          sum += bits[state];\n        }\n\n        // Only append the sum if it is bigger than zero\n        if (sum > 0) {\n          unique += \":\" + sum;\n        }\n      }\n\n      // Using cache if available\n      var cache = this.__styleCache;\n      if (cache[theme.name] && cache[theme.name][unique] !== undefined) {\n        return cache[theme.name][unique];\n      }\n\n      // Fallback to default (empty) states map\n      if (!states) {\n        states = this.__defaultStates;\n      }\n\n      // Compile the appearance\n      var result;\n\n      // If an include or base is defined, too, we need to merge the entries\n      if (entry.include || entry.base) {\n        // Gather included data\n        var incl;\n        if (entry.include) {\n          incl = this.styleFrom(entry.include, states, theme, defaultId);\n        }\n\n        // This process tries to insert the original data first, and\n        // append the new data later, to higher prioritize the local\n        // data above the included/inherited data. This is especially needed\n        // for property groups or properties which includes other\n        // properties when modified.\n        var local = entry.style(states, incl);\n\n        // Create new map\n        result = {};\n\n        // Copy base data, but exclude overwritten local and included stuff\n        if (entry.base) {\n          var base = this.styleFrom(resolved, states, entry.base, defaultId);\n\n          if (entry.include) {\n            for (var baseIncludeKey in base) {\n              if (\n                !incl.hasOwnProperty(baseIncludeKey) &&\n                !local.hasOwnProperty(baseIncludeKey)\n              ) {\n                result[baseIncludeKey] = base[baseIncludeKey];\n              }\n            }\n          } else {\n            for (var baseKey in base) {\n              if (!local.hasOwnProperty(baseKey)) {\n                result[baseKey] = base[baseKey];\n              }\n            }\n          }\n        }\n\n        // Copy include data, but exclude overwritten local stuff\n        if (entry.include) {\n          for (var includeKey in incl) {\n            if (!local.hasOwnProperty(includeKey)) {\n              result[includeKey] = incl[includeKey];\n            }\n          }\n        }\n\n        // Append local data\n        for (var localKey in local) {\n          result[localKey] = local[localKey];\n        }\n      } else {\n        result = entry.style(states);\n      }\n\n      // Cache new entry and return\n      if (!cache[theme.name]) {\n        cache[theme.name] = {};\n      }\n      return (cache[theme.name][unique] = result || null);\n    }\n  }\n});\n"
  ],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;EAAAA,EAAE,CAACC,SAAH,CAAaC,oBAAb,CAAkCC,aAAlC;;EAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;EAEA;AACA;AACA;EACAH,EAAE,CAACI,KAAH,CAASC,MAAT,CAAgB,6BAAhB,EAA+C;IAC7CC,IAAI,EAAE,WADuC;IAE7CC,MAAM,EAAEP,EAAE,CAACQ,IAAH,CAAQC,MAF6B;;IAI7C;AACF;AACA;AACA;AACA;IAEEC,SAAS,GAAG;MACV;MAEA,KAAKC,qBAAL,GAAoB,EAApB;MACA,KAAKC,mBAAL,GAAkB,EAAlB;IACD,CAf4C;;IAiB7C;AACF;AACA;AACA;AACA;IAEEC,UAAU,EAAE;MACV;MACAC,KAAK,EAAE;QACLC,KAAK,EAAE,OADF;QAELC,QAAQ,EAAE,IAFL;QAGLC,KAAK,EAAE,aAHF;QAILC,KAAK,EAAE;MAJF;IAFG,CAvBiC;;IAiC7C;AACF;AACA;AACA;AACA;;IACE;IACAC,OAAO,EAAE;MACP;AACJ;AACA;MACIC,wBAAe,EAAE,EAJV;MAKPT,qBAAY,EAAE,IALP;MAMPC,mBAAU,EAAE,IANL;;MAQP;MACAS,WAAW,GAAG;QACZ;QACA,KAAKT,mBAAL,GAAkB,EAAlB;QACA,KAAKD,qBAAL,GAAoB,EAApB;MACD,CAbM;;MAeP;AACJ;AACA;AACA;AACA;;MAEI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACIW,oBAAW,CAACC,EAAD,EAAKT,KAAL,EAAYU,SAAZ,EAAuBC,KAAvB,EAA8B;QACvC,IAAIC,EAAE,GAAGZ,KAAK,CAACa,WAAf;QACA,IAAIC,KAAK,GAAGF,EAAE,CAACH,EAAD,CAAd;;QAEA,IAAI,CAACK,KAAL,EAAY;UACV,IAAIC,OAAO,GAAG,GAAd;UACA,IAAIC,GAAG,GAAG,EAAV;UACA,IAAIC,QAAQ,GAAGR,EAAE,CAACS,KAAH,CAASH,OAAT,CAAf;UACA,IAAII,SAAS,GAAGjC,EAAE,CAACkC,IAAH,CAAQC,KAAR,CAAcC,KAAd,CAAoBL,QAApB,CAAhB;UACA,IAAIM,KAAJ;;UAEA,OAAO,CAACT,KAAD,IAAUG,QAAQ,CAACO,MAAT,GAAkB,CAAnC,EAAsC;YACpCR,GAAG,CAACS,OAAJ,CAAYR,QAAQ,CAACS,GAAT,EAAZ;YACA,IAAIC,MAAM,GAAGV,QAAQ,CAACW,IAAT,CAAcb,OAAd,CAAb;YACAD,KAAK,GAAGF,EAAE,CAACe,MAAD,CAAV;;YAEA,IAAIb,KAAJ,EAAW;cACTS,KAAK,GAAGT,KAAK,CAACS,KAAN,IAAeT,KAAvB;;cAEA,IAAI,OAAOS,KAAP,KAAiB,QAArB,EAA+B;gBAC7B,IAAIM,MAAM,GAAGN,KAAK,GAAGR,OAAR,GAAkBC,GAAG,CAACY,IAAJ,CAASb,OAAT,CAA/B;gBACA,OAAO,KAAKP,oBAAL,CAAiBqB,MAAjB,EAAyB7B,KAAzB,EAAgCU,SAAhC,EAA2CS,SAA3C,CAAP;cACD;YACF;UACF,CApBS,CAsBV;;;UACA,KAAK,IAAIW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGd,GAAG,CAACQ,MAAJ,GAAa,CAAjC,EAAoCM,CAAC,EAArC,EAAyC;YACvC;YACAd,GAAG,CAACe,KAAJ,GAFuC,CAGvC;;YACA,IAAIC,KAAK,GAAGhB,GAAG,CAACY,IAAJ,CAASb,OAAT,CAAZ;;YACA,IAAIkB,QAAQ,GAAG,KAAKzB,oBAAL,CAAiBwB,KAAjB,EAAwBhC,KAAxB,EAA+B,IAA/B,EAAqCmB,SAArC,CAAf;;YACA,IAAIc,QAAJ,EAAc;cACZ,OAAOA,QAAP;YACD;UACF,CAhCS,CAkCV;;;UACA,IAAIvB,SAAS,IAAI,IAAjB,EAAuB;YACrB,OAAO,KAAKF,oBAAL,CAAiBE,SAAjB,EAA4BV,KAA5B,EAAmC,IAAnC,EAAyCmB,SAAzC,CAAP;UACD,CArCS,CAuCV;UACA;;;UACA,IAAIjC,EAAE,CAACQ,IAAH,CAAQwC,WAAR,CAAoBC,GAApB,CAAwB,UAAxB,CAAJ,EAAyC;YACvC,IAAI,OAAOxB,KAAP,KAAiB,WAArB,EAAkC;cAChC,KAAKyB,KAAL,CACE,4CAA4CzB,KAAK,CAACiB,IAAN,CAAW,GAAX,CAA5C,GAA8D,IADhE;;cAIA,IAAIjB,KAAK,CAACa,MAAN,GAAe,CAAnB,EAAsB;gBACpB,KAAKa,IAAL,CACE,+GADF;cAGD;YACF;UACF;;UAED,OAAO,IAAP;QACD,CAxDD,MAwDO,IAAI,OAAOvB,KAAP,KAAiB,QAArB,EAA+B;UACpC,OAAO,KAAKN,oBAAL,CAAiBM,KAAjB,EAAwBd,KAAxB,EAA+BU,SAA/B,EAA0CS,SAA1C,CAAP;QACD,CAFM,MAEA,IAAIL,KAAK,CAACwB,OAAN,IAAiB,CAACxB,KAAK,CAACyB,KAA5B,EAAmC;UACxC,OAAO,KAAK/B,oBAAL,CAAiBM,KAAK,CAACwB,OAAvB,EAAgCtC,KAAhC,EAAuCU,SAAvC,EAAkDS,SAAlD,CAAP;QACD;;QAED,OAAOV,EAAP;MACD,CAlGM;;MAoGP;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;MACI+B,SAAS,CAAC/B,EAAD,EAAKgC,MAAL,EAAazC,KAAb,EAAoBU,SAApB,EAA+B;QACtC,IAAI,CAACV,KAAL,EAAY;UACVA,KAAK,GAAG,KAAK0C,QAAL,EAAR;QACD,CAHqC,CAKtC;;;QACA,IAAIC,QAAQ,GAAG,KAAK7C,mBAApB;;QACA,IAAI,CAAC6C,QAAQ,CAAC3C,KAAK,CAAC4C,IAAP,CAAb,EAA2B;UACzBD,QAAQ,CAAC3C,KAAK,CAAC4C,IAAP,CAAR,GAAuB,EAAvB;QACD;;QACD,IAAIX,QAAQ,GAAGU,QAAQ,CAAC3C,KAAK,CAAC4C,IAAP,CAAR,CAAqBnC,EAArB,CAAf;;QACA,IAAI,CAACwB,QAAL,EAAe;UACbA,QAAQ,GAAGU,QAAQ,CAAC3C,KAAK,CAAC4C,IAAP,CAAR,CAAqBnC,EAArB,IAA2B,KAAKD,oBAAL,CACpCC,EADoC,EAEpCT,KAFoC,EAGpCU,SAHoC,CAAtC;QAKD,CAjBqC,CAmBtC;;;QACA,IAAII,KAAK,GAAGd,KAAK,CAACa,WAAN,CAAkBoB,QAAlB,CAAZ;;QACA,IAAI,CAACnB,KAAL,EAAY;UACV,KAAK+B,IAAL,CAAU,yBAAyBpC,EAAnC;UACA,OAAO,IAAP;QACD,CAxBqC,CA0BtC;QACA;QACA;;;QACA,IAAI,CAACK,KAAK,CAACyB,KAAX,EAAkB;UAChB,OAAO,IAAP;QACD,CA/BqC,CAiCtC;;;QACA,IAAIO,MAAM,GAAGb,QAAb;;QACA,IAAIQ,MAAJ,EAAY;UACV;UACA,IAAIM,IAAI,GAAGjC,KAAK,CAACkC,MAAjB;;UACA,IAAI,CAACD,IAAL,EAAW;YACTA,IAAI,GAAGjC,KAAK,CAACkC,MAAN,GAAe,EAAtB;YACAlC,KAAK,CAACmC,QAAN,GAAiB,CAAjB;UACD,CANS,CAQV;;;UACA,IAAIC,GAAG,GAAG,CAAV;;UACA,KAAK,IAAIC,KAAT,IAAkBV,MAAlB,EAA0B;YACxB,IAAI,CAACA,MAAM,CAACU,KAAD,CAAX,EAAoB;cAClB;YACD;;YAED,IAAIJ,IAAI,CAACI,KAAD,CAAJ,IAAe,IAAnB,EAAyB;cACvBJ,IAAI,CAACI,KAAD,CAAJ,GAAc,KAAKrC,KAAK,CAACmC,QAAN,EAAnB;YACD;;YAEDC,GAAG,IAAIH,IAAI,CAACI,KAAD,CAAX;UACD,CApBS,CAsBV;;;UACA,IAAID,GAAG,GAAG,CAAV,EAAa;YACXJ,MAAM,IAAI,MAAMI,GAAhB;UACD;QACF,CA7DqC,CA+DtC;;;QACA,IAAIE,KAAK,GAAG,KAAKvD,qBAAjB;;QACA,IAAIuD,KAAK,CAACpD,KAAK,CAAC4C,IAAP,CAAL,IAAqBQ,KAAK,CAACpD,KAAK,CAAC4C,IAAP,CAAL,CAAkBE,MAAlB,MAA8BO,SAAvD,EAAkE;UAChE,OAAOD,KAAK,CAACpD,KAAK,CAAC4C,IAAP,CAAL,CAAkBE,MAAlB,CAAP;QACD,CAnEqC,CAqEtC;;;QACA,IAAI,CAACL,MAAL,EAAa;UACXA,MAAM,GAAG,KAAKnC,wBAAd;QACD,CAxEqC,CA0EtC;;;QACA,IAAIgD,MAAJ,CA3EsC,CA6EtC;;QACA,IAAIxC,KAAK,CAACwB,OAAN,IAAiBxB,KAAK,CAACyC,IAA3B,EAAiC;UAC/B;UACA,IAAIC,IAAJ;;UACA,IAAI1C,KAAK,CAACwB,OAAV,EAAmB;YACjBkB,IAAI,GAAG,KAAKhB,SAAL,CAAe1B,KAAK,CAACwB,OAArB,EAA8BG,MAA9B,EAAsCzC,KAAtC,EAA6CU,SAA7C,CAAP;UACD,CAL8B,CAO/B;UACA;UACA;UACA;UACA;;;UACA,IAAI+C,KAAK,GAAG3C,KAAK,CAACyB,KAAN,CAAYE,MAAZ,EAAoBe,IAApB,CAAZ,CAZ+B,CAc/B;;UACAF,MAAM,GAAG,EAAT,CAf+B,CAiB/B;;UACA,IAAIxC,KAAK,CAACyC,IAAV,EAAgB;YACd,IAAIA,IAAI,GAAG,KAAKf,SAAL,CAAeP,QAAf,EAAyBQ,MAAzB,EAAiC3B,KAAK,CAACyC,IAAvC,EAA6C7C,SAA7C,CAAX;;YAEA,IAAII,KAAK,CAACwB,OAAV,EAAmB;cACjB,KAAK,IAAIoB,cAAT,IAA2BH,IAA3B,EAAiC;gBAC/B,IACE,CAACC,IAAI,CAACG,cAAL,CAAoBD,cAApB,CAAD,IACA,CAACD,KAAK,CAACE,cAAN,CAAqBD,cAArB,CAFH,EAGE;kBACAJ,MAAM,CAACI,cAAD,CAAN,GAAyBH,IAAI,CAACG,cAAD,CAA7B;gBACD;cACF;YACF,CATD,MASO;cACL,KAAK,IAAIE,OAAT,IAAoBL,IAApB,EAA0B;gBACxB,IAAI,CAACE,KAAK,CAACE,cAAN,CAAqBC,OAArB,CAAL,EAAoC;kBAClCN,MAAM,CAACM,OAAD,CAAN,GAAkBL,IAAI,CAACK,OAAD,CAAtB;gBACD;cACF;YACF;UACF,CArC8B,CAuC/B;;;UACA,IAAI9C,KAAK,CAACwB,OAAV,EAAmB;YACjB,KAAK,IAAIuB,UAAT,IAAuBL,IAAvB,EAA6B;cAC3B,IAAI,CAACC,KAAK,CAACE,cAAN,CAAqBE,UAArB,CAAL,EAAuC;gBACrCP,MAAM,CAACO,UAAD,CAAN,GAAqBL,IAAI,CAACK,UAAD,CAAzB;cACD;YACF;UACF,CA9C8B,CAgD/B;;;UACA,KAAK,IAAIC,QAAT,IAAqBL,KAArB,EAA4B;YAC1BH,MAAM,CAACQ,QAAD,CAAN,GAAmBL,KAAK,CAACK,QAAD,CAAxB;UACD;QACF,CApDD,MAoDO;UACLR,MAAM,GAAGxC,KAAK,CAACyB,KAAN,CAAYE,MAAZ,CAAT;QACD,CApIqC,CAsItC;;;QACA,IAAI,CAACW,KAAK,CAACpD,KAAK,CAAC4C,IAAP,CAAV,EAAwB;UACtBQ,KAAK,CAACpD,KAAK,CAAC4C,IAAP,CAAL,GAAoB,EAApB;QACD;;QACD,OAAQQ,KAAK,CAACpD,KAAK,CAAC4C,IAAP,CAAL,CAAkBE,MAAlB,IAA4BQ,MAAM,IAAI,IAA9C;MACD;;IAxPM;EAvCoC,CAA/C;EAtBApE,EAAE,CAACc,KAAH,CAAS+D,OAAT,CAAiBC,UAAjB,CAA4B3E,aAA5B,GAA4CA,aAA5C"
}